<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of parameter_balancing_Keq</title>
  <meta name="keywords" content="parameter_balancing_Keq">
  <meta name="description" content="[Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename,options)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_parameter_balancing</a> &gt; <a href="#">parameter_balancing</a> &gt; parameter_balancing_Keq.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_parameter_balancing/parameter_balancing&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>parameter_balancing_Keq
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>[Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename,options)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename, options) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename,options)

 Convenience function for using parameter balancing to obtain equilibrium constants
 and concentrations for a model
 
 The code assumes that the network structure contains KEGG IDs and uses
 SBtab data files supplied that can contain data on standard chemical potentials,
 equilibrium constants, concentrations, and reaction affinities

 Fields of options:
   options.ind_water           (indices of metabolites representing water)
   options.data_refer_to_molar = 0;    (flag)
   options.flag_pseudo_value   = 0;    (flag; use pseudo values?)
   options.conc_min            = 0.;   (mM)
   options.conc_max            = 10^10;(mM)
   options.sigma_mu0           = 3;    error of mu0 values (kJ/mol); 3 for alberty data

 my_kinetic_data: data and assumptions finally used in the optimisation task

 Code originally from: parameter_balancing_thermodynamic</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt-advanced/mnt_data_integration/data_integration_bounds_pseudovalues.html" class="code" title="function kinetic_data = data_integration_bounds_pseudovalues(kinetic_data,quantity_info,flag_pseudo_values,network,verbose)">data_integration_bounds_pseudovalues</a>	kinetic_data = data_integration_bounds_pseudovalues(kinetic_data,quantity_info,flag_pseudo_values,network);</li><li><a href="../../.././mnt-advanced/mnt_data_integration/data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose, filter_column, filter_entry,reaction_column_name,compound_column_name)">data_integration_load_kinetic_data</a>	kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)</li><li><a href="../../.././mnt-advanced/mnt_data_integration/data_integration_load_quantity_info.html" class="code" title="function quantity_info = data_integration_load_quantity_info(omit_quantities, quantity_info_filename)">data_integration_load_quantity_info</a>	quantity_info = data_integration_load_quantity_info(omit_quantities,quantity_info_filename)</li><li><a href="../../.././mnt-advanced/mnt_parameter_balancing/parameter_balancing.html" class="code" title="function [res, exitflag] = parameter_balancing(task, quantity_info, options)">parameter_balancing</a>	[res, exitflag] = parameter_balancing(task, quantity_info, options)</li><li><a href="../../.././mnt-advanced/mnt_parameter_balancing/parameter_balancing_task.html" class="code" title="function [task, prior] = parameter_balancing_task(network, kinetic_data, quantity_info, model_quantities, basic_quantities)">parameter_balancing_task</a>	Prepare vectors and matrices for parameter balancing</li><li><a href="../../.././mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>	kinetics = set_kinetics(network,type,parameters)</li><li><a href="../../.././mnt/mnt_numbers/RT.html" class="code" title="function result = RT(temperature)">RT</a>	result = RT(temperature)</li><li><a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../.././mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>	c = join_struct(a,b)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename, options)</a>
0002 
0003 <span class="comment">% [Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename,options)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Convenience function for using parameter balancing to obtain equilibrium constants</span>
0006 <span class="comment">% and concentrations for a model</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% The code assumes that the network structure contains KEGG IDs and uses</span>
0009 <span class="comment">% SBtab data files supplied that can contain data on standard chemical potentials,</span>
0010 <span class="comment">% equilibrium constants, concentrations, and reaction affinities</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Fields of options:</span>
0013 <span class="comment">%   options.ind_water           (indices of metabolites representing water)</span>
0014 <span class="comment">%   options.data_refer_to_molar = 0;    (flag)</span>
0015 <span class="comment">%   options.flag_pseudo_value   = 0;    (flag; use pseudo values?)</span>
0016 <span class="comment">%   options.conc_min            = 0.;   (mM)</span>
0017 <span class="comment">%   options.conc_max            = 10^10;(mM)</span>
0018 <span class="comment">%   options.sigma_mu0           = 3;    error of mu0 values (kJ/mol); 3 for alberty data</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% my_kinetic_data: data and assumptions finally used in the optimisation task</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% Code originally from: parameter_balancing_thermodynamic</span>
0023 
0024 eval(<a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'options'</span>,<span class="string">'struct'</span>));
0025 
0026 options_default.data_refer_to_molar = 0;
0027 options_default.flag_pseudo_values  = 0;
0028 options_default.sigma_mu0           = 3;<span class="comment">%    error of mu0 values (kJ/mol); 3 for alberty data</span>
0029 
0030 options = <a href="../../.././mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>(options_default,options);
0031 
0032 
0033 <span class="comment">% ------------------------------------------------------------------------</span>
0034 
0035 [nm,nr] = size(network.N);
0036 
0037 
0038 <span class="comment">% ------------------------------------------------------------------------</span>
0039 <span class="comment">% read standard chemical potentials</span>
0040 
0041 <span class="comment">% load gibbs free energies of formation ... this requires metabolite KEGG IDs in the model!</span>
0042 
0043 data_quantities = {<span class="string">'standard chemical potential'</span>,<span class="string">'equilibrium constant'</span>, <span class="string">'concentration'</span>}';
0044 quantity_info   = <a href="../../.././mnt-advanced/mnt_data_integration/data_integration_load_quantity_info.html" class="code" title="function quantity_info = data_integration_load_quantity_info(omit_quantities, quantity_info_filename)">data_integration_load_quantity_info</a>;
0045 kinetic_data    = <a href="../../.././mnt-advanced/mnt_data_integration/data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose, filter_column, filter_entry,reaction_column_name,compound_column_name)">data_integration_load_kinetic_data</a>(data_quantities, quantity_info, network, filename, 0, 1);
0046 
0047 <span class="comment">% for which metabolites do we have standard chemical potentials?</span>
0048 <span class="comment">% mu0 = kinetic_data.mu0.median;</span>
0049 <span class="comment">% figure(2); netgraph_concentrations(network_CoHid,isfinite(mu0),[],1,gp)</span>
0050 
0051 <span class="keyword">if</span> options.data_refer_to_molar,
0052 
0053   ind_cor = setdiff(1:nm,options.ind_water);
0054 
0055   kinetic_data.mu0.median(ind_cor)  = kinetic_data.mu0.median(ind_cor) - <a href="../../.././mnt/mnt_numbers/RT.html" class="code" title="function result = RT(temperature)">RT</a> * log(1000); 
0056   kinetic_data.mu0.mean(ind_cor)    = kinetic_data.mu0.mean(ind_cor)   - <a href="../../.././mnt/mnt_numbers/RT.html" class="code" title="function result = RT(temperature)">RT</a> * log(1000); 
0057   kinetic_data.mu0.lower(ind_cor)   = kinetic_data.mu0.lower(ind_cor)  - <a href="../../.././mnt/mnt_numbers/RT.html" class="code" title="function result = RT(temperature)">RT</a> * log(1000); 
0058   kinetic_data.mu0.upper(ind_cor)   = kinetic_data.mu0.upper(ind_cor)  - <a href="../../.././mnt/mnt_numbers/RT.html" class="code" title="function result = RT(temperature)">RT</a> * log(1000); 
0059   kinetic_data.c.median             = kinetic_data.c.median   * 1000; 
0060   kinetic_data.c.mean               = kinetic_data.c.mean     * 1000; 
0061   kinetic_data.c.std                = kinetic_data.c.std      * 1000; 
0062   kinetic_data.c.lower              = kinetic_data.c.lower    * 1000; 
0063   kinetic_data.c.upper              = kinetic_data.c.upper    * 1000; 
0064   kinetic_data.c.mean_ln            = kinetic_data.c.mean_ln  + log(1000); 
0065   kinetic_data.c.lower_ln           = kinetic_data.c.lower_ln + log(1000); 
0066   kinetic_data.c.upper_ln           = kinetic_data.c.upper_ln + log(1000); 
0067   
0068   kinetic_data = concentration_sampling_update_kinetic_data(kinetic_data, network, v, options);
0069 
0070 <span class="keyword">end</span>
0071 
0072 <span class="comment">% -----------------------</span>
0073 <span class="comment">% fix mu0 values and concentrations exactly at data values</span>
0074 <span class="comment">% TOO SMALL VALUES HERE CAN LEAD TO NUMERICAL PROBLEMS LATER ON</span>
0075 <span class="comment">% IN PARAMETER BALANCING (QUADPROG)</span>
0076 
0077 kinetic_data.mu0.std(find(isfinite(kinetic_data.mu0.std)))   = 10^-4;
0078 kinetic_data.c.std(find(isfinite(kinetic_data.c.std)))       = 10^-4;
0079 kinetic_data.c.std_ln(find(isfinite(kinetic_data.c.std_ln))) = 10^-4;
0080 
0081 
0082 <span class="comment">% ------------------------------------------------------------------------</span>
0083 <span class="comment">% Determine consistent parameter set by parameter balancing</span>
0084 
0085 quantity_info     = <a href="../../.././mnt-advanced/mnt_data_integration/data_integration_load_quantity_info.html" class="code" title="function quantity_info = data_integration_load_quantity_info(omit_quantities, quantity_info_filename)">data_integration_load_quantity_info</a>;
0086 model_quantities  = {<span class="string">'standard chemical potential'</span>,<span class="string">'equilibrium constant'</span>, <span class="string">'concentration'</span>}';
0087 data_quantities   = {<span class="string">'standard chemical potential'</span>,<span class="string">'equilibrium constant'</span>, <span class="string">'concentration'</span>}';
0088 basic_quantities  = {<span class="string">'standard chemical potential'</span>,<span class="string">'concentration'</span>}';
0089 
0090 my_kinetic_data = kinetic_data;
0091 
0092 <span class="comment">% prepare data for parameter balancing</span>
0093 quantity_info.LowerBound{quantity_info.symbol_index.c}   = <span class="string">'0.001'</span>;
0094 quantity_info.UpperBound{quantity_info.symbol_index.c}   = <span class="string">'100'</span>;
0095 quantity_info.LowerBound{quantity_info.symbol_index.Keq} = <span class="string">'0.000001'</span>;
0096 quantity_info.UpperBound{quantity_info.symbol_index.Keq} = <span class="string">'1000000'</span>;
0097 quantity_info.PriorStd{quantity_info.symbol_index.Keq}   = <span class="string">'0.05'</span>;
0098 
0099 my_kinetic_data.mu0.std = options.sigma_mu0 * ones(nm,1);
0100 
0101 my_kinetic_data = <a href="../../.././mnt-advanced/mnt_data_integration/data_integration_bounds_pseudovalues.html" class="code" title="function kinetic_data = data_integration_bounds_pseudovalues(kinetic_data,quantity_info,flag_pseudo_values,network,verbose)">data_integration_bounds_pseudovalues</a>(my_kinetic_data,quantity_info,options.flag_pseudo_values,network);
0102 
0103 my_kinetic_data.c.lower    = 0.0001 * ones(nm,1);
0104 my_kinetic_data.c.upper    = 100 * ones(nm,1);
0105 my_kinetic_data.c.lower_ln = log(0.0001) * ones(nm,1);
0106 my_kinetic_data.c.upper_ln = log(100) * ones(nm,1);
0107 
0108 network.kinetics = <a href="../../.././mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>(network, <span class="string">'cs'</span>);
0109 task = <a href="../../.././mnt-advanced/mnt_parameter_balancing/parameter_balancing_task.html" class="code" title="function [task, prior] = parameter_balancing_task(network, kinetic_data, quantity_info, model_quantities, basic_quantities)">parameter_balancing_task</a>(network, my_kinetic_data, quantity_info, model_quantities, basic_quantities);
0110 res  = <a href="../../.././mnt-advanced/mnt_parameter_balancing/parameter_balancing.html" class="code" title="function [res, exitflag] = parameter_balancing(task, quantity_info, options)">parameter_balancing</a>(task, quantity_info, struct(<span class="string">'insert_pseudo_values'</span>,0));
0111 
0112 mu0 = res.kinetics_posterior_mode.mu0;
0113 Keq = res.kinetics_posterior_mode.Keq;
0114 c   = res.kinetics_posterior_mode.c;</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>