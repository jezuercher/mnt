<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of model_reduction</title>
  <meta name="keywords" content="model_reduction">
  <meta name="description" content="model_reduction - Replace parts of biochemical network models by simple linear systems">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_model_reduction</a> &gt; model_reduction.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_model_reduction&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>model_reduction
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>model_reduction - Replace parts of biochemical network models by simple linear systems</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [r,weights,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,Tr,environment_metabolites] = model_reduction(network,metabolites_subsystem,ndim,verbose,s_initial,S,J,flag_graphics,t_max,gp,network_CoHid,Ec_un) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> model_reduction - Replace parts of biochemical network models by simple linear systems

  [r,weights,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,Tr,environment_metabolites] = model_reduction(network,metabolites_subsystem,ndim,verbose,s_initial,S,J,flag_graphics,t_max,gp,network_CoHid,Ec_un)

 Split a biochemical network model into subsystem and environment, reduce the environment,
 simulate both the original and the reduced version, and display graphics

 Mandatory inputs:
  network:                metabolic network structure, see metabolic network toolbox
  metabolites_subsystem:  list of metabolite names in subsystem (to remain unreduced)

 Optional inputs:
  ndim                    Maximal number of dimension in the reduced linear model (default 5)
  verbose:                (Boolean)
  s_initial:              column vector of initial metabolite concentrations
  S                       column vector of steady state metabolite concentrations
  J                       column vector of steady state reaction fluxes
  flag_graphics           (Boolean) show graphics?
  t_max                   integration time
  gp                      struct with graphics options ('fontsize');
  network_CoHid           Network structure without cofactors (only used for graphics output)
  Ec_un                   Unscaled elasticity matrix (can be provided to avoid calculating it anew) 

 Output: 
  tF, s_tF        simulation result (times, concentrations) of original model
  tR, s_tR, x_tR  simulation result (times, pathway conc, environment conc) of reduced model
  tE, s_tE        simulation result (times, concentrations) with fixed environment</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../.././mnt-advanced/mnt_model_reduction/model_reduction/model_reduction_draw_figures.html" class="code" title="function info = model_reduction_draw_figures(network,r,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,metabolites_subsystem,subsystem2_metabolites,gp,network_CoHid,verbose)">model_reduction_draw_figures</a>	info = model_reduction_draw_figures(network,r,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,metabolites_subsystem,subsystem2_metabolites,gp,network_CoHid)</li><li><a href="../.././mnt-advanced/mnt_model_reduction/model_reduction/model_reduction_simulations.html" class="code" title="function [tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)">model_reduction_simulations</a>	[tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)</li><li><a href="../.././mnt-advanced/mnt_model_reduction/model_reduction/selective_reduction.html" class="code" title="function r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un)">selective_reduction</a>	r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un);</li><li><a href="../.././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>	[S, J, Sdot, error] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)</li><li><a href="../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../.././mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>	c = join_struct(a,b)</li><li><a href="../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>	function [label,indices] = label_names(names,allnames, method)</li><li><a href="../.././mnt/utils/mytable.html" class="code" title="function res = mytable(names,rownumbers,filename)">mytable</a>	result = mytable(names,rownumbers,filename)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../.././mnt-advanced/mnt_model_reduction/demo/demo_model_reduction_glycolysis.html" class="code" title="">demo_model_reduction_glycolysis</a>	-------------------------------------------------------------------------</li><li><a href="../.././mnt-advanced/mnt_model_reduction/demo/demo_model_reduction_simple_pathway.html" class="code" title="">demo_model_reduction_simple_pathway</a>	------------------------------------------------------------------------------</li><li><a href="../.././mnt-advanced/mnt_model_reduction/demo/demo_model_reduction_square.html" class="code" title="">demo_model_reduction_square</a>	-----------------------------------------------------------------------</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [r,weights,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,Tr,environment_metabolites] = model_reduction(network,metabolites_subsystem,ndim,verbose,s_initial,S,J,flag_graphics,t_max,gp,network_CoHid,Ec_un)</a>
0002 
0003 <span class="comment">% model_reduction - Replace parts of biochemical network models by simple linear systems</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%  [r,weights,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,Tr,environment_metabolites] = model_reduction(network,metabolites_subsystem,ndim,verbose,s_initial,S,J,flag_graphics,t_max,gp,network_CoHid,Ec_un)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% Split a biochemical network model into subsystem and environment, reduce the environment,</span>
0008 <span class="comment">% simulate both the original and the reduced version, and display graphics</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% Mandatory inputs:</span>
0011 <span class="comment">%  network:                metabolic network structure, see metabolic network toolbox</span>
0012 <span class="comment">%  metabolites_subsystem:  list of metabolite names in subsystem (to remain unreduced)</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% Optional inputs:</span>
0015 <span class="comment">%  ndim                    Maximal number of dimension in the reduced linear model (default 5)</span>
0016 <span class="comment">%  verbose:                (Boolean)</span>
0017 <span class="comment">%  s_initial:              column vector of initial metabolite concentrations</span>
0018 <span class="comment">%  S                       column vector of steady state metabolite concentrations</span>
0019 <span class="comment">%  J                       column vector of steady state reaction fluxes</span>
0020 <span class="comment">%  flag_graphics           (Boolean) show graphics?</span>
0021 <span class="comment">%  t_max                   integration time</span>
0022 <span class="comment">%  gp                      struct with graphics options ('fontsize');</span>
0023 <span class="comment">%  network_CoHid           Network structure without cofactors (only used for graphics output)</span>
0024 <span class="comment">%  Ec_un                   Unscaled elasticity matrix (can be provided to avoid calculating it anew)</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Output:</span>
0027 <span class="comment">%  tF, s_tF        simulation result (times, concentrations) of original model</span>
0028 <span class="comment">%  tR, s_tR, x_tR  simulation result (times, pathway conc, environment conc) of reduced model</span>
0029 <span class="comment">%  tE, s_tE        simulation result (times, concentrations) with fixed environment</span>
0030 
0031 
0032 <span class="comment">% ----------------------------------------------------------------------</span>
0033 <span class="comment">% complete missing arguments</span>
0034 
0035 eval(<a href="../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'J'</span>,<span class="string">'[]'</span>,<span class="string">'s_initial'</span>,<span class="string">'[]'</span>,<span class="string">'verbose'</span>,<span class="string">'0'</span>,<span class="string">'flag_graphics'</span>,<span class="string">'1'</span>,<span class="string">'t_max'</span>,<span class="string">'3'</span>,<span class="string">'J'</span>,<span class="string">'[]'</span>,<span class="string">'ndim'</span>,<span class="string">'5'</span>,<span class="string">'gp'</span>,<span class="string">'struct'</span>,<span class="string">'network_CoHid'</span>,<span class="string">'network'</span>,<span class="string">'Ec_un'</span>,<span class="string">'[]'</span>));
0036 
0037 gp_default = struct(<span class="string">'fontsize'</span>,10,<span class="string">'show_modes_on_network'</span>,0);
0038 gp         = <a href="../.././mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>(gp_default,gp);
0039 
0040 <span class="keyword">if</span> isempty(J),
0041   <span class="keyword">if</span> verbose, fprintf(<span class="string">'  Computing the steady state\n'</span>); <span class="keyword">end</span>
0042   [S,J] = <a href="../.././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>(network);
0043 <span class="keyword">end</span>
0044 
0045 <span class="keyword">if</span> isempty(s_initial), 
0046   <span class="comment">%% as an example, create some imbalance ...</span>
0047   s_initial = S;
0048   indices_met_sub = <a href="../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(metabolites_subsystem, network.metabolites);
0049   s_initial(indices_met_sub) = 0.5 *  s_initial(indices_met_sub);
0050 <span class="keyword">end</span>
0051 
0052 
0053 <span class="comment">% ----------------------------------------------------------------------</span>
0054 <span class="comment">% Call model reduction</span>
0055 
0056 ndim  = min(ndim, length(network.metabolites) - length(metabolites_subsystem));
0057 
0058 <span class="keyword">if</span> verbose, fprintf(<span class="string">'  Reducing the environment submodel\n'</span>); <span class="keyword">end</span>
0059 
0060 r = <a href="../.././mnt-advanced/mnt_model_reduction/model_reduction/selective_reduction.html" class="code" title="function r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un)">selective_reduction</a>(network,metabolites_subsystem,S,J,Ec_un);
0061 
0062 
0063 <span class="comment">% ----------------------------------------------------------------------</span>
0064 <span class="comment">% Handle conservation relations: this is a cheap workaround</span>
0065 <span class="comment">% to make the Jacobian invertible</span>
0066 
0067 r.A = r.A +( - max(eig(full(r.A))) - 10^-8)*eye(size(r.A,1));
0068 
0069 
0070 <span class="comment">% ----------------------------------------------------------------------</span>
0071 <span class="comment">% run simulations and show graphics</span>
0072 
0073 [tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = <a href="../.././mnt-advanced/mnt_model_reduction/model_reduction/model_reduction_simulations.html" class="code" title="function [tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)">model_reduction_simulations</a>(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose);
0074 
0075 <span class="keyword">if</span> flag_graphics,
0076   info = <a href="../.././mnt-advanced/mnt_model_reduction/model_reduction/model_reduction_draw_figures.html" class="code" title="function info = model_reduction_draw_figures(network,r,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,metabolites_subsystem,subsystem2_metabolites,gp,network_CoHid,verbose)">model_reduction_draw_figures</a>(network,r,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,metabolites_subsystem,environment_metabolites,gp,network_CoHid,verbose);
0077 
0078   <span class="keyword">if</span> verbose,
0079   <a href="../.././mnt/utils/mytable.html" class="code" title="function res = mytable(names,rownumbers,filename)">mytable</a>(info,0)
0080   <span class="keyword">end</span>
0081 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>