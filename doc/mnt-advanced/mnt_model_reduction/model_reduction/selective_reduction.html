<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of selective_reduction</title>
  <meta name="keywords" content="selective_reduction">
  <meta name="description" content="r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un);">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_model_reduction</a> &gt; <a href="#">model_reduction</a> &gt; selective_reduction.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_model_reduction/model_reduction&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>selective_reduction
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un);</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un);

 Prepare a metabolic network for model reduction: define a part of the
 model as 'environment' and linearise it around a stationary state. 

 network               network (data type: see network_structure)
 subsystem_metabolites column list of metabolite names in the subsystem
 S, J (optional)       column vectors of precalculated steady state concentrations and fluxes
 Ec_un (optional)      unscaled metabolite elasticities
 Ep_un (optional)      unscaled parameter elasticities

 r                 reduced network ('network' data structure describing the subsystem)
                   ... but with additional fields describing the reducted model ...
 r.ind_met_sub2bor index vector for border metabolites within subsystem
 r.N_sub_bor       N (subsystem metabolites/border reactions)
 r.s0_bor          initial concentrations (border metabolites)
 r.s0_ext          initial concentrations (external metabolites)
 r.v0_bor          initial fluxes (border metabolites)
 r.v0_ext          initial fluxes (external metabolites)
 r.A               linear control system matrix describing environment          
 r.B               linear control system matrix (wrt border metabolites)
 r.Bu              linear control system matrix (wrt model parameters)    
 r.C               linear control system matrix          
 r.D               linear control system matrix          
 r.Du              linear control system matrix          
 r.more            data structure with additional information 

 This function requires the metabolic network toolbox</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt/mnt_mca/elasticities.html" class="code" title="function [Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);">elasticities</a>	[Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);</li><li><a href="../../.././mnt/mnt_network/network_build_edit/network_choose.html" class="code" title="function [subnetwork, indm, indr] = network_choose(network,indm,indr,strict)">network_choose</a>	[subnetwork,indm,indr] = network_choose(network,indm,indr,strict)</li><li><a href="../../.././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>	[S, J, Sdot, error] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)</li><li><a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>	function [label,indices] = label_names(names,allnames, method)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt-advanced/mnt_model_reduction/model_reduction.html" class="code" title="function [r,weights,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,Tr,environment_metabolites] = model_reduction(network,metabolites_subsystem,ndim,verbose,s_initial,S,J,flag_graphics,t_max,gp,network_CoHid,Ec_un)">model_reduction</a>	model_reduction - Replace parts of biochemical network models by simple linear systems</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un)</a>
0002 
0003 <span class="comment">% r = selective_reduction(network, subsystem_metabolites, S, J, Ec_un, Ep_un);</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Prepare a metabolic network for model reduction: define a part of the</span>
0006 <span class="comment">% model as 'environment' and linearise it around a stationary state.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% network               network (data type: see network_structure)</span>
0009 <span class="comment">% subsystem_metabolites column list of metabolite names in the subsystem</span>
0010 <span class="comment">% S, J (optional)       column vectors of precalculated steady state concentrations and fluxes</span>
0011 <span class="comment">% Ec_un (optional)      unscaled metabolite elasticities</span>
0012 <span class="comment">% Ep_un (optional)      unscaled parameter elasticities</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% r                 reduced network ('network' data structure describing the subsystem)</span>
0015 <span class="comment">%                   ... but with additional fields describing the reducted model ...</span>
0016 <span class="comment">% r.ind_met_sub2bor index vector for border metabolites within subsystem</span>
0017 <span class="comment">% r.N_sub_bor       N (subsystem metabolites/border reactions)</span>
0018 <span class="comment">% r.s0_bor          initial concentrations (border metabolites)</span>
0019 <span class="comment">% r.s0_ext          initial concentrations (external metabolites)</span>
0020 <span class="comment">% r.v0_bor          initial fluxes (border metabolites)</span>
0021 <span class="comment">% r.v0_ext          initial fluxes (external metabolites)</span>
0022 <span class="comment">% r.A               linear control system matrix describing environment</span>
0023 <span class="comment">% r.B               linear control system matrix (wrt border metabolites)</span>
0024 <span class="comment">% r.Bu              linear control system matrix (wrt model parameters)</span>
0025 <span class="comment">% r.C               linear control system matrix</span>
0026 <span class="comment">% r.D               linear control system matrix</span>
0027 <span class="comment">% r.Du              linear control system matrix</span>
0028 <span class="comment">% r.more            data structure with additional information</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% This function requires the metabolic network toolbox</span>
0031 
0032 
0033 eval(<a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'Ec_un'</span>,<span class="string">'[]'</span>,<span class="string">'Ep_un'</span>,<span class="string">'[]'</span>));
0034 
0035 <span class="comment">% ---------------------------------------------------------------------------------</span>
0036 <span class="comment">% determine steady state and elasticities</span>
0037 
0038 <span class="keyword">if</span> ~exist(<span class="string">'S'</span>,<span class="string">'var'</span>),
0039   fprintf(<span class="string">'Computing the steady state\n'</span>);
0040   [S,J] = <a href="../../.././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>(network);
0041   fprintf(<span class="string">'Steady state found\n'</span>);
0042 <span class="keyword">end</span>
0043 
0044 <span class="keyword">if</span> isempty(Ec_un),
0045  [epsilon_S,epsilon_P] = <a href="../../.././mnt/mnt_mca/elasticities.html" class="code" title="function [Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);">elasticities</a>(network,S);
0046  epsilon   = sparse(epsilon_S);
0047  epsilon_P = sparse(epsilon_P);
0048 <span class="keyword">else</span>
0049   epsilon   = Ec_un;
0050   epsilon_P = Ep_un;
0051 <span class="keyword">end</span>
0052 
0053 <span class="comment">% ---------------------------------------------------------------------------------</span>
0054 <span class="comment">% find indices of metabolites and actions in the internal, border, and external part</span>
0055 
0056 indices_met_sub = <a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(subsystem_metabolites,network.metabolites,<span class="string">'single'</span>);
0057 indices_met_env = setdiff((1:length(network.metabolites))',indices_met_sub);
0058 
0059 <span class="comment">% structure of elasticity matrix</span>
0060 <span class="comment">%OLD:</span>
0061 <span class="comment">%my_epsilon = elasticities(network,ones(size(network.metabolites)));</span>
0062 <span class="comment">%my_regulation_matrix = my_epsilon~=0;</span>
0063 my_regulation_matrix = epsilon~=0;
0064 connections = ((network.N'~=0)+my_regulation_matrix)~=0;
0065 
0066 indices_act_int = find(sum(connections(:,indices_met_env),2)==0);
0067 indices_act_ext = find(sum(connections(:,indices_met_sub),2)==0);
0068 indices_act_bor = setdiff((1:length(network.actions))', union(indices_act_int,indices_act_ext));
0069 
0070 indices_met_int = intersect(indices_met_sub,find(sum(connections([indices_act_bor;indices_act_ext]  ,:))==0)');
0071 indices_met_ext = indices_met_env;
0072 indices_met_bor = setdiff((1:length(network.metabolites))', union(indices_met_int,indices_met_ext));
0073 
0074 <span class="keyword">if</span> length(indices_met_int)&lt;1, 
0075   display(<span class="string">'  There are no metabolites internal to the subsystem.'</span>);
0076 <span class="keyword">end</span>
0077 
0078 color_act = zeros(size(network.actions));
0079 color_act(indices_act_int)=1;
0080 color_act(indices_act_bor)=-2;
0081 color_act(indices_act_ext)=-1;
0082 
0083 color_met = zeros(size(network.metabolites));
0084 color_met(indices_met_int)=1;
0085 color_met(indices_met_bor)=2;
0086 color_met(indices_met_ext)=-1;
0087 
0088 
0089 <span class="comment">% -------------------------------------</span>
0090 <span class="comment">% split stoichiometric matrix</span>
0091 
0092 N         = sparse(network.N);
0093 
0094 s0_bor    = S(indices_met_bor);
0095 s0_ext    = S(indices_met_ext);
0096 v0_bor    = J(indices_act_bor);
0097 v0_ext    = J(indices_act_ext);
0098 
0099 N_ext_ext = N(indices_met_ext,indices_act_ext);
0100 N_ext_bor = N(indices_met_ext,indices_act_bor);
0101 N_sub_int = N(indices_met_sub,indices_act_int);
0102 N_sub_bor = N(indices_met_sub,indices_act_bor);
0103 
0104 epsilon_bor_bor = epsilon(indices_act_bor,indices_met_bor);
0105 epsilon_bor_ext = epsilon(indices_act_bor,indices_met_ext);
0106 epsilon_ext_ext = epsilon(indices_act_ext,indices_met_ext);
0107 
0108 
0109 <span class="comment">% keep external metabolites in environment constant!</span>
0110 ind_env_const = find(network.external(indices_met_ext));
0111 my_N_ext_ext = N_ext_ext;
0112 my_N_ext_bor = N_ext_bor;
0113 my_N_ext_ext(ind_env_const,:) = 0;
0114 my_N_ext_bor(ind_env_const,:) = 0;
0115 
0116 A  = my_N_ext_ext * epsilon_ext_ext + my_N_ext_bor * epsilon_bor_ext;
0117 B  = my_N_ext_bor * epsilon_bor_bor;
0118 C  = epsilon_bor_ext;
0119 D  = epsilon_bor_bor;
0120 
0121 <span class="comment">% ----------------------------------------------------------------------------</span>
0122 <span class="comment">% store all results in data structure r</span>
0123 
0124 r.network_sub     = <a href="../../.././mnt/mnt_network/network_build_edit/network_choose.html" class="code" title="function [subnetwork, indm, indr] = network_choose(network,indm,indr,strict)">network_choose</a>(network,indices_met_sub,indices_act_int);
0125 
0126 dum=[];
0127 <span class="keyword">for</span> it=1:length(indices_met_bor),
0128  dum=[dum find(indices_met_sub==indices_met_bor(it))];
0129 <span class="keyword">end</span>
0130 
0131 r.ind_met_sub2bor = dum;
0132 r.N_sub_bor       = N_sub_bor;
0133 r.s0_bor          = s0_bor;
0134 r.s0_ext          = s0_ext;
0135 r.v0_bor          = v0_bor;
0136 r.v0_ext          = v0_ext;
0137 r.A               = A;
0138 r.B               = B;
0139 r.C               = C;
0140 r.D               = D;
0141 
0142 
0143 r.more.indices_act_int = indices_act_int;
0144 r.more.indices_act_ext = indices_act_ext;
0145 r.more.indices_act_bor = indices_act_bor ;
0146 r.more.indices_met_sub = indices_met_sub;
0147 r.more.indices_met_env = indices_met_env;
0148 r.more.indices_met_int = indices_met_int;
0149 r.more.indices_met_ext = indices_met_ext;
0150 r.more.indices_met_bor = indices_met_bor ;
0151 r.more.connections     = connections;
0152 r.more.color_act       = color_act;
0153 r.more.color_met       = color_met;
0154 r.more.S               = S;
0155 r.more.J               = J;
0156 r.more.N_ext_ext       = N_ext_ext;
0157 r.more.N_ext_bor       = N_ext_bor;
0158 r.more.N_sub_int       = N_sub_int;
0159 r.more.N_sub_bor       = N_sub_bor;
0160 r.more.epsilon_bor_bor = epsilon_bor_bor;
0161 r.more.epsilon_bor_ext = epsilon_bor_ext;
0162 r.more.epsilon_ext_ext = epsilon_ext_ext;
0163 
0164 <span class="comment">% add control by parameters</span>
0165 
0166 <span class="keyword">if</span> length(epsilon_P),
0167   epsilon_bor_p = epsilon_P(indices_act_bor,:);
0168   epsilon_ext_p = epsilon_P(indices_act_ext,:);
0169   Bu = my_N_ext_ext * epsilon_ext_p + my_N_ext_bor * epsilon_bor_p;
0170   Du = epsilon_bor_p;
0171   r.Bu              = Bu;
0172   r.Du              = Du;
0173 <span class="keyword">end</span>
0174</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>