<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of model_reduction_simulations</title>
  <meta name="keywords" content="model_reduction_simulations">
  <meta name="description" content="[tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_model_reduction</a> &gt; <a href="#">model_reduction</a> &gt; model_reduction_simulations.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_model_reduction/model_reduction&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>model_reduction_simulations
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>[tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="btsr.html" class="code" title="function  [Tl, Tr, Ar, Br, Cr, err, relative_error ] = btsr(A,B,C,ra)">btsr</a>	[T1, Tr, Ar, Br, Cr, err, relative_error] = btsr(A,B,C,ra)</li><li><a href="selective_reduction_derivative.html" class="code" title="function d_dt_z = selective_reduction_derivative(t,z,n_met_sub,ind_met_sub2bor,s0_bor,A,B,C,D,network_sub,N_sub_int,N_sub_bor,v0_bor);">selective_reduction_derivative</a>	function d_dt_z = selective_reduction_derivative(t, z, n_met_sub, ind_met_sub2bor, s0_bor, A, B, C, D, network_sub, N_sub_int, N_sub_bor, v0_bor);</li><li><a href="../../.././mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>	[t, s, s_int, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag,Tmax,dilution_rate,ode_opt)</li><li><a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>	function [label,indices] = label_names(names,allnames, method)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt-advanced/mnt_model_reduction/model_reduction.html" class="code" title="function [r,weights,tF,s_tF,tR,s_tR,x_tR,tE,s_tE,Tr,environment_metabolites] = model_reduction(network,metabolites_subsystem,ndim,verbose,s_initial,S,J,flag_graphics,t_max,gp,network_CoHid,Ec_un)">model_reduction</a>	model_reduction - Replace parts of biochemical network models by simple linear systems</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)</a>
0002 
0003 <span class="comment">% [tF,s_tF,tR,s_tR,x_tR,tE,s_tE,weights,Tr,environment_metabolites] = model_reduction_simulations(network,r,metabolites_subsystem,S,J,s_initial,t_max,ndim,verbose)</span>
0004 
0005 <span class="comment">% -------------------------------------------------------</span>
0006 <span class="comment">% Do the simulations</span>
0007 
0008 
0009 <span class="comment">% -- simulation of original model</span>
0010 
0011 s_sub_initial = s_initial(r.more.indices_met_sub);
0012 
0013 <span class="comment">% vv  = network_velocities(s_sub_initial,r.network_sub);</span>
0014 <span class="comment">% vvv = network_velocities(s_initial,network);</span>
0015 <span class="comment">% ind_int =find(network.external==0);</span>
0016 <span class="comment">% network.N(ind_int,:) * network_velocities(s_initial,network)</span>
0017 <span class="comment">% ind_int_pathway = find(r.network_sub.external==0);</span>
0018 <span class="comment">% net_prod = r.network_sub.N(ind_int_pathway,:) * network_velocities(s_sub_initial,r.network_sub) + r.N_sub_bor(ind_int_pathway,:)*r.v0_bor;</span>
0019 
0020 
0021 <span class="comment">%netgraph_concentrations(r.network_sub,net_prod,[],1);</span>
0022 
0023 <span class="keyword">if</span> verbose, fprintf(<span class="string">'  Integrating the entire model\n'</span>); <span class="keyword">end</span>
0024 [tF,s_tF] = <a href="../../.././mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>(network,s_initial,t_max*[0:0.01:1]);
0025 
0026 
0027 <span class="comment">% -- simulation of original model: environment set external</span>
0028 <span class="comment">% that is, fix the concentrations of all metabolites in the environment model</span>
0029 <span class="comment">% at the reference steady state values</span>
0030 <span class="comment">% (their names are stored in 'environment_metabolites');</span>
0031 
0032 <span class="keyword">if</span> verbose, fprintf(<span class="string">'  Integrating the model with fixed environment\n'</span>); <span class="keyword">end</span>
0033 
0034 n2       = network;
0035 in_pathway = <a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(metabolites_subsystem,n2.metabolites,<span class="string">'single'</span>);
0036 in_environment = setdiff((1:length(network.metabolites)),in_pathway);
0037 n2.external(in_environment) = 1;
0038 environment_metabolites = network.metabolites(in_environment);
0039 s_initial2 = s_initial;
0040 s_initial2(in_environment) = S(in_environment);
0041 
0042 [tE,s_tE] = <a href="../../.././mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>(n2,s_initial2,t_max*[0:0.01:1]);
0043 
0044 
0045 <span class="comment">% -- simulation of reduced model</span>
0046 
0047 s_sub_initial = s_initial(r.more.indices_met_sub);
0048 s_ext_initial = s_initial(r.more.indices_met_ext);
0049 x_initial     = s_ext_initial - r.s0_ext;
0050 
0051 z_initial = [s_sub_initial; x_initial];
0052 n_met_sub = length(r.network_sub.metabolites);
0053 
0054 <span class="keyword">if</span> verbose, fprintf(<span class="string">'  Reducing the model\n'</span>); <span class="keyword">end</span>
0055 
0056 [Tl, Tr, Ar, Br, Cr, err, relative_error] = <a href="btsr.html" class="code" title="function  [Tl, Tr, Ar, Br, Cr, err, relative_error ] = btsr(A,B,C,ra)">btsr</a>(full(r.A),r.B,r.C,ndim);
0057 
0058 xr_initial = Tl * x_initial;
0059 zr_initial = [s_sub_initial; xr_initial];
0060 
0061 <span class="keyword">if</span> verbose, fprintf(<span class="string">'  Integrating the reduced model\n'</span>); <span class="keyword">end</span>
0062 
0063 [tR,zr] = ode15s(@<a href="selective_reduction_derivative.html" class="code" title="function d_dt_z = selective_reduction_derivative(t,z,n_met_sub,ind_met_sub2bor,s0_bor,A,B,C,D,network_sub,N_sub_int,N_sub_bor,v0_bor);">selective_reduction_derivative</a>,t_max *[0:0.01:1],zr_initial,[],n_met_sub,r.ind_met_sub2bor, r.s0_bor,Ar,Br,Cr,r.D,r.network_sub,r.network_sub.N,r.N_sub_bor,r.v0_bor);
0064 
0065 s_tR = zr(:,1:n_met_sub)';
0066 x_tR = zr(:,n_met_sub+1:end)';
0067 
0068 <span class="comment">% -- transformation weights for first reduced variable</span>
0069 
0070 weights = zeros(length(network.metabolites),size(Tr,2));
0071 weights(r.more.indices_met_env,:) = Tr;
0072</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>