<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of spectral_response</title>
  <meta name="keywords" content="spectral_response">
  <meta name="description" content="SPECTRAL_RESPONSE - Compute response of kinetic model to parameter oscillation">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_spectral_response</a> &gt; spectral_response.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_spectral_response&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>spectral_response
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>SPECTRAL_RESPONSE - Compute response of kinetic model to parameter oscillation</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [c_osc, v_osc, u_osc, RS_omega, RV_omega] = spectral_response(network, network_CoHid, c_ss, v_ss, elasticities_ss, delta_par, M0, fignum,squaresize,network_CoSplit,fontsize,ind_met_ext_osc,x_osc, metabolite_color, flux_color) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> SPECTRAL_RESPONSE - Compute response of kinetic model to parameter oscillation

 [c_osc,v_osc,u_osc,RS_omega, RV_omega] = spectral_response(network, network_CoHid, c_ss, v_ss, elasticities_ss, delta_par, M0, fignum,squaresize,network_CoSplit,fontsize)

 Compute response of steady-state kinetic model to parameter oscillation

 Inputs
   delta_par - Struct defining the parameter perturbation (including frequency)
     delta_par.f              - Oscillation Frequency
     delta_par.omega          - = 2 * pi * delta_par.f;
     delta_par.type           - {'complex','sin','cos'}
     delta_par.value          - Amplitudes of perturbed parameters
     delta_par.ind_delta_par  - Indices of perturbed parameters
     delta_par.name           - List of names of these parameters (for plots)
     delta_par.basevalue      - Mean values of perturbed parameters

 Outputs
   c_osc     - Concentration amplitudes
   v_osc     - Flux amplitudes
   u_osc     - Enzyme level amplitudes
   RS_omega  - Spectral concentration response matrix
   RV_omega  - Spectral flux response matrix</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../.././mnt-advanced/mnt_spectral_response/spectral_response/osc_resp_plot_timecourses.html" class="code" title="function [RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv,fignum)">osc_resp_plot_timecourses</a>	[RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv)</li><li><a href="../.././mnt/mnt_mca/reduce_N.html" class="code" title="function [L, NR, independent_metabolites, N1,dependent_metabolites] = reduce_N(N)">reduce_N</a>	[L, NR,independent_metabolites, N1, dependent_metabolites ] = reduce_N(N)</li><li><a href="../.././mnt/mnt_network/network_query/network_analyse.html" class="code" title="function [K, L, N_R, G, pinv_N_R, indep, N_1] = network_analyse(network)">network_analyse</a>	NETWORK_ANALYSE - Analyse a metabolic network structure</li><li><a href="../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [c_osc, v_osc, u_osc, RS_omega, RV_omega] = spectral_response(network, network_CoHid, c_ss, v_ss, elasticities_ss, delta_par, M0, fignum,squaresize,network_CoSplit,fontsize,ind_met_ext_osc,x_osc, metabolite_color, flux_color)</a>
0002 
0003 <span class="comment">% SPECTRAL_RESPONSE - Compute response of kinetic model to parameter oscillation</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% [c_osc,v_osc,u_osc,RS_omega, RV_omega] = spectral_response(network, network_CoHid, c_ss, v_ss, elasticities_ss, delta_par, M0, fignum,squaresize,network_CoSplit,fontsize)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% Compute response of steady-state kinetic model to parameter oscillation</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% Inputs</span>
0010 <span class="comment">%   delta_par - Struct defining the parameter perturbation (including frequency)</span>
0011 <span class="comment">%     delta_par.f              - Oscillation Frequency</span>
0012 <span class="comment">%     delta_par.omega          - = 2 * pi * delta_par.f;</span>
0013 <span class="comment">%     delta_par.type           - {'complex','sin','cos'}</span>
0014 <span class="comment">%     delta_par.value          - Amplitudes of perturbed parameters</span>
0015 <span class="comment">%     delta_par.ind_delta_par  - Indices of perturbed parameters</span>
0016 <span class="comment">%     delta_par.name           - List of names of these parameters (for plots)</span>
0017 <span class="comment">%     delta_par.basevalue      - Mean values of perturbed parameters</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% Outputs</span>
0020 <span class="comment">%   c_osc     - Concentration amplitudes</span>
0021 <span class="comment">%   v_osc     - Flux amplitudes</span>
0022 <span class="comment">%   u_osc     - Enzyme level amplitudes</span>
0023 <span class="comment">%   RS_omega  - Spectral concentration response matrix</span>
0024 <span class="comment">%   RV_omega  - Spectral flux response matrix</span>
0025 
0026 <span class="comment">%metabolite_color = [0.7 0.4 0.1];</span>
0027 <span class="comment">%flux_color       = [0.3 0.3 0.5];</span>
0028 
0029 eval(<a href="../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'delta_par'</span>,<span class="string">'[]'</span>, <span class="string">'M0'</span>,<span class="string">'[]'</span>,<span class="string">'network_CoSplit'</span>,<span class="string">'network'</span>,<span class="string">'fontsize'</span>,<span class="string">'8'</span>));
0030 
0031 
0032 <span class="comment">% -----------------------------------------</span>
0033 <span class="comment">% Determine Jacobian</span>
0034 
0035 ind_int = find(network.external==0);
0036 
0037 <span class="keyword">if</span> isempty(M0),
0038   N_int   = network.N(ind_int,:);
0039   Ec_int  = elasticities_ss.un_E_c(:,ind_int);
0040   [L_int, NR_int] = <a href="../.././mnt/mnt_mca/reduce_N.html" class="code" title="function [L, NR, independent_metabolites, N1,dependent_metabolites] = reduce_N(N)">reduce_N</a>(N_int);
0041   M0 = full(NR_int * Ec_int * L_int);
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% -----------------------------------------</span>
0045 <span class="comment">%  Analyse Jacobian</span>
0046 
0047 figure(fignum+11);
0048 
0049 <span class="keyword">if</span> size(M0),
0050   
0051   [nm,nr]  = size(network.N);
0052   eigs     = eig(M0);
0053   osc_eigs = eigs(find(imag(eigs)~=0));
0054 
0055   <span class="comment">%% are there oscillatory eigenvalues?</span>
0056   [dum,order] = sort(-real(osc_eigs));
0057   <span class="keyword">if</span> length(order),
0058     lambda_0 = real(osc_eigs(order(1)))
0059     omega_0  = abs(imag(osc_eigs(order(1))))
0060     period   = 2 * pi/omega_0
0061   <span class="keyword">end</span>
0062   
0063   set(gca,<span class="string">'Fontsize'</span>,20); hold on;
0064   line([0 0],[-21 21]);  line([-100 1],[0 0]);
0065   h(1) = plot(real(eigs),imag(eigs),<span class="string">'ro'</span>,<span class="string">'Markersize'</span>,10); 
0066   legend(h,<span class="string">'Eigenvalues'</span>);
0067   <span class="keyword">if</span> length(order), 
0068     h(2) = plot(real(eigs), imag(eigs)-omega_0,<span class="string">'r*'</span>); 
0069     legend(h,<span class="string">'Eigenvalues'</span>,<span class="string">'Shifted down by excitation frequency'</span>);
0070   <span class="keyword">end</span>
0071   hold off
0072   
0073   mmin = min(real(eigs)); axis([1.1 * mmin, 0.1, -21, 21,]); 
0074   xlabel(<span class="string">'Real part'</span>,<span class="string">'Fontsize'</span>,16); ylabel(<span class="string">'Imaginary part'</span>,<span class="string">'Fontsize'</span>,16);
0075   set(gca,<span class="string">'Fontsize'</span>,20);
0076   <span class="comment">%title('Eigenvalues of Jacobian','Fontsize',16);</span>
0077   
0078 <span class="keyword">end</span>
0079 
0080 
0081 <span class="comment">% ----------------------------------------</span>
0082 <span class="comment">% Perturbation (maximal amplitude) in the time domain -&gt; for frequency domain * 1/sqrt(2 pi)</span>
0083 
0084 <span class="comment">% if isempty(delta_par),</span>
0085 <span class="comment">%   delta_par.f             = 0.1;</span>
0086 <span class="comment">%   delta_par.omega         = 2 * pi * delta_par.f;</span>
0087 <span class="comment">%   delta_par.type          = 'complex';</span>
0088 <span class="comment">%   delta_par.value         = 5;</span>
0089 <span class="comment">%   delta_par.ind_delta_par = 1;</span>
0090 <span class="comment">%   delta_par.name          = {'First parameter'};</span>
0091 <span class="comment">%   delta_par.basevalue     = network.kinetics.u(delta_par.ind_delta_par);</span>
0092 <span class="comment">% end</span>
0093 
0094 
0095 <span class="comment">% -----------------------------------------</span>
0096 <span class="comment">% simulate forced oscillations</span>
0097 
0098 <span class="comment">%T1      = min(500,5/abs(max(real(eigs))));</span>
0099 <span class="comment">%T2      = 1/delta_par.f;</span>
0100 <span class="comment">%[t,x,v] = network_integrate(c_ss,p,T1,T2,network.N,network.kinetics.velocity_function,delta_par);</span>
0101 
0102 t = [];
0103 x = [];
0104 v = [];
0105 
0106 <span class="comment">% figure(fignum+14); plot(t,x); %legend(network.metabolites);</span>
0107 
0108 orderx = 1:sum(network.external==0);
0109 orderv = 1:length(network.actions);
0110 color  = <span class="string">'copper'</span>;
0111 t_sim  = [0:0.005:1] * 2*pi/delta_par.omega;
0112 
0113 [K, L, N0] = <a href="../.././mnt/mnt_network/network_query/network_analyse.html" class="code" title="function [K, L, N_R, G, pinv_N_R, indep, N_1] = network_analyse(network)">network_analyse</a>(network);
0114 network.L  = L;
0115 network.N0 = N0;
0116 ind_int = find(network.external==0);
0117 
0118 epsilon_1 = elasticities_ss.un_E_c(:,ind_int);
0119 pi_1      = elasticities_ss.un_E_u;
0120 epsilon_2 = elasticities_ss.un_E_cc(:,ind_int,ind_int);
0121 rho_2     = elasticities_ss.un_E_cu(:,ind_int,:);
0122 pi_2      = elasticities_ss.un_E_uu;
0123 
0124 [RS_omega, RV_omega] = <a href="../.././mnt-advanced/mnt_spectral_response/spectral_response/osc_resp_plot_timecourses.html" class="code" title="function [RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv,fignum)">osc_resp_plot_timecourses</a>(network,t_sim,c_ss,v_ss,t,x,v,M0,delta_par, epsilon_1, pi_1, epsilon_2, rho_2, pi_2, color, orderx,[],fignum);
0125 
0126 [nm,nr] = size(network.N);
0127 
0128 
0129 <span class="comment">% ----------------------------------------------------</span>
0130 <span class="comment">% show 1st order results on network</span>
0131 
0132 circle_size = 2 * squaresize; 
0133 
0134 pp = delta_par.ind_delta_par;
0135 rm = network_CoSplit.graphics_par.reaction_mapping;
0136 mm = network_CoSplit.graphics_par.metabolite_mapping;
0137 
0138 
0139 c_osc          = zeros(nm,1);
0140 c_osc(ind_int) = RS_omega(:,pp) * delta_par.value;
0141 c_osc(ind_met_ext_osc) = x_osc;
0142 v_osc          = RV_omega(:,pp) * delta_par.value;
0143 u_osc          = zeros(nr,1);
0144 
0145 <span class="comment">% ----------------------------------------------------</span>
0146 <span class="comment">% display absolute change</span>
0147 
0148 display_periodic_quantities_on_network(network_CoSplit, network, c_osc, v_osc, c_ss, v_ss, squaresize, circle_size, fontsize, [fignum+12, fignum+13], metabolite_color, flux_color);
0149 
0150 <span class="comment">% ----------------------------------------------------</span>
0151 <span class="comment">% display relative change</span>
0152 
0153 display_periodic_quantities_on_network(network_CoSplit, network, c_osc./c_ss, v_osc./v_ss, c_ss, v_ss, squaresize, circle_size, fontsize, [fignum+14, fignum+15], metabolite_color, flux_color);
0154</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>