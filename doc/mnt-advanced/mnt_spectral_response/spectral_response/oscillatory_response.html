<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of oscillatory_response</title>
  <meta name="keywords" content="oscillatory_response">
  <meta name="description" content="this is an updated version of osc_resp_plot_timecourse">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_spectral_response</a> &gt; <a href="#">spectral_response</a> &gt; oscillatory_response.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_spectral_response/spectral_response&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>oscillatory_response
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>this is an updated version of osc_resp_plot_timecourse</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function rr = oscillatory_response(network,x_ss,v_ss,M0,delta_par,E,ind_int,par,Ea) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> this is an updated version of osc_resp_plot_timecourse
 arguments: E structure of elasticity matrices, Ec, Ep, Ecc, Epc, Epp
 Ea: elasticities for assignment functions</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt/mnt_mca/spectral_response_coefficients.html" class="code" title="function [RS_omega,RJ_omega,RS_2_2omega,RJ_2_2omega,RS_2_2omega0,RJ_2_2omega0,CS_omega,CS_2_omega,CJ_omega,CJ_2_omega] = spectral_response_coefficients(N0,L,M0,delta_par,Ec,Ep,Ecc,Ecp,Epp)">spectral_response_coefficients</a>	[RS, RJ, RS_2_2omega, RJ_2_2omega, RS_2_2omega0, RJ_2_2omega0, CS,CS_2_omega,CJ,CJ_2_omega] = ...</li><li><a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>	C = tensor_product(A,B,index_A,index_B)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function rr = oscillatory_response(network,x_ss,v_ss,M0,delta_par,E,ind_int,par,Ea)</a>
0002 
0003 <span class="comment">% this is an updated version of osc_resp_plot_timecourse</span>
0004 <span class="comment">% arguments: E structure of elasticity matrices, Ec, Ep, Ecc, Epc, Epp</span>
0005 <span class="comment">% Ea: elasticities for assignment functions</span>
0006 
0007 pp = network.kinetics.parameters;
0008 
0009 [nm,nr]  = size(network.N);
0010 
0011 eval(<a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'ind_int'</span>,<span class="string">'1:nm'</span>));
0012 
0013 t     = par.t_appr;
0014 omega = delta_par.omega;
0015 
0016 <span class="comment">% ----------------------------------------</span>
0017 <span class="comment">% compute response coefficients</span>
0018 
0019 [RS_omega,RV_omega,RS_2_2omega,RV_2_2omega,RS_2_2omega0,RV_2_2omega0] = <span class="keyword">...</span>
0020     <a href="../../.././mnt/mnt_mca/spectral_response_coefficients.html" class="code" title="function [RS_omega,RJ_omega,RS_2_2omega,RJ_2_2omega,RS_2_2omega0,RJ_2_2omega0,CS_omega,CS_2_omega,CJ_omega,CJ_2_omega] = spectral_response_coefficients(N0,L,M0,delta_par,Ec,Ep,Ecc,Ecp,Epp)">spectral_response_coefficients</a>(network.NR,network.L,M0,delta_par,E.Ec(:,ind_int),E.Ep,E.Ecc(:,ind_int,ind_int),E.Ecp(:,ind_int,:),E.Epp);
0021 
0022 <span class="comment">% --------------------------------------------------------------------------</span>
0023 
0024 dp = zeros(length(fields(pp)),1);
0025 dp(find(strcmp(fields(pp),delta_par.name))) = delta_par.value;
0026 dp = sqrt(2*pi) * dp;   <span class="comment">% value in the frequency domain</span>
0027 
0028 delta_S    = 1/sqrt(2*pi) *                      RS_omega             * dp;
0029 delta_S2   = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RS_2_2omega,dp, 2,1) * dp;
0030 delta_S2_0 = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RS_2_2omega0,dp,2,1) * (dp.'');
0031 
0032 delta_V    = 1/sqrt(2*pi) *                      RV_omega             * dp;
0033 delta_V2   = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RV_2_2omega, dp,2,1) * dp;
0034 delta_V2_0 = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RV_2_2omega0,dp,2,1) * (dp.'');
0035 
0036 <span class="comment">% the second order response coefficients contain already a factor 1/sqrt(2*pi),</span>
0037 <span class="comment">% so all sqrt(2*pi) factors cancel out in the end</span>
0038 
0039 <span class="keyword">switch</span> delta_par.type,
0040   
0041   <span class="keyword">case</span> <span class="string">'cos'</span>,
0042     x_order0 = repmat(x_ss(ind_int),1,length(t)).';
0043     x_order1 = real( delta_S *  exp( i     * omega * t) ).';
0044     x_order2 = 0.25 * real( delta_S2 * exp( i * 2 * omega * t) ).' + 0.25 * repmat(real(delta_S2_0),1,length(t)).';
0045     
0046     v_order0 = repmat(v_ss,1,length(t)).' ;
0047     v_order1 = real(delta_V  * exp( i *     omega * t) ).';
0048     v_order2 = 0.25 * real(delta_V2 * exp( i * 2 * omega * t) ).'  + 0.25 * repmat(real(delta_V2_0),1,length(t)).';
0049     
0050   <span class="keyword">case</span> <span class="string">'complex'</span>,
0051     x_order0 = repmat(x_ss(ind_int), 1, length(t) ).';
0052     x_order1 = real((delta_S  * exp( i *     omega * t)).');
0053     x_order2 = real((delta_S2 * exp( i * 2 * omega * t)).');
0054     
0055     v_order0 = repmat(v_ss, 1, length(t)).' ;
0056     v_order1 = real((delta_V  * exp( i *     omega * t)).');
0057     v_order2 = real((delta_V2 * exp( i * 2 * omega * t)).');
0058 
0059   <span class="keyword">otherwise</span>, error(<span class="string">'Type of perturbation not supported'</span>);  
0060 
0061 <span class="keyword">end</span>
0062 
0063 xo0 = repmat(x_ss.',length(t),1);
0064 xo1 = zeros(length(t),nm);
0065 xo2 = nan*zeros(length(t),nm);
0066 
0067 xo0(:,ind_int) = x_order0;
0068 xo1(:,ind_int) = x_order1;
0069 xo2(:,ind_int) = x_order2;
0070 
0071 x_appr  = xo0 + xo1;
0072 x_appr2 = x_appr + xo2;
0073 v_appr  = v_order0 + v_order1;
0074 v_appr2 = v_appr   + v_order2;
0075 
0076 rr.RS_omega   = RS_omega  ;
0077 rr.RV_omega   = RV_omega  ;
0078 rr.x_appr     = x_appr    ;
0079 rr.x_appr2    = x_appr2   ;
0080 rr.v_appr     = v_appr    ;
0081 rr.v_appr2    = v_appr2   ;
0082 rr.x_appr_offset = delta_S2_0;
0083 rr.v_appr_offset = delta_V2_0;
0084 rr.t          = t;
0085 
0086 <span class="comment">% if exist('Ea','var'),</span>
0087 <span class="comment">%   delta_p = dp * real( exp( i     * omega * t) );</span>
0088 <span class="comment">%   x_assign = feval(network.kinetics.assignment_function,x_ss,network.kinetics.parameters);</span>
0089 <span class="comment">% end</span>
0090</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>