<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of osc_resp_plot_timecourses</title>
  <meta name="keywords" content="osc_resp_plot_timecourses">
  <meta name="description" content="[RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_spectral_response</a> &gt; <a href="#">spectral_response</a> &gt; osc_resp_plot_timecourses.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_spectral_response/spectral_response&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>osc_resp_plot_timecourses
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>[RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv,fignum) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv)

 Plot forced oscillations (in a second-order approximation)
 Only internal metabolites are shown</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt/mnt_mca/spectral_response_coefficients.html" class="code" title="function [RS_omega,RJ_omega,RS_2_2omega,RJ_2_2omega,RS_2_2omega0,RJ_2_2omega0,CS_omega,CS_2_omega,CJ_omega,CJ_2_omega] = spectral_response_coefficients(N0,L,M0,delta_par,Ec,Ep,Ecc,Ecp,Epp)">spectral_response_coefficients</a>	[RS, RJ, RS_2_2omega, RJ_2_2omega, RS_2_2omega0, RJ_2_2omega0, CS,CS_2_omega,CJ,CJ_2_omega] = ...</li><li><a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../.././mnt/utils/line_colors.html" class="code" title="function line_colors(xxx,color_map_name)">line_colors</a>	line_colors(xxx,color_map_name)</li><li><a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>	C = tensor_product(A,B,index_A,index_B)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt-advanced/mnt_spectral_response/spectral_response.html" class="code" title="function [c_osc, v_osc, u_osc, RS_omega, RV_omega] = spectral_response(network, network_CoHid, c_ss, v_ss, elasticities_ss, delta_par, M0, fignum,squaresize,network_CoSplit,fontsize,ind_met_ext_osc,x_osc, metabolite_color, flux_color)">spectral_response</a>	SPECTRAL_RESPONSE - Compute response of kinetic model to parameter oscillation</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv,fignum)</a>
0002 
0003 <span class="comment">% [RS_omega,RV_omega] = osc_resp_plot_timecourses(network,t_appr,x_ss,v_ss,t,x,v,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2,color,orderx,orderv)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Plot forced oscillations (in a second-order approximation)</span>
0006 <span class="comment">% Only internal metabolites are shown</span>
0007 
0008 ind_int  = find(network.external==0);
0009 x_ss_int = x_ss(ind_int);
0010 
0011 eval(<a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'color'</span>,<span class="string">'[]'</span>,<span class="string">'orderv'</span>,<span class="string">'[]'</span>,<span class="string">'network_CoSplit'</span>,<span class="string">'network'</span>));
0012 
0013 <span class="keyword">if</span> isfield(network.kinetics,<span class="string">'parameters'</span>),
0014   p       = network.kinetics.parameters;
0015   <span class="keyword">if</span> iscell(delta_par_struct.name),
0016     ind_delta_par = [];
0017     <span class="keyword">for</span> it=1:length(delta_par_struct.name),
0018       p_value(it) = getfield(p,delta_par_struct.name{it});
0019       ind_delta_par = [ind_delta_par, find(strcmp(fields(p),delta_par_struct.name{it}))];
0020     <span class="keyword">end</span>
0021   <span class="keyword">else</span>,
0022     p_value = getfield(p,delta_par_struct.name);
0023     ind_delta_par = find(strcmp(fields(p),delta_par_struct.name));
0024   <span class="keyword">end</span>
0025 <span class="keyword">else</span>
0026   ind_delta_par = delta_par_struct.ind_delta_par;
0027   p_value       = delta_par_struct.basevalue;
0028 <span class="keyword">end</span>
0029 
0030 n_par = length(pi_1);
0031 <span class="comment">%n_met = length(network.metabolites);</span>
0032 n_rea = length(network.actions);
0033 
0034 <span class="keyword">if</span> isempty(orderv), orderv= 1:n_rea; <span class="keyword">end</span>
0035 
0036 <span class="comment">%  [dum,orderv]=sort(-abs(abs(delta_V)./v_ss));</span>
0037 <span class="comment">%  [dum,orderx]=sort(-(max(abs(x))-min(abs(x))./x_ss_int'));</span>
0038 
0039 
0040 <span class="comment">% ----------------------------------------</span>
0041 <span class="comment">% compute response coefficients</span>
0042 
0043 [RS_omega,RV_omega,RS_2_2omega,RV_2_2omega,RS_2_2omega0,RV_2_2omega0] = <span class="keyword">...</span>
0044     <a href="../../.././mnt/mnt_mca/spectral_response_coefficients.html" class="code" title="function [RS_omega,RJ_omega,RS_2_2omega,RJ_2_2omega,RS_2_2omega0,RJ_2_2omega0,CS_omega,CS_2_omega,CJ_omega,CJ_2_omega] = spectral_response_coefficients(N0,L,M0,delta_par,Ec,Ep,Ecc,Ecp,Epp)">spectral_response_coefficients</a>(network.N0,network.L,M0,delta_par_struct,epsilon_1,pi_1,epsilon_2,rho_2,pi_2);
0045 
0046 <span class="comment">%figure(fignum+3); im(abs(RS_omega(:,:))',[],fieldnames(p),network.metabolites)</span>
0047 <span class="comment">%figure(fignum+4); im(abs(squeeze(RS_2_2omega(1,:,:))),[],fieldnames(p),fieldnames(p))</span>
0048 
0049 <span class="comment">% --------------------------------------------------------------------------</span>
0050 
0051 delta_par = zeros(n_par,1);
0052 delta_par(ind_delta_par) = delta_par_struct.value;
0053 delta_par = sqrt(2*pi) * delta_par;   <span class="comment">% value in the frequency domain</span>
0054 
0055 delta_S    = 1/sqrt(2*pi) *                      RS_omega * delta_par;
0056 delta_S2   = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RS_2_2omega,delta_par, 2,1) * delta_par;
0057 delta_S2_0 = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RS_2_2omega0,delta_par,2,1) * (delta_par.'');
0058 
0059 delta_V    = 1/sqrt(2*pi) *                      RV_omega * delta_par;
0060 delta_V2   = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RV_2_2omega, delta_par,2,1) * delta_par;
0061 delta_V2_0 = 1/sqrt(2*pi) * 0.5 * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(RV_2_2omega0,delta_par,2,1) * (delta_par.'');
0062 
0063 <span class="keyword">switch</span> delta_par_struct.type,
0064   <span class="keyword">case</span> <span class="string">'cos'</span>,
0065     x_order0 = repmat(x_ss_int + real(delta_S2_0),1,length(t_appr)).';
0066     x_order1 = real(delta_S *  exp( i *     delta_par_struct.omega*t_appr)).';
0067     x_order2 = real(delta_S2 * exp( i * 2 * delta_par_struct.omega*t_appr)).';
0068 
0069     v_order0 = repmat(v_ss+real(delta_V2_0),1,length(t_appr)).' ;
0070     v_order1 = real(delta_V *  exp( i *     delta_par_struct.omega*t_appr)).';
0071     v_order2 = real(delta_V2 * exp( i * 2 * delta_par_struct.omega*t_appr)).';
0072   
0073 <span class="keyword">case</span> <span class="string">'complex'</span>,
0074   x_order0 = repmat(x_ss_int ,1,length(t_appr) ).';
0075   x_order1 = real((delta_S *  exp( i *     delta_par_struct.omega*t_appr)).');
0076   x_order2 = real((delta_S2 * exp( i * 2 * delta_par_struct.omega*t_appr)).');
0077   x        = real(x);
0078 
0079   v_order0 = repmat(v_ss,1,length(t_appr)).' ;
0080   v_order1 = real((delta_V *  exp( i *     delta_par_struct.omega*t_appr)).');
0081   v_order2 = real((delta_V2 * exp( i * 2 * delta_par_struct.omega*t_appr)).');
0082   v        = real(v);
0083 <span class="keyword">end</span>
0084 
0085 x_appr  = x_order0 + x_order1;
0086 x_appr2 = x_appr   + x_order2;
0087 v_appr  = v_order0 + v_order1;
0088 v_appr2 = v_appr   + v_order2;
0089 
0090 <span class="comment">% -----------------------------------------------------------------------------------------</span>
0091 
0092 n_osc = length(delta_par_struct.value);
0093 
0094 figure(fignum+1); clf
0095 [ni,nk] = subplot_n(length(orderx)+n_osc);
0096 <span class="keyword">for</span> it = 1:n_osc,
0097   subplot(nk,ni,it); <span class="comment">% set(gca,'FontSize',6);</span>
0098   plot(t_appr,real(p_value(it) + delta_par_struct.value(it) * exp( i * delta_par_struct.omega*t_appr)).',<span class="string">'k'</span>); 
0099   title([<span class="string">'\Delta'</span> delta_par_struct.name{it},0]); axis tight; <span class="comment">% set(gca,'FontSize',6);</span>
0100 <span class="keyword">end</span>
0101 
0102 <span class="keyword">if</span> color,
0103 
0104 <span class="keyword">for</span> k=1:length(orderx),  
0105   subplot(nk,ni,k+n_osc);
0106   l = orderx(k);
0107   <span class="keyword">if</span> size(x),
0108     line1 = plot(t,x(:,l)); 
0109   <span class="keyword">else</span> line1 = plot([],[]);
0110   <span class="keyword">end</span>
0111   hold on; 
0112   line2 = plot(t_appr,x_ss_int(l)*ones(size(t_appr)),<span class="string">'g'</span>);
0113   line3 = plot(t_appr,x_appr(:,l),<span class="string">'r'</span>); 
0114   line4 = plot(t_appr,x_appr2(:,l),<span class="string">'m'</span>); 
0115   <span class="keyword">if</span> strcmp(delta_par_struct.type,<span class="string">'cos'</span>),  plot(t_appr,((x_ss_int(l)+real(delta_S2_0(l))))*ones(size(t_appr)),<span class="string">'c-.'</span>); <span class="keyword">end</span>
0116   axis tight
0117   <a href="../../.././mnt/utils/line_colors.html" class="code" title="function line_colors(xxx,color_map_name)">line_colors</a>([line1,line2,line3,line4]',color);
0118   title(network.metabolites{ind_int(l)}); 
0119   <span class="keyword">if</span> k&lt;20, set(gca,<span class="string">'XTick'</span>,[]); <span class="keyword">end</span>
0120   hold off
0121   <a href="../../.././mnt/utils/line_colors.html" class="code" title="function line_colors(xxx,color_map_name)">line_colors</a>([line1,line2,line3,line4]',color);
0122 <span class="keyword">end</span>
0123 
0124 <span class="keyword">else</span>, <span class="comment">% black and white</span>
0125   
0126 <span class="keyword">for</span> k=1:length(orderx),  
0127   subplot(nk,ni,k+1);
0128   l=orderx(k);  
0129   line1 = plot(t,x(:,l)); hold on; 
0130   line2 = plot(t_appr,x_ss_int(l)*ones(size(t_appr)),<span class="string">'g'</span>);
0131   line3 = plot(t_appr,x_appr(:,l),<span class="string">'r:'</span>); 
0132   line4 = plot(t_appr,x_appr2(:,l),<span class="string">'m--'</span>); 
0133   <span class="keyword">if</span> strcmp(delta_par_struct.type,<span class="string">'cos'</span>),  plot(t_appr,((x_ss_int(l)+real(delta_S2_0(l))))*ones(size(t_appr)),<span class="string">'c-.'</span>); <span class="keyword">end</span>
0134   axis tight
0135   title(network.metabolites{ind_int(l)},0); 
0136   <span class="keyword">if</span> k&lt;20, set(gca,<span class="string">'XTick'</span>,[]); <span class="keyword">end</span>
0137   hold off
0138 <span class="keyword">end</span>
0139 
0140 <span class="keyword">end</span>
0141 
0142 <span class="comment">% reactions, unnormalised</span>
0143 
0144 figure(fignum+2); clf
0145 [ni,nk] = subplot_n(n_rea);
0146 
0147 <span class="keyword">for</span> k=1:n_rea,
0148   subplot(nk,ni,k);
0149   l=orderv(k);
0150   <span class="keyword">if</span> length(v),
0151   plot(t,v(:,l)); 
0152   <span class="keyword">else</span> plot([],[]); 
0153   <span class="keyword">end</span>
0154   hold on; 
0155   <span class="keyword">if</span> color,
0156     line1 = plot(t_appr,v_ss(l)*ones(size(t_appr)));
0157     <span class="keyword">if</span> strcmp(delta_par_struct.type,<span class="string">'cos'</span>),  
0158       line2 = plot(t_appr,((v_ss(l)+real(delta_V2_0(l))))*ones(size(t_appr))); 
0159     <span class="keyword">else</span> line2 = plot([]);
0160     <span class="keyword">end</span>
0161     line3 = plot(t_appr,v_appr(:,l)); 
0162     line4 = plot(t_appr,v_appr2(:,l)); 
0163     <a href="../../.././mnt/utils/line_colors.html" class="code" title="function line_colors(xxx,color_map_name)">line_colors</a>([line1,line2,line3,line4]',<span class="string">'color_scale_grey'</span>);
0164   <span class="keyword">else</span>,
0165     line1 = plot(t_appr,v_ss(l)*ones(size(t_appr)),<span class="string">'k'</span>);
0166     <span class="keyword">if</span> strcmp(delta_par_struct.type,<span class="string">'cos'</span>),  
0167       line2 = plot(t_appr,((v_ss(l)+real(delta_V2_0(l))))*ones(size(t_appr)),<span class="string">'k-.'</span>); 
0168     <span class="keyword">end</span>
0169     line3 = plot(t_appr,v_appr(:,l),<span class="string">'k:'</span>); 
0170     line4 = plot(t_appr,v_appr2(:,l),<span class="string">'k--'</span>); 
0171     <a href="../../.././mnt/utils/line_colors.html" class="code" title="function line_colors(xxx,color_map_name)">line_colors</a>([line1,line2,line3,line4]',color);    
0172   <span class="keyword">end</span>
0173   axis tight
0174   title(network.actions{l}); 
0175   <span class="keyword">if</span> k&lt;20, set(gca,<span class="string">'XTick'</span>,[]); <span class="keyword">end</span>
0176   hold off
0177 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>