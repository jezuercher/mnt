<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of oscillatory_response_rectangular</title>
  <meta name="keywords" content="oscillatory_response_rectangular">
  <meta name="description" content="this is an updated version of osc_resp_plot_timecourse">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_spectral_response</a> &gt; <a href="#">spectral_response</a> &gt; oscillatory_response_rectangular.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_spectral_response/spectral_response&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>oscillatory_response_rectangular
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>this is an updated version of osc_resp_plot_timecourse</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function rr = oscillatory_response_rectangular(network,x_ss,v_ss,M0,delta_par,E,ind_int,par,Ea) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> this is an updated version of osc_resp_plot_timecourse
 arguments: E structure of elasticity matrices, Ec, Ep, Ecc, Epc, Epp
 Ea: elasticities for assignment functions</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt/mnt_network/network_query/network_analyse.html" class="code" title="function [K, L, N_R, G, pinv_N_R, indep, N_1] = network_analyse(network)">network_analyse</a>	NETWORK_ANALYSE - Analyse a metabolic network structure</li><li><a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function rr = oscillatory_response_rectangular(network,x_ss,v_ss,M0,delta_par,E,ind_int,par,Ea)</a>
0002 
0003 <span class="comment">% this is an updated version of osc_resp_plot_timecourse</span>
0004 <span class="comment">% arguments: E structure of elasticity matrices, Ec, Ep, Ecc, Epc, Epp</span>
0005 <span class="comment">% Ea: elasticities for assignment functions</span>
0006 
0007 pp       = network.kinetics.parameters;
0008 [nm,nr]  = size(network.N);
0009 
0010 [K, L, N_R, G, pinv_N_R, indep, N_1] = <a href="../../.././mnt/mnt_network/network_query/network_analyse.html" class="code" title="function [K, L, N_R, G, pinv_N_R, indep, N_1] = network_analyse(network)">network_analyse</a>(network);
0011 
0012 eval(<a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'ind_int'</span>,<span class="string">'1:nm'</span>));
0013 
0014 t       = par.t_appr;
0015 omega   = delta_par.omega;
0016 ind_osc = find(strcmp(delta_par.name,E.parameters));
0017 
0018 <span class="comment">% ----------------------------------------</span>
0019 <span class="comment">% compute response coefficients</span>
0020 
0021 c_int = x_ss(ind_int);
0022 c_ind = c_int(indep);
0023 p     = E.p;
0024 
0025 C = zeros(length(x_ss),length(c_ind));
0026 
0027 <span class="keyword">if</span> par.logarithmic,
0028 
0029   u_mean = mean([ log(delta_par.value_max), log(delta_par.value_min) ] );
0030   u_ampl = 0.5 * [log(delta_par.value_max) - log(delta_par.value_min) ] ;
0031   A      = diag(1./c_ind) * N_R * E.Ec(:,ind_int) * L * diag(c_ind);
0032   B      = diag(1./c_ind) * N_R * E.Ep * diag(p);
0033   C(ind_int,:) = diag(1./c_int) * L * diag(c_ind);
0034   D = [];
0035   
0036 <span class="keyword">else</span>
0037   
0038   u_mean = mean([ delta_par.value_max, delta_par.value_min ] );
0039   u_ampl = 0.5 * [delta_par.value_max - delta_par.value_min ] ;
0040   A      = N_R * E.Ec(:,ind_int) * L;
0041   B      = N_R * E.Ep;
0042   C(ind_int,:) = L;
0043   D            = [];
0044 
0045 <span class="keyword">end</span>
0046 
0047 clear this_delta_x;
0048 
0049 <span class="keyword">for</span> it_mode = 1:par.max_mode
0050   this_omega      = it_mode * omega;
0051 <span class="comment">% this_rect_coeff = double(it_mode==1); % TEST -&gt;  cosine profile</span>
0052   a = 1;
0053   this_rect_coeff = - i * 4*a/pi * [mod(it_mode,2)] / it_mode * exp(i * pi/2*it_mode);  <span class="comment">% rectangular profile</span>
0054   this_R_spectral = -C * inv(A-i*this_omega*eye(size(A)))*B;<span class="comment">%+D;</span>
0055   this_delta_x(:,it_mode) = this_R_spectral(:,ind_osc) *  this_rect_coeff * u_ampl;
0056   this_delta_p(it_mode)   =                               this_rect_coeff * u_ampl;
0057 <span class="keyword">end</span> 
0058 
0059 delta_x = real(this_delta_x *  exp( i * [1:par.max_mode]' * omega * t) );
0060 delta_p = real(this_delta_p *  exp( i * [1:par.max_mode]' * omega * t) );
0061 
0062 <span class="keyword">if</span> par.logarithmic,
0063   x_appr = exp(repmat(log(x_ss),1,length(t)) + delta_x);
0064   p_appr = exp(repmat(u_mean,1,length(t)) + delta_p);
0065 <span class="keyword">else</span>
0066   x_appr = repmat(x_ss,1,length(t)) + delta_x;
0067   p_appr = repmat(u_mean,1,length(t)) + delta_p;
0068 <span class="keyword">end</span>
0069 
0070 rr.x_appr        = x_appr'  ;
0071 rr.p_appr        = p_appr'  ;
0072 rr.t             = t;
0073 rr.RS_omega      = [];
0074 rr.RV_omega      = [];
0075 rr.v_appr        = []  ;
0076 rr.x_appr2       = [];
0077 rr.v_appr2       = [];
0078 rr.x_appr_offset = [];
0079 rr.v_appr_offset = [];</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>