<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of spec_resp_par_sensitivity</title>
  <meta name="keywords" content="spec_resp_par_sensitivity">
  <meta name="description" content="this is an updated version of osc_resp_plot_timecourse">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_spectral_response</a> &gt; <a href="#">spectral_response</a> &gt; spec_resp_par_sensitivity.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_spectral_response/spectral_response&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>spec_resp_par_sensitivity
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>this is an updated version of osc_resp_plot_timecourse</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function rr = spec_resp_par_sensitivity(network,M0,omega_mean,E,ind_int,osc_in,osc_out,plot_parameters2,plot_parameters1) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> this is an updated version of osc_resp_plot_timecourse
 arguments: E structure of elasticity matrices, Ec, Ep, Ecc, Epc, Epp
 Ea: elasticities for assignment functions</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>	function [label,indices] = label_names(names,allnames, method)</li><li><a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>	C = tensor_product(A,B,index_A,index_B)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function rr = spec_resp_par_sensitivity(network,M0,omega_mean,E,ind_int,osc_in,osc_out,plot_parameters2,plot_parameters1)</a>
0002 
0003 <span class="comment">% this is an updated version of osc_resp_plot_timecourse</span>
0004 <span class="comment">% arguments: E structure of elasticity matrices, Ec, Ep, Ecc, Epc, Epp</span>
0005 <span class="comment">% Ea: elasticities for assignment functions</span>
0006 
0007 
0008 pp = network.kinetics.parameters;
0009 rr = [];
0010 
0011 [nm,nr]  = size(network.N);
0012 
0013 eval(<a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'ind_int'</span>,<span class="string">'1:nm'</span>));
0014 
0015 omega_list = omega_mean * 10.^[-3:0.1:2];
0016 
0017 <span class="comment">% ----------------------------------------</span>
0018 <span class="comment">% compute 2nd order spectral response coefficients</span>
0019 <span class="comment">% where first perturbation is at frequency omega</span>
0020 <span class="comment">% and second perturbation is static (frequency 0)</span>
0021 
0022 <span class="comment">% set alpha = omega, beta = 0 in formula</span>
0023 
0024 clear i;
0025 N0        = network.NR;
0026 epsilon_1 = E.Ec(:,ind_int);
0027 pi_1      = E.Ep;
0028 epsilon_2 = E.Ecc(:,ind_int,ind_int);
0029 rho_2     = E.Ecp(:,ind_int,:);
0030 pi_2      = E.Epp;
0031 L         = network.L;
0032 n_react = size(N0,2);
0033 n_indep = size(N0,1);
0034 
0035 <span class="keyword">if</span> ~exist(<span class="string">'M0'</span>,<span class="string">'var'</span>), M0 = N0 * epsilon_1 * L;  <span class="keyword">end</span>
0036 
0037 <span class="keyword">if</span> rank(full(M0))&lt;size(M0,1), warning(<span class="string">'Jacobian of lin. independent variables is rank-deficient! Using pinv instead of inv'</span>); <span class="keyword">end</span>
0038 
0039 CS          = - L  * pinv(full(M0)) * N0;
0040 RS          =   CS * pi_1;
0041 
0042 <span class="keyword">for</span> it = 1:length(omega_list),
0043 
0044   CS_omega    = - L * pinv(full(M0 -i * omega_list(it) * eye(n_indep))) * N0;
0045   RS_omega    =   CS_omega * pi_1;
0046 
0047   Gamma_omega_omega =  <span class="keyword">...</span>
0048       <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(<a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(epsilon_2,RS_omega,3,1),RS,2,1) <span class="keyword">...</span>
0049       + <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(rho_2,RS,2,1) <span class="keyword">...</span>
0050       + permute(<a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(rho_2,RS_omega,2,1),[1,3,2])<span class="keyword">...</span>
0051       + pi_2;
0052 
0053   RS_omega_list(it,:,:,:)  = RS_omega;
0054   RS_omega_0(it,:,:,:)     = 1/sqrt(2*pi) * <a href="../../.././mnt/utils/tensor_product.html" class="code" title="function C = tensor_product(A,B,index_A,index_B)">tensor_product</a>(CS_omega,Gamma_omega_omega);
0055   
0056 <span class="keyword">end</span>
0057 
0058 parameter_names = fieldnames(network.kinetics.parameters);
0059 
0060 ind_osc = find(strcmp(osc_in,parameter_names));
0061 ind_out = find(strcmp(osc_out,network.metabolites));
0062 
0063 RS_omega_relevant   = squeeze(RS_omega_list(:,ind_out,ind_osc));
0064 RS_omega_0_relevant = squeeze(RS_omega_0(:,ind_out,ind_osc,:));
0065 
0066 <span class="comment">% --------------------------------------------------------------------------------------</span>
0067 <span class="comment">% mixed spectral sensitivities</span>
0068 
0069 
0070 figure(16); clf
0071 [ni,nk] = subplot_n(length(plot_parameters2));
0072 
0073 <span class="keyword">for</span> it = 1:length(plot_parameters2),
0074   subplot(ni,nk,it);
0075   ind = <a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(plot_parameters2(it), parameter_names);
0076   plot(omega_list,real(RS_omega_0_relevant(:,ind)) * E.p(ind),<span class="string">'b'</span>); hold on
0077   plot(omega_list,imag(RS_omega_0_relevant(:,ind)) * E.p(ind),<span class="string">'r'</span>); 
0078   plot(omega_list,abs(RS_omega_0_relevant(:,ind))  * E.p(ind),<span class="string">'k'</span>);
0079   set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>); axis tight
0080   a = axis; plot([a(1) a(2)],[0,0],<span class="string">'-'</span>,<span class="string">'Color'</span>,[.5 .5 .5]); hold off
0081   title(strrep(plot_parameters2{it},<span class="string">'_'</span>,<span class="string">' '</span>));
0082 <span class="keyword">end</span>
0083 
0084 <span class="comment">% changes of spectral response coefficients</span>
0085 
0086 figure(17); clf
0087 
0088 dd      = 0.05;  <span class="comment">% percentage change of parameters</span>
0089 
0090 <span class="keyword">for</span> it = 1:length(plot_parameters2),
0091   subplot(ni,nk,it);
0092   ind = <a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(plot_parameters2(it), parameter_names);
0093   changed = RS_omega_relevant + [ RS_omega_0_relevant(:,ind) + RS(ind_out,ind) ] * dd * E.p(ind);
0094   plot(omega_list,real(RS_omega_relevant),<span class="string">'b'</span>); hold on
0095   plot(omega_list,imag(RS_omega_relevant),<span class="string">'r'</span>); 
0096   plot(omega_list,abs(RS_omega_relevant),<span class="string">'k'</span>);
0097   plot(omega_list,real(changed),<span class="string">'b--'</span>); hold on
0098   plot(omega_list,imag(changed),<span class="string">'r--'</span>); 
0099   plot(omega_list,abs(changed),<span class="string">'k--'</span>); 
0100   set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>); axis tight
0101   a = axis; plot([a(1) a(2)],[0,0],<span class="string">'-'</span>,<span class="string">'Color'</span>,[.5 .5 .5]); hold off
0102   title(strrep(plot_parameters2{it},<span class="string">'_'</span>,<span class="string">' '</span>));
0103 <span class="keyword">end</span>
0104 
0105 
0106 figure(18); clf
0107 
0108 <span class="keyword">for</span> it = 1:length(plot_parameters2),
0109   subplot(ni,nk,it);
0110   ind = <a href="../../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(plot_parameters2(it), parameter_names);
0111   changed = RS_omega_relevant + RS_omega_0_relevant(:,ind) * dd * E.p(ind);
0112   plot(omega_list,real(RS_omega_relevant),<span class="string">'b'</span>); hold on
0113   plot(omega_list,imag(RS_omega_relevant),<span class="string">'r'</span>); 
0114   plot(omega_list,abs(RS_omega_relevant),<span class="string">'k'</span>);
0115   plot(omega_list,real(changed),<span class="string">'b--'</span>); hold on
0116   plot(omega_list,imag(changed),<span class="string">'r--'</span>); 
0117   plot(omega_list,abs(changed),<span class="string">'k--'</span>); 
0118   set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>); axis tight
0119   a = axis; plot([a(1) a(2)],[0,0],<span class="string">'-'</span>,<span class="string">'Color'</span>,[.5 .5 .5]); hold off
0120   title(strrep(plot_parameters2{it},<span class="string">'_'</span>,<span class="string">' '</span>));
0121 <span class="keyword">end</span>
0122 
0123 
0124 <span class="keyword">if</span> exist(<span class="string">'plot_parameters1'</span>),
0125   <span class="keyword">for</span> it = 1:length(plot_parameters1),
0126     ind = find(strcmp(plot_parameters1{it},parameter_names));
0127     figure(1000+it);
0128     changed = RS_omega_relevant + [ RS_omega_0_relevant(:,ind) + RS(ind_out,ind) ] * dd * E.p(ind);
0129     plot(omega_list,real(RS_omega_relevant),<span class="string">'b'</span>); hold on
0130     plot(omega_list,imag(RS_omega_relevant),<span class="string">'r'</span>); 
0131     plot(omega_list,abs(RS_omega_relevant),<span class="string">'k'</span>);
0132     plot(omega_list,real(changed),<span class="string">'b--'</span>); hold on
0133     plot(omega_list,imag(changed),<span class="string">'r--'</span>); 
0134     plot(omega_list,abs(changed),<span class="string">'k--'</span>); 
0135     set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>); axis tight
0136     a = axis; plot([a(1) a(2)],[0,0],<span class="string">'-'</span>,<span class="string">'Color'</span>,[.5 .5 .5]); hold off
0137     legend(<span class="string">'Orig. Real'</span>,<span class="string">'Orig. Imaginary'</span>,<span class="string">'Orig. Absolute'</span>,<span class="string">'Pert. Real'</span>,<span class="string">'Pert. Imaginary'</span>,<span class="string">'Pert. Absolute'</span>);
0138     xlabel(sprintf(<span class="string">'Circular frequency of input %s'</span>,osc_in));
0139     ylabel(sprintf(<span class="string">'Response of output %s'</span>,osc_out));
0140     title(sprintf(<span class="string">'Effect of 5 percent increase of %s on spectral response'</span>, strrep(parameter_names{ind},<span class="string">'_'</span>,<span class="string">' '</span>)));
0141   <span class="keyword">end</span>
0142 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>