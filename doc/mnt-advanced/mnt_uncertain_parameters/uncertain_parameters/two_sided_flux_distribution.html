<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of two_sided_flux_distribution</title>
  <meta name="keywords" content="two_sided_flux_distribution">
  <meta name="description" content="[Jtotvalues, pJtot] = two_sided_flux_distribution(Jsplit,logJsplit)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_uncertain_parameters</a> &gt; <a href="#">uncertain_parameters</a> &gt; two_sided_flux_distribution.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_uncertain_parameters/uncertain_parameters&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>two_sided_flux_distribution
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>[Jtotvalues, pJtot] = two_sided_flux_distribution(Jsplit,logJsplit)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [Jtotvalues,pJtot] = two_sided_flux_distribution(Jsplit, logJsplit) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [Jtotvalues, pJtot] = two_sided_flux_distribution(Jsplit,logJsplit)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Jtotvalues,pJtot] = two_sided_flux_distribution(Jsplit, logJsplit)</a>
0002 
0003 <span class="comment">% [Jtotvalues, pJtot] = two_sided_flux_distribution(Jsplit,logJsplit)</span>
0004 
0005 <span class="keyword">for</span> reaction_number = 1:0.5*length(Jsplit.mean_analytical_2), 
0006 
0007 logJ_mean = logJsplit.mean_analytical_2(2*(reaction_number-1)+[1 2]');
0008 logJ_cov =  logJsplit.cov_analytical_2(2*(reaction_number-1)+[1 2]',2*(reaction_number-1)+[1 2]');
0009 
0010 J_mean = abs(Jsplit.mean_analytical_2(2*(reaction_number-1)+[1 2]'));
0011 J_std  = Jsplit.std_analytical_2(2*(reaction_number-1)+[1 2]');
0012 
0013 mu_plus  = logJ_mean(1);
0014 mu_minus = logJ_mean(2);
0015 
0016 Jmax = max( [J_mean(1)+2*J_std(1)] * [J_mean(2)+1*J_std(2)] );
0017 
0018 Jvalues  = (0.000001:0.005:1.000001) * Jmax;
0019 
0020 dJvalues = Jvalues(2)-Jvalues(1);
0021 
0022 pplus = 1/(sqrt(2*pi*logJ_cov(1,1))) * 1./Jvalues .* exp( -0.5*((log(Jvalues)-mu_plus).^2 / logJ_cov(1,1)));
0023 
0024 pminus = 1/(sqrt(2*pi*logJ_cov(2,2))) * 1./Jvalues .* exp( -0.5*((log(Jvalues)-mu_minus).^2 / logJ_cov(2,2)));
0025 
0026 <span class="keyword">if</span> 0,
0027 figure(1)
0028 subplot(2,1,1); plot(Jvalues,pplus,<span class="string">'r'</span>); 
0029 subplot(2,1,2); plot(Jvalues,pminus,<span class="string">'r'</span>);
0030 
0031 sum(pplus)*dJvalues
0032 sum(pminus)*dJvalues
0033 <span class="keyword">end</span>
0034 
0035 [Jplus,Jminus] = meshgrid(Jvalues,Jvalues);
0036 
0037 C = inv(diag(diag(logJ_cov)));
0038 C = inv(logJ_cov);
0039 
0040 p = 1 / ( 4 * pi * det(logJ_cov)) .* 1./Jplus .* 1./Jminus <span class="keyword">...</span>
0041  .* exp(-0.5*( <span class="keyword">...</span>
0042       C(1,1) * (log( Jplus)-mu_plus).^2 <span class="keyword">...</span><span class="comment"> </span>
0043  + 2* C(1,2) * (log( Jplus)-mu_plus) .* (log( Jminus)-mu_minus) <span class="keyword">...</span>
0044  +    C(2,2) * (log(Jminus)-mu_minus).^2 <span class="keyword">...</span>
0045  ));
0046 
0047 p = p /(sum(sum(p)));
0048 
0049 <span class="comment">%figure(3);</span>
0050 <span class="comment">%im(p);</span>
0051 
0052 <span class="comment">%figure(2)</span>
0053 <span class="comment">%subplot(2,1,1); plot(Jvalues, sum(p)  );</span>
0054 <span class="comment">%subplot(2,1,2); plot(Jvalues,sum(p'));</span>
0055 
0056 <span class="comment">%figure(4)</span>
0057 <span class="comment">%subplot(2,1,1); plot(Jvalues,pplus,'r'); hold on ;</span>
0058 <span class="comment">%subplot(2,1,1); plot(Jvalues, sum(p) / dJvalues ); hold off</span>
0059 <span class="comment">%subplot(2,1,2); plot(Jvalues,pminus,'r'); hold on;</span>
0060 <span class="comment">%subplot(2,1,2); plot(Jvalues,sum(p') / dJvalues); hold off</span>
0061 
0062 n=length(Jvalues);
0063 p_Jtot = zeros(2*n-1,1);
0064 <span class="keyword">for</span> it1=1:n,
0065  <span class="keyword">for</span> it2=1:n,
0066   p_Jtot(-it1+it2+n) = p_Jtot(-it1+it2+n) + p(it1,it2);
0067  <span class="keyword">end</span>
0068 <span class="keyword">end</span>
0069 
0070 Jtotvalues{reaction_number} =  (-n+1:1:n-1)/n*sqrt(0.5)*Jmax;
0071 pJtot{reaction_number} = p_Jtot'/sum(p_Jtot)/(1/n*sqrt(0.5)*Jmax);
0072 
0073 <span class="comment">%figure(5); plot(Jtotvalues,p_Jtot);</span>
0074 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>