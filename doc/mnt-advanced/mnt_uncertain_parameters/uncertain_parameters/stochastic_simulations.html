<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of stochastic_simulations</title>
  <meta name="keywords" content="stochastic_simulations">
  <meta name="description" content="MonteCarlo = stochastic_simulations(nit,n_boot,verbose,network,S,J,par,R_S,R_J,R_S_2,R_J_2,R_S_norm,R_J_norm,R_S_2_norm,R_J_2_norm,distribution, comment,relevant)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt-advanced</a> &gt; <a href="#">mnt_uncertain_parameters</a> &gt; <a href="#">uncertain_parameters</a> &gt; stochastic_simulations.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt-advanced/mnt_uncertain_parameters/uncertain_parameters&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>stochastic_simulations
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>MonteCarlo = stochastic_simulations(nit,n_boot,verbose,network,S,J,par,R_S,R_J,R_S_2,R_J_2,R_S_norm,R_J_norm,R_S_2_norm,R_J_2_norm,distribution, comment,relevant)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function MonteCarlo = stochastic_simulations(nit,n_boot,verbose,network,S,J,par,R_S,R_J,R_S_2,R_J_2,R_S_norm,R_J_norm,R_S_2_norm,R_J_2_norm,distribution, comment,relevant) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> MonteCarlo = stochastic_simulations(nit,n_boot,verbose,network,S,J,par,R_S,R_J,R_S_2,R_J_2,R_S_norm,R_J_norm,R_S_2_norm,R_J_2_norm,distribution, comment,relevant)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>	v = network_velocities(s,network,kinetics,split,indices,t)</li><li><a href="../../.././mnt/mnt_kinetics/kinetics/parameters2vector.html" class="code" title="function [vector,names,relevant,relevant_reactions,types] = parameters2vector(kinetics,S_ext,S_ext_names,network,split,no_names)">parameters2vector</a>	[vector,names,relevant,relevant_reactions,types] = parameters2vector(kinetics,S_ext,S_ext_names,network,split,no_names)</li><li><a href="../../.././mnt/mnt_mca/expand_by_R.html" class="code" title="function delta_y = expand_by_R(RY_1,RY_2,delta_par);">expand_by_R</a>	delta_y = expand_by_R(RY_1, RY_2, delta_par);</li><li><a href="../../.././mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>	[t, s, s_int, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag,Tmax,dilution_rate,ode_opt)</li><li><a href="../../.././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>	[S, J, Sdot, error] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function MonteCarlo = stochastic_simulations(nit,n_boot,verbose,network,S,J,par,R_S,R_J,R_S_2,R_J_2,R_S_norm,R_J_norm,R_S_2_norm,R_J_2_norm,distribution, comment,relevant)</a>
0002 
0003 <span class="comment">% MonteCarlo = stochastic_simulations(nit,n_boot,verbose,network,S,J,par,R_S,R_J,R_S_2,R_J_2,R_S_norm,R_J_norm,R_S_2_norm,R_J_2_norm,distribution, comment,relevant)</span>
0004 
0005 n_rea = length(network.actions);
0006 
0007 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0008 <span class="comment">% analytical MonteCarlo for small deviations</span>
0009 
0010 logk_mean = distribution.logk_mean(relevant);
0011  logk_cov = distribution.logk_cov(relevant,relevant);
0012  
0013 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0014 <span class="comment">% stochastic simulations</span>
0015 
0016 <span class="comment">% independent k+, k-</span>
0017 
0018 <span class="comment">% clear k_fwd_list k_bwd_list Sext_list S_list J_list J_split_list</span>
0019 
0020 split_reactions = network_issplit(network);
0021 <span class="keyword">if</span> verbose, fprintf(<span class="string">'%d MC simulations, %s\n'</span>,nit,comment); <span class="keyword">end</span>
0022 <span class="keyword">for</span> it = 1:nit,
0023   <span class="keyword">if</span> verbose, fprintf(<span class="string">'%d '</span>,it); <span class="keyword">end</span> 
0024   nn = network;
0025   [nn.kinetics,nn.distr_parameters] = simulate_parameters(network, distribution);
0026   Sext_list(:,it) = nn.distr_parameters.Sext;
0027   <span class="keyword">switch</span> network.kinetics.type
0028     <span class="keyword">case</span> <span class="string">'mass-action'</span>,
0029       k_fwd_list(:,it) = nn.kinetics.k_fwd(find(network.kinetics.used_fwd));
0030       k_bwd_list(:,it) = nn.kinetics.k_bwd(find(network.kinetics.used_bwd));
0031       s                = exp(log(S) + <a href="../../.././mnt/mnt_mca/expand_by_R.html" class="code" title="function delta_y = expand_by_R(RY_1,RY_2,delta_par);">expand_by_R</a>(R_S_norm,R_S_2_norm,log([k_fwd_list(:,it); k_bwd_list(:,it)]) - logk_mean));
0032     <span class="keyword">otherwise</span>,
0033       k_fwd_list(:,it) = <a href="../../.././mnt/mnt_kinetics/kinetics/parameters2vector.html" class="code" title="function [vector,names,relevant,relevant_reactions,types] = parameters2vector(kinetics,S_ext,S_ext_names,network,split,no_names)">parameters2vector</a>(nn.kinetics);
0034       k_bwd_list(:,it) = nan;
0035       s                = exp(log(S) + <a href="../../.././mnt/mnt_mca/expand_by_R.html" class="code" title="function delta_y = expand_by_R(RY_1,RY_2,delta_par);">expand_by_R</a>(R_S_norm,R_S_2_norm,log(k_fwd_list(:,it)) - logk_mean));
0036   <span class="keyword">end</span>
0037   
0038   s(find(nn.external))         = nn.distr_parameters.Sext;
0039   [t,s_t, s_int_t,met_int]     = <a href="../../.././mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>(nn, s,100);
0040   [S_list(:,it), J_list(:,it)] = <a href="../../.././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>(nn,s_t(:,end));
0041   J_split_list(:,it)           = <a href="../../.././mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>(S_list(:,it),nn,nn.kinetics,1);
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% check k distribution</span>
0045 <span class="comment">% plot(log(k_fwd_list(:)),log(k_bwd_list(:)),'.');</span>
0046 <span class="comment">% [mean(log(k_fwd_list(:))), mean(log(k_bwd_list(:))) ]</span>
0047 <span class="comment">% cov( [log(k_fwd_list)', log(k_bwd_list)'])</span>
0048 
0049 [log_k_fwd_mean,log_k_fwd_std,log_k_fwd_CV,std_error_of_mean_log_k_fwd,std_error_of_std_log_k_fwd,std_error_of_CV_log_k_fwd] = simple_bootstrap(log(k_fwd_list(:))',n_boot);
0050 
0051 [S_mean,S_std,S_CV,std_error_of_mean_S,std_error_of_std_S,std_error_of_CV_S]             = simple_bootstrap(S_list,n_boot);
0052 [logS_mean,logS_std,std_error_of_mean_logS,std_error_of_std_logS] = simple_bootstrap(log(S_list),n_boot);
0053 
0054 [J_mean,J_std,J_CV,std_error_of_mean_J,std_error_of_std_J,std_error_of_CV_J]             = simple_bootstrap(J_list,n_boot);
0055 [logJ_mean,logJ_std,std_error_of_mean_logJ,std_error_of_std_logJ] = simple_bootstrap(log(abs(J_list)),n_boot);
0056 
0057 [Jsplit_mean,Jsplit_std,Jsplit_CV,std_error_of_mean_Jsplit,std_error_of_std_Jsplit,std_error_of_CV_Jsplit]             = simple_bootstrap(J_split_list,n_boot);
0058 [logJsplit_mean,logJsplit_std,std_error_of_mean_logJsplit,std_error_of_std_logJsplit] = simple_bootstrap(log(abs(J_split_list)),n_boot);
0059 
0060 <span class="keyword">if</span> verbose, fprintf(<span class="string">'\n'</span>); <span class="keyword">end</span>
0061 
0062 
0063 MonteCarlo.k_fwd_list = k_fwd_list;
0064 
0065 <span class="keyword">if</span> ~split_reactions, MonteCarlo.k_bwd_list = k_bwd_list; <span class="keyword">end</span> 
0066 
0067 MonteCarlo.Sext_list = Sext_list;
0068 
0069 
0070 MonteCarlo.S = struct(<span class="string">'list'</span>,S_list,<span class="string">'mean'</span>,S_mean,<span class="string">'std'</span>,S_std,<span class="string">'CV'</span>,S_CV',<span class="string">'cov'</span>,cov(S_list'),<span class="keyword">...</span>
0071             <span class="string">'std_error_of_mean'</span>,std_error_of_mean_S, <span class="string">'std_error_of_std'</span>,std_error_of_std_S, <span class="string">'std_error_of_CV'</span>,std_error_of_CV_S);
0072 
0073 MonteCarlo.logS = struct(<span class="string">'list'</span>,log(S_list),<span class="string">'mean'</span>,logS_mean,<span class="string">'std'</span>,logS_std,<span class="string">'cov'</span>,cov(log(S_list)'),<span class="keyword">...</span>
0074             <span class="string">'std_error_of_mean'</span>,std_error_of_mean_logS, <span class="string">'std_error_of_std'</span>,std_error_of_std_logS);
0075 
0076 MonteCarlo.J = struct(<span class="string">'list'</span>,J_list,<span class="string">'mean'</span>,J_mean,<span class="string">'std'</span>,J_std,<span class="string">'CV'</span>,J_CV',<span class="string">'cov'</span>,cov(J_list'),<span class="keyword">...</span>
0077             <span class="string">'std_error_of_mean'</span>,std_error_of_mean_J, <span class="string">'std_error_of_std'</span>,std_error_of_std_J, <span class="string">'std_error_of_CV'</span>,std_error_of_CV_J);
0078 
0079 MonteCarlo.logJ = struct(<span class="string">'list'</span>,log(abs(J_list)),<span class="string">'mean'</span>,logJ_mean,<span class="string">'std'</span>,logJ_std,<span class="string">'cov'</span>,cov(log(abs(J_list))'),<span class="keyword">...</span>
0080             <span class="string">'std_error_of_mean'</span>,std_error_of_mean_logJ, <span class="string">'std_error_of_std'</span>,std_error_of_std_logJ);
0081 
0082 MonteCarlo.Jsplit = struct(<span class="string">'list'</span>,J_split_list,<span class="string">'mean'</span>,Jsplit_mean,<span class="string">'std'</span>,Jsplit_std,<span class="string">'CV'</span>,Jsplit_CV',<span class="keyword">...</span>
0083                <span class="string">'cov'</span>,cov(J_split_list'),<span class="keyword">...</span>
0084                <span class="string">'std_error_of_mean'</span>,std_error_of_mean_Jsplit,<span class="keyword">...</span>
0085                <span class="string">'std_error_of_std'</span>,std_error_of_std_Jsplit, <span class="string">'std_error_of_CV'</span>,std_error_of_CV_Jsplit);
0086 
0087 MonteCarlo.logJsplit = struct(<span class="string">'list'</span>,log(abs(J_split_list)),<span class="string">'mean'</span>,logJsplit_mean,<span class="string">'std'</span>,logJsplit_std,<span class="keyword">...</span>
0088                   <span class="string">'cov'</span>,cov(log(abs(J_split_list))'),<span class="keyword">...</span>
0089                   <span class="string">'std_error_of_mean'</span>,std_error_of_mean_logJsplit,<span class="keyword">...</span>
0090                   <span class="string">'std_error_of_std'</span>,std_error_of_std_logJsplit);
0091 
0092 <span class="keyword">if</span> network_issplit(network),
0093   MonteCarlo.J_tot = struct(<span class="string">'list'</span>,network.split_matrix'*J_list,<span class="string">'mean'</span>,network.split_matrix'*J_mean,<span class="keyword">...</span>
0094               <span class="string">'std'</span>,network.split_matrix'*J_std);
0095 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>