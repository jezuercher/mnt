<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of mnt_demo</title>
  <meta name="keywords" content="mnt_demo">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="#">demo</a> &gt; mnt_demo.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./demo&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>mnt_demo
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href=".././mnt/mnt_graphics/netgraph_draw.html" class="code" title="function  network = netgraph_draw(network,varargin)">netgraph_draw</a>	netgraph_draw(network,varargin)</li><li><a href=".././mnt/mnt_graphics/netgraph_make_graph.html" class="code" title="function network = netgraph_make_graph(network,metvalues,actvalues,set_positions,x_init,table_positions);">netgraph_make_graph</a>	network = netgraph_make_graph(network,metvalues,actvalues,set_positions,x_init,table_positionss);</li><li><a href=".././mnt/mnt_graphics/netgraph_movie.html" class="code" title="function [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);">netgraph_movie</a>	[M,T] = netgraph_movie(network, t ,s_t, data_type, n_frames, text_flag, options);</li><li><a href=".././mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>	kinetics = set_kinetics(network,type,parameters)</li><li><a href=".././mnt/mnt_mca/analyse_N.html" class="code" title="function [K, L, NR, null_l, pinv_NR, independent_metabolites, N1] = analyse_N(N,external)">analyse_N</a>	[ K, L, NR, null_l, pinv_NR, independent_metabolites, N1] = analyse_N(N,external)</li><li><a href=".././mnt/mnt_mca/control_coefficients.html" class="code" title="function [CJ,CS,L_int,NR_int,M, M_adj, indp_among_internal] = control_coefficients(N,Ec,external,used,NR_int,L_int,indp_among_internal)">control_coefficients</a>	[CJ, CS, L_int, NR_int, M, M_adj, indp_among_internal] = control_coefficients(N, Ec, external, used, NR_int, L_int, indp_among_internal,dilution_rate)</li><li><a href=".././mnt/mnt_mca/elasticities.html" class="code" title="function [Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);">elasticities</a>	[Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);</li><li><a href=".././mnt/mnt_network/network_build_edit/network_construct.html" class="code" title="function n = network_construct(N,reversible,ind_external,metabolites,actions,no_graphics,regulation_matrix)">network_construct</a>	network = network_construct(N,reversible,ind_external,metabolites,actions,no_graphics,regulation_matrix,flag_kinetics)</li><li><a href=".././mnt/mnt_network/network_import_export/network_sbml_export.html" class="code" title="function SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version)">network_sbml_export</a>	SBMLmodel = network_sbml_export(network, verbose, name, filename, notes, sbml_level, sbml_version)</li><li><a href=".././mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>	[t, s, s_int, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag,Tmax,dilution_rate,ode_opt)</li><li><a href=".././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>	[S, J, Sdot, error] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)</li><li><a href=".././mnt/mnt_utils/mnt_dependencies.html" class="code" title="function mnt_dependencies()">mnt_dependencies</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 
0002 data_dir = [fileparts(which(mfilename)) <span class="string">'/data'</span>];
0003 
0004 <a href=".././mnt/mnt_utils/mnt_dependencies.html" class="code" title="function mnt_dependencies()">mnt_dependencies</a>;
0005 
0006 echo on;
0007 clc
0008 <span class="comment">%----------------------------------------------</span>
0009 <span class="comment">% MNT_DEMO - Demo for Metabolic Network Toolbox</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% In this demo, a small metabolic network is</span>
0012 <span class="comment">% built from its stoichiometric matrix,</span>
0013 <span class="comment">% analysed by Metabolic Control Analysis,</span>
0014 <span class="comment">% and a time simulation is run.</span>
0015 <span class="comment">%----------------------------------------------</span>
0016  
0017 <span class="comment">% Please press any key to continue</span>
0018  
0019 pause
0020 clc
0021 <span class="comment">%----------------------------------------------</span>
0022 <span class="comment">% We consider the following simple network</span>
0023  
0024 <span class="comment">% S1             S5</span>
0025 <span class="comment">%    \         /</span>
0026 <span class="comment">%      S3 - S4</span>
0027 <span class="comment">%    /         \</span>
0028 <span class="comment">% S2             S6</span>
0029  
0030 <span class="comment">% to illustrate some functions of the Metabolic Network Toolbox.</span>
0031  
0032 <span class="comment">% Please press any key to continue</span>
0033  
0034 pause
0035 clc
0036 <span class="comment">%----------------------------------------------</span>
0037 <span class="comment">% We first need to define the network.</span>
0038 <span class="comment">% This is done by the stoichiometric matrix N,</span>
0039 <span class="comment">% the reversibility of reactions (as a bit column),</span>
0040 <span class="comment">% and the indices of external metabolites</span>
0041  
0042 N = [ -1  0  0  0  0; <span class="keyword">...</span>
0043        0 -1  0  0  0; <span class="keyword">...</span>
0044        1  1 -1  0  0; <span class="keyword">...</span>
0045        0  0  1 -1 -1; <span class="keyword">...</span>
0046        0  0  0  1  0; <span class="keyword">...</span>
0047        0  0  0  0  1];
0048  
0049 reversible   = [1 1 1 1 1]';
0050  
0051 ind_external = [1 2 5 6 ]';
0052  
0053 network = <a href=".././mnt/mnt_network/network_build_edit/network_construct.html" class="code" title="function n = network_construct(N,reversible,ind_external,metabolites,actions,no_graphics,regulation_matrix)">network_construct</a>(N, reversible, ind_external);
0054 
0055 <span class="comment">% Press any key to continue</span>
0056  
0057 pause
0058 clc
0059 <span class="comment">%----------------------------------------------</span>
0060 <span class="comment">% All information about the network is now stored in the structure</span>
0061  
0062 network
0063 
0064 <span class="comment">% The fields 'kinetics' and 'graphics_par' contain information</span>
0065 <span class="comment">% about reaction kinetics and the graphical layout (set here by default).</span>
0066  
0067 <span class="comment">% The following command draws the network</span>
0068  
0069 figure(1);
0070 <a href=".././mnt/mnt_graphics/netgraph_draw.html" class="code" title="function  network = netgraph_draw(network,varargin)">netgraph_draw</a>(network);
0071  
0072 <span class="comment">% The arrows indicate the nominal reaction directions.</span>
0073  
0074 <span class="comment">% Press any key to continue</span>
0075  
0076 pause
0077 clc
0078 <span class="comment">%----------------------------------------------</span>
0079 <span class="comment">% Now we will analyse the network structure.</span>
0080 <span class="comment">% Information about stationary fluxes and conservation relations</span>
0081 <span class="comment">% can be obtained from the kernel matrix K and the link matrix L.</span>
0082 <span class="comment">% Both follow from the stoichimetric matrix of internal metabolites.</span>
0083 
0084 [K, L] = <a href=".././mnt/mnt_mca/analyse_N.html" class="code" title="function [K, L, NR, null_l, pinv_NR, independent_metabolites, N1] = analyse_N(N,external)">analyse_N</a>(N(find(network.external==0),:))
0085  
0086 <span class="comment">% Press any key to continue</span>
0087  
0088 pause
0089 clc
0090 <span class="comment">%----------------------------------------------</span>
0091 <span class="comment">% Until here, we only considered the network structure.</span>
0092 <span class="comment">% Kinetic rate laws can be stored in the field 'network.kinetics'.</span>
0093 <span class="comment">% There are different ways to specify them (see 'kinetics_structure').</span>
0094 <span class="comment">% This is how we choose common modular rate laws for all reactions.</span>
0095  
0096 network.kinetics = <a href=".././mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>(network,<span class="string">'cs'</span>);
0097  
0098 <span class="comment">% Press any key to continue</span>
0099  
0100 pause
0101 clc
0102 <span class="comment">%----------------------------------------------</span>
0103 <span class="comment">% Now we can run dynamical simulations.</span>
0104 <span class="comment">% First, we guess an intial set of concentrations ..</span>
0105  
0106 s = [1 1 0 0 0 0]';
0107  
0108 <span class="comment">% .. compute stationary concentrations and fluxes ..</span>
0109  
0110 [S, J] = <a href=".././mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>(network,s);
0111  
0112 <span class="comment">% .. and plot them on the network graph.</span>
0113  
0114 network = <a href=".././mnt/mnt_graphics/netgraph_make_graph.html" class="code" title="function network = netgraph_make_graph(network,metvalues,actvalues,set_positions,x_init,table_positions);">netgraph_make_graph</a>(network);
0115  
0116 figure(2);
0117 <a href=".././mnt/mnt_graphics/netgraph_draw.html" class="code" title="function  network = netgraph_draw(network,varargin)">netgraph_draw</a>(network,{<span class="string">'metvalues'</span>,S,<span class="string">'arrowvalues'</span>,J,<span class="string">'arrowstyle'</span>,<span class="string">'fluxes'</span>});
0118  
0119 <span class="comment">% The circles and squares represent metabolites and reactions.</span>
0120  
0121 <span class="comment">% Press any key to continue</span>
0122  
0123 pause
0124 clc
0125 <span class="comment">%---------------------------------------------------------------------</span>
0126 <span class="comment">% Likewise, we can compute elasticity and control coefficients</span>
0127 <span class="comment">% (for information on metabolic control analysis, type 'help mnt_mca')</span>
0128  
0129 epsilon     = <a href=".././mnt/mnt_mca/elasticities.html" class="code" title="function [Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);">elasticities</a>(network,S);
0130  
0131 [C_J, C_S]  = <a href=".././mnt/mnt_mca/control_coefficients.html" class="code" title="function [CJ,CS,L_int,NR_int,M, M_adj, indp_among_internal] = control_coefficients(N,Ec,external,used,NR_int,L_int,indp_among_internal)">control_coefficients</a>(network.N,epsilon,network.external);
0132 
0133 <span class="comment">% Here we plot the control coefficients on the 4th metabolite on the network</span>
0134  
0135 figure(3);
0136 <a href=".././mnt/mnt_graphics/netgraph_draw.html" class="code" title="function  network = netgraph_draw(network,varargin)">netgraph_draw</a>(network,<span class="string">'actvalues'</span>,C_S(4,:)');
0137  
0138 <span class="comment">% Press any key to continue</span>
0139  
0140 pause
0141 clc
0142 <span class="comment">%---------------------------------------------------------------------</span>
0143 <span class="comment">% Metabolic control theory has proven theorems that relate the</span>
0144 <span class="comment">% control coefficients to the network structure (described by</span>
0145 <span class="comment">% K and L) and the reaction elasticities.</span>
0146  
0147 <span class="comment">% Summation theorems</span>
0148  
0149 <span class="comment">%  CJ * K  = K</span>
0150 <span class="comment">%  CS * K  = 0</span>
0151  
0152 <span class="comment">% Connectivity theorems</span>
0153  
0154 <span class="comment">%  CJ * epsilon * L = 0</span>
0155 <span class="comment">%  CS * epsilon * L = - L</span>
0156  
0157 <span class="comment">% We will now check if our control coefficients satisfy them</span>
0158  
0159 <span class="comment">% In the theorems, we consider only the elasticities and concentration</span>
0160 <span class="comment">% control matrices with respect to internal metabolites</span>
0161  
0162 ind_internal = find(network.external==0);
0163  
0164 epsilon_int  = epsilon(:,ind_internal);
0165  
0166 C_S_int      = C_S(ind_internal,:);
0167 
0168 <span class="comment">% Press any key to continue</span>
0169  
0170 pause
0171 clc
0172 <span class="comment">%---------------------------------------------------------------------</span>
0173 <span class="comment">% Since CJ K = K, the following should vanish:</span>
0174 
0175 C_J * K - K
0176  
0177 <span class="comment">% Press any key to continue</span>
0178  
0179 pause
0180 clc
0181 <span class="comment">%---------------------------------------------------------------------</span>
0182 <span class="comment">% Since CS K = 0, the following should vanish:</span>
0183  
0184 C_S_int * K
0185  
0186 <span class="comment">% Press any key to continue</span>
0187  
0188 pause
0189 clc
0190 <span class="comment">%---------------------------------------------------------------------</span>
0191 <span class="comment">% Since CJ epsilon L = 0, the following should vanish:</span>
0192  
0193 C_J * epsilon_int * L
0194  
0195 <span class="comment">% Press any key to continue</span>
0196  
0197 pause
0198 clc
0199 <span class="comment">%---------------------------------------------------------------------</span>
0200 <span class="comment">% Since CS epsilon L = - L, the following should vanish:</span>
0201 
0202 C_S_int * epsilon_int * L + L
0203  
0204 <span class="comment">% Press any key to continue</span>
0205  
0206 pause
0207 clc
0208 <span class="comment">%---------------------------------------------------------------------</span>
0209 <span class="comment">% Now we compute a time course, with initial conditions given by s:</span>
0210 
0211 [t,s_t,s_int] = <a href=".././mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>(network,s,5);
0212 
0213 figure(4); plot(t,s_t)
0214 
0215 <span class="comment">% Press any key to continue</span>
0216 pause
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <span class="comment">% We can also show the time course as a movie</span>
0220  
0221 M = <a href=".././mnt/mnt_graphics/netgraph_movie.html" class="code" title="function [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);">netgraph_movie</a>(network,t,s_t);
0222  
0223 figure(4); 
0224 movie(M,1);
0225 
0226 <span class="comment">% Press any key to continue</span>
0227 pause
0228 
0229 <span class="comment">% --------------------------------------------------------------------</span>
0230 <span class="comment">% Finally, we can export the model to SBML format</span>
0231  
0232 SBMLmodel = <a href=".././mnt/mnt_network/network_import_export/network_sbml_export.html" class="code" title="function SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version)">network_sbml_export</a>(network,1);
0233  
0234 <span class="comment">% Press any key to finish</span>
0235 pause
0236  
0237 <span class="comment">% Enjoy this toolbox!</span>
0238 echo off;</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>