<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of demo_small_network</title>
  <meta name="keywords" content="demo_small_network">
  <meta name="description" content="DEMO_SMALL_NETWORK - Demo for Metabolic Network Toolbox">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">demo</a> &gt; demo_small_network.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for demo&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>demo_small_network
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>DEMO_SMALL_NETWORK - Demo for Metabolic Network Toolbox</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">DEMO_SMALL_NETWORK - Demo for Metabolic Network Toolbox</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../mnt/mnt_graphics/netgraph_draw.html" class="code" title="function  network = netgraph_draw(network,varargin)">netgraph_draw</a>	netgraph_draw(network,varargin)</li><li><a href="../mnt/mnt_graphics/netgraph_external.html" class="code" title="function [network,p] = netgraph_external(network,draw_only,external)">netgraph_external</a>	[network,p] = netgraph_external(network,draw_only,external)</li><li><a href="../mnt/mnt_graphics/netgraph_move.html" class="code" title="function network = netgraph_move(network,flag_draw_details,options,picture,filename_in,filename_out)">netgraph_move</a>	network = netgraph_move(network,flag_draw_details,options,picture,filename_in,filename_out)</li><li><a href="../mnt/mnt_graphics/netgraph_movie.html" class="code" title="function [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);">netgraph_movie</a>	[M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);</li><li><a href="../mnt/mnt_graphics/netgraph_reversible.html" class="code" title="function [network,p] = netgraph_reversible(network)">netgraph_reversible</a>	[network,p] = netgraph_reversible(network)</li><li><a href="../mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>	kinetics = set_kinetics(network,type,parameters)</li><li><a href="../mnt/mnt_mca/analyse_N.html" class="code" title="function [K, L, NR, null_l, pinv_NR, independent_metabolites, N1] = analyse_N(N,external)">analyse_N</a>	[ K, L, NR, null_l, pinv_NR, independent_metabolites, N1] = analyse_N(N,external)</li><li><a href="../mnt/mnt_mca/control_coefficients.html" class="code" title="function [CJ,CS,L_int,NR_int,M, indp_among_internal] = control_coefficients(N,Ec,external,used,NR_int,L_int,indp_among_internal)">control_coefficients</a>	[CJ, CS, L_int, NR_int, M, indp_among_internal] = control_coefficients(N, Ec, external, used, NR_int, L_int, indp_among_internal,dilution_rate)</li><li><a href="../mnt/mnt_mca/elasticities.html" class="code" title="function [Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);">elasticities</a>	[Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);</li><li><a href="../mnt/mnt_mca/time_response_coefficients.html" class="code" title="function [t, s,RS,s_ind,RS_ind,parameters,parameter_names]= time_response_coefficients(network, s_init, t_final)">time_response_coefficients</a>	[t, s, RS, s_ind, RS_ind, parameters, par_names]= time_response_coefficients(network, s0, t_final)</li><li><a href="../mnt/mnt_network/network_build_edit/network_construct.html" class="code" title="function n = network_construct(N,reversible,ind_external,metabolites,actions,no_graphics,regulation_matrix)">network_construct</a>	network = network_construct(N,reversible,ind_external,metabolites,actions,no_graphics,regulation_matrix)</li><li><a href="../mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>	[t, s, s_int, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag,Tmax,dilution_rate,ode_opt)</li><li><a href="../mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>	[S, J, Sdot, error] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%DEMO_SMALL_NETWORK - Demo for Metabolic Network Toolbox</span>
0002 
0003 echo on;
0004 clc
0005 <span class="comment">% We consider the following simple network</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% S1             S5</span>
0008 <span class="comment">%    \         /</span>
0009 <span class="comment">%      S3 - S4</span>
0010 <span class="comment">%    /         \</span>
0011 <span class="comment">% S2             S6</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% (where Sn denotes metabolites) to illustrate some</span>
0014 <span class="comment">% of the functions of the Metabolic Network Toolbox.</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% Please hit any key to continue</span>
0017 
0018 pause
0019 clc
0020 <span class="comment">% We define the network by its stoichiometric matrix N,</span>
0021 <span class="comment">% the reversibility of reactions (bit string)</span>
0022 <span class="comment">% and the external metabolites (indices)</span>
0023 <span class="comment">%</span>
0024 
0025 N            = [ -1 0 0 0 0; <span class="keyword">...</span>
0026          0 -1 0 0 0; <span class="keyword">...</span>
0027          1 1 -1 0 0; <span class="keyword">...</span>
0028          0 0 1 -1 -1; <span class="keyword">...</span>
0029          0 0 0 1 0; <span class="keyword">...</span>
0030          0 0 0 0 1];
0031 
0032 reversible   = [1 1 1 1 1]';
0033 
0034 external_ind = [1 2 5 6 ]';
0035 
0036 <span class="comment">%</span>
0037 <span class="comment">% Hit any key to continue</span>
0038 pause
0039 
0040 <span class="comment">% All information about the network is then stored in a matlab structure</span>
0041 
0042 network      = <a href="../mnt/mnt_network/network_build_edit/network_construct.html" class="code" title="function n = network_construct(N,reversible,ind_external,metabolites,actions,no_graphics,regulation_matrix)">network_construct</a>(N,reversible,external_ind)
0043 <span class="comment">% The fields 'kinetics' and 'graphics_par' contain information</span>
0044 <span class="comment">% about reaction kinetics and the graphical layout (set here by default).</span>
0045 
0046 <span class="comment">% Hit any key to continue</span>
0047 pause
0048 clc
0049 <span class="comment">% The functions in the 'netgraph' directory change the layout</span>
0050 <span class="comment">% of the network (defined by the field 'graphics_par').</span>
0051 <span class="comment">% The command &quot;netgraph_move&quot; allows you to move the nodes</span>
0052 <span class="comment">% with your mouse (press right mouse key to quit)</span>
0053 
0054 network = <a href="../mnt/mnt_graphics/netgraph_move.html" class="code" title="function network = netgraph_move(network,flag_draw_details,options,picture,filename_in,filename_out)">netgraph_move</a>(network);
0055 
0056 <span class="comment">% We can set/remove the reversible reactions ...</span>
0057 <span class="comment">%</span>
0058 network = <a href="../mnt/mnt_graphics/netgraph_reversible.html" class="code" title="function [network,p] = netgraph_reversible(network)">netgraph_reversible</a>(network);
0059 
0060 <span class="comment">% ... and the external metabolites</span>
0061 <span class="comment">%</span>
0062 network = <a href="../mnt/mnt_graphics/netgraph_external.html" class="code" title="function [network,p] = netgraph_external(network,draw_only,external)">netgraph_external</a>(network);
0063 clc
0064 clf
0065 <span class="comment">% Now we analyse the network structure</span>
0066 <span class="comment">% Information about stationary fluxes and conservation</span>
0067 <span class="comment">% relations can be obtained from the kerbel matrix K</span>
0068 <span class="comment">% and the link matrix L (for the stoichimetric matrix</span>
0069 <span class="comment">% of internal metabolites)</span>
0070 [ K, L ] = <a href="../mnt/mnt_mca/analyse_N.html" class="code" title="function [K, L, NR, null_l, pinv_NR, independent_metabolites, N1] = analyse_N(N,external)">analyse_N</a>(N(find(network.external==0),:))
0071 <span class="comment">% Hit any key to continue</span>
0072 pause
0073 clc
0074 <span class="comment">% Until here, we only considered the network structure.</span>
0075 <span class="comment">% Now we define a kinetics.</span>
0076 <span class="comment">% There are different ways to specify a kinetics (see 'kinetics_structure').</span>
0077 <span class="comment">% Here we choose a common modular rate law kinetics for all reactions.</span>
0078 <span class="comment">%</span>
0079 network.kinetics = <a href="../mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>(network,<span class="string">'cs'</span>);
0080 <span class="comment">% This updates the field 'kinetics', which contains all kinetic data.</span>
0081 <span class="comment">%</span>
0082 <span class="comment">% Hit any key to continue</span>
0083 pause
0084 clc
0085 <span class="comment">% Now we can run dynamical simulations.</span>
0086 <span class="comment">% First, we compute a stationary state, starting from an initial guess</span>
0087 <span class="comment">% of the concentrations ...</span>
0088 
0089 s = [1 1 0 0 0 0]';
0090 
0091 [S, J] = <a href="../mnt/mnt_simulation/network_steady_state.html" class="code" title="function  [S, J, Sdot, error,L_int,NR_int,indep_met_int] = network_steady_state(network,s,integrate_time,L_int,NR_int,indep_met_int,dilution_rate)">network_steady_state</a>(network,s);
0092 
0093 <span class="comment">% ... and plot it on the network graph.</span>
0094 <span class="comment">%</span>
0095 
0096 <a href="../mnt/mnt_graphics/netgraph_draw.html" class="code" title="function  network = netgraph_draw(network,varargin)">netgraph_draw</a>(network,<span class="string">'metvalues'</span>,S,<span class="string">'arrowvalues'</span>,J,<span class="string">'arrowstyle'</span>,<span class="string">'fluxes'</span>);
0097 
0098 <span class="comment">% The size (and color) of octagons</span>
0099 <span class="comment">% and squares represents the values of concentrations and fluxes.</span>
0100 <span class="comment">%</span>
0101 <span class="comment">% Hit any key to continue</span>
0102 pause
0103 clc
0104 <span class="comment">% Likewise, we can compute properties from metabolic control analysis,</span>
0105 <span class="comment">% for instance, elasticity coefficients and control coefficients</span>
0106 <span class="comment">% (for more information: type 'help control_theory')</span>
0107 <span class="comment">%</span>
0108 
0109 epsilon       = <a href="../mnt/mnt_mca/elasticities.html" class="code" title="function [Ec,Ep,parameters,Ecc,Ecp,Epp,p] = elasticities(network,s,options);">elasticities</a>(network,S);
0110 [ C_J, C_S ]  = <a href="../mnt/mnt_mca/control_coefficients.html" class="code" title="function [CJ,CS,L_int,NR_int,M, indp_among_internal] = control_coefficients(N,Ec,external,used,NR_int,L_int,indp_among_internal)">control_coefficients</a>(network.N,epsilon,network.external);
0111 
0112 <span class="comment">% Here we plot the control coefficients on the 4th metabolite</span>
0113 
0114 <a href="../mnt/mnt_graphics/netgraph_draw.html" class="code" title="function  network = netgraph_draw(network,varargin)">netgraph_draw</a>(network,<span class="string">'actvalues'</span>,C_S(4,:)');
0115 
0116 <span class="comment">% Hit any key to continue</span>
0117 pause
0118 clc
0119 <span class="comment">% Metabolic control theory has proven theorems that relate the</span>
0120 <span class="comment">% control coefficients to the network structure (described by</span>
0121 <span class="comment">% K and L) and the reaction elasticities.</span>
0122 <span class="comment">%</span>
0123 <span class="comment">% The theorems for non-normalised control coefficients read</span>
0124 <span class="comment">%</span>
0125 <span class="comment">%Summation theorems</span>
0126 <span class="comment">% CJ K         = K</span>
0127 <span class="comment">% CS K         = 0</span>
0128 <span class="comment">%</span>
0129 <span class="comment">%Connectivity theorems</span>
0130 <span class="comment">% CJ epsilon L = 0</span>
0131 <span class="comment">% CS epsilon L = - L</span>
0132 <span class="comment">%</span>
0133 <span class="comment">%Let us check them:</span>
0134 <span class="comment">%</span>
0135 <span class="comment">% CJ K = K</span>
0136 
0137 C_J*K
0138 K
0139 pause
0140 <span class="comment">% CS K = 0</span>
0141 C_S(find(network.external==0),:)*K
0142 pause
0143 <span class="comment">% CJ epsilon L = 0</span>
0144 C_J(find(network.external==0),:)*epsilon(:,find(network.external==0))*L
0145 pause
0146 <span class="comment">% CS epsilon L = - L</span>
0147 C_S(find(network.external==0),:)*epsilon(:,find(network.external==0))*L
0148 L
0149 pause
0150 clc
0151 <span class="comment">% We compute a time course with initial conditions given by s:</span>
0152 
0153 [t,s_t,s_int] = <a href="../mnt/mnt_simulation/network_integrate.html" class="code" title="function [t, s_t, s_int_t, met_int,v,x_assign] = network_integrate(network, s_init, T, graphics_flag, verbose_flag, Tmax,dilution_rate,ode_opt)">network_integrate</a>(network,s,5);
0154 close
0155 plot(t,s_t)
0156 
0157 <span class="comment">% Hit any key to continue</span>
0158 pause
0159 
0160 <span class="comment">% We can also show the time course as a movie</span>
0161 M = <a href="../mnt/mnt_graphics/netgraph_movie.html" class="code" title="function [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);">netgraph_movie</a>(network,t,s_t);
0162 movie(M,1);
0163 <span class="comment">% Hit any key to continue</span>
0164 pause
0165 close
0166 <span class="comment">% Accordingly, we can compute time-dependent response coefficients</span>
0167 
0168 [t, s_t, RS, s_ind_t, RS_ind, parameters, parameter_names] = <a href="../mnt/mnt_mca/time_response_coefficients.html" class="code" title="function [t, s,RS,s_ind,RS_ind,parameters,parameter_names]= time_response_coefficients(network, s_init, t_final)">time_response_coefficients</a>(network, s, 5);
0169 
0170 plot(t,squeeze(RS(:,1,:)))
0171 <span class="comment">%</span>
0172 <span class="comment">% Enjoy this toolbox!</span>
0173 echo off;</pre></div>
<hr><address>Generated on Fri 05-Apr-2013 16:43:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>