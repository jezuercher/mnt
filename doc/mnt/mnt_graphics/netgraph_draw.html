<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of netgraph_draw</title>
  <meta name="keywords" content="netgraph_draw">
  <meta name="description" content="netgraph_draw(network,varargin)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">mnt</a> &gt; <a href="#">mnt_graphics</a> &gt; netgraph_draw.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt/mnt_graphics&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>netgraph_draw
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>netgraph_draw(network,varargin)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function  network = netgraph_draw(network,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">netgraph_draw(network,varargin)

Draw a metabolic network according to settings in the field 'graphics_par'
These settings can be overridden by the contents of 'varargin'

varargin is either a list of pairs 'fieldname','fieldvalue',...
 or a structure (as 'graphics_par') struct('parname1', parvalue1, 'parname2', parvalue2, ...)

PARAMETER SETTINGS:

METABOLITE SYMBOLS
 metvalues
 metvalues_std
 metstyle       {'fixed','box','box_std','none'}
 metcolstyle    {'fixed','values'}
 metvaluesmax
 metvaluesmin
 metprintnames
 metprintvalues
 metcolors       (optional, overrides all other color specifications)
 omitmetabolites
 squaresize ( also holds for reaction symbols)
 no_points ( also holds for reaction symbols)
 flag_edges (holds also for reaction and regulation symbols)

REACTION SYMBOLS
 actvalues
 actvalues_std
 actstyle       {'fixed','box','box_std','none'}
 actcolstyle    {'fixed','values'}
 actcolors      (optional, overrides all other color specifications)
 actvaluesmax
 actvaluesmin
 actprintnames
 actprintvalues
 omitreactions     reactions to be omitted in graphics

STYLE OF ARROWS
 arrowstyle     {'fluxes','directions','none'}
 arrowvalues
 arrowvaluesmax
 arrowvaluesmin
 arrow_stoichiometries [0,1] scale arrows with stoichiometric coefficients?
 arrowsize
 arrow_shift     [0..1]
 arrowprintvalues (overrides actprintvalues);
 straightlines
 arrowcolor
 single_arrow [0,1] Draw only one arrow per reaction, on top of the reaction symbol

STYLE OF EDGE SYMBOLS

 edgevalues     (sparse matrix, size of stoichiometric matrix N)
 edgevalues_std (sparse matrix, size of stoichiometric matrix N)
 edgestyle {'normal',fixed'}
 edgevaluesmax
 edgevaluesmin

REGULATION ARROWS
 show_regulation (flag)
 show_regulationvalues (flag)
 regulationvalues (sparse matrix of size of regulation_matrix)
 regulationstyle {'normal',fixed'}
 rlinecolor

TEXT ITEMS
 chop_names     (length)
 split_names (length)
 FontSize 
 Rotation  (for all text items)
 text_offset

COLORSCALE AND LINES
 colorbar (0/1)
 colorbar_numbers
 linecolor 
 linewidth
 colormap        (default rb_colors)
 black_and_white (default 0)
 showsign

 figure_axis
 figure_position
 subplot_position
 YDir ('normal','reverse')
 hold_on (flag)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="netgraph_make_graph.html" class="code" title="function network = netgraph_make_graph(network,metvalues,actvalues,set_positions,x_init,table_positions);">netgraph_make_graph</a>	network = netgraph_make_graph(network,metvalues,actvalues,set_positions,x_init,table_positionss);</li><li><a href="../.././mnt/utils/arc.html" class="code" title="function [x,arcx,arcy] = arc(x1,x2,height,arrow_shift);">arc</a>	-------------------------</li><li><a href="../.././mnt/utils/get_color.html" class="code" title="function c = get_color(values, minvalue,maxvalue,cmap);">get_color</a>	c = get_color(values, minvalue,maxvalue,cmap);</li><li><a href="../.././mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>	c = join_struct(a,b)</li><li><a href="../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>	function [label,indices] = label_names(names,allnames, method)</li><li><a href="../.././mnt/utils/noticks.html" class="code" title="function noticks();">noticks</a>	noticks();</li><li><a href="../.././mnt/utils/plot_square.html" class="code" title="function plot_square(x,y,l,col)">plot_square</a>	plot_square(x,y,l,col)</li><li><a href="../.././mnt/utils/rb_colors.html" class="code" title="function c = rb_colors(ncol)">rb_colors</a>	c = rb_colors(ncol)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../.././demo/mnt_demo.html" class="code" title="">mnt_demo</a>	</li><li><a href="../.././mnt-advanced/mnt_spectral_response/spectral_response/wheelplot.html" class="code" title="function wheelplot(network,RS,RJ,internal,scale_RS,scale_RJ)">wheelplot</a>	</li><li><a href="../.././mnt-advanced/mnt_uncertain_parameters/display_expression.html" class="code" title="function [Delta_logS_mean,Delta_logJ_mean,Delta_logS_cov,Delta_logJ_cov]=  display_expression(network,solution1,solution2,d1,d2)">display_expression</a>	[Delta_logS_mean,Delta_logJ_mean,Delta_logS_cov,Delta_logJ_cov] = display_expression(network,solution1,solution2,d1,d2)</li><li><a href="../.././mnt-advanced/mnt_uncertain_parameters/flux_direction_probs.html" class="code" title="function [prob,mean_prob,var_prob] = flux_direction_probs(network, solution, fn);">flux_direction_probs</a>	[prob, mean_prob, var_prob] = flux_direction_probs(network, solution, fn);</li><li><a href="../.././mnt-advanced/mnt_uncertain_parameters/uncertain_parameters/display_stochastic_control.html" class="code" title="function display_stochastic_control(network,solution,control_type,direction_type,ind,filename)">display_stochastic_control</a>	display_stochastic_control(network,solution,control_type,direction_type,ind,filename)</li><li><a href="../.././mnt-advanced/mnt_uncertain_parameters/uncertain_parameters/display_variability.html" class="code" title="function display_variability(network,solution, fn)">display_variability</a>	</li><li><a href="netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>	netgraph_concentrations(network,S,J,flag_text,options)</li><li><a href="netgraph_fluxes.html" class="code" title="function netgraph_fluxes(network,J,gp)">netgraph_fluxes</a>	netgraph_fluxes(network,J,gp)</li><li><a href="netgraph_mark_metabolites.html" class="code" title="function [choice,p] = netgraph_mark_metabolites(network,choice,draw_only)">netgraph_mark_metabolites</a>	[choice,p] = netgraph_mark_metabolites(network,choice,draw_only)</li><li><a href="netgraph_mark_reactions.html" class="code" title="function [choice,p] = netgraph_mark_reactions(network,choice,draw_only)">netgraph_mark_reactions</a>	[choice,p] = netgraph_mark_reactions(network,choice,draw_only)</li><li><a href="netgraph_move.html" class="code" title="function network = netgraph_move(network,flag_draw_details,options,picture,filename_in,filename_out)">netgraph_move</a>	network = netgraph_move(network,flag_draw_details,options,picture,filename_in,filename_out)</li><li><a href="netgraph_move2.html" class="code" title="function x = netgraph_move2(network,flag_draw_details)">netgraph_move2</a>	network = netgraph_move2(network,flag_draw_details)</li><li><a href="netgraph_regulation.html" class="code" title="function   netgraph_regulation(network)">netgraph_regulation</a>	netgraph_regulation(network)</li><li><a href="netgraph_remove.html" class="code" title="function [network,keep_tot,keep_actions_tot] = netgraph_remove(network)">netgraph_remove</a>	[network,keep_tot,keep_actions_tot] = netgraph_remove(network)</li><li><a href="../.././mnt/mnt_network/network_import_export/network_sbml_import.html" class="code" title="function [network,s] = network_sbml_import(s,dirname,verbose)">network_sbml_import</a>	[network,s] = network_sbml_import(s,dirname,verbose)</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function plot_square(x,y,l,std,squaresize,col,flag_edges)</a></li><li><a href="#_sub2" class="code">function plot_circle(x,y,l,std,squaresize,col,flag_edges)</a></li><li><a href="#_sub3" class="code">function plot_diamond(x,y,l,std,squaresize,col,flag_edges)</a></li><li><a href="#_sub4" class="code">function plot_octagon(x,y,l,std,squaresize,col,flag_edges)</a></li><li><a href="#_sub5" class="code">function plot_triangle(x, y, phi, l, col, forward,flag_edges)</a></li><li><a href="#_sub6" class="code">function [x3,arcx,arcy] = arc(x1,x2,height,arrow_shift);</a></li><li><a href="#_sub7" class="code">function  [arcx,arcy] = tri_arc(x1,x2,x3,linecolor,arrow_shift)</a></li><li><a href="#_sub8" class="code">function name2 = split_name(name,l)</a></li><li><a href="#_sub9" class="code">function [normvalues, normvalues_std,valuesmax,valuesmin] = normalise(values,values_std,valuesmax,valuesmin,p);</a></li><li><a href="#_sub10" class="code">function this_colorbar(num,colmap)</a></li><li><a href="#_sub11" class="code">function p = netgraph_draw_set_parameters(network,vararg)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%netgraph_draw(network,varargin)</span>
0002 <span class="comment">%</span>
0003 <span class="comment">%Draw a metabolic network according to settings in the field 'graphics_par'</span>
0004 <span class="comment">%These settings can be overridden by the contents of 'varargin'</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%varargin is either a list of pairs 'fieldname','fieldvalue',...</span>
0007 <span class="comment">% or a structure (as 'graphics_par') struct('parname1', parvalue1, 'parname2', parvalue2, ...)</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%PARAMETER SETTINGS:</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%METABOLITE SYMBOLS</span>
0012 <span class="comment">% metvalues</span>
0013 <span class="comment">% metvalues_std</span>
0014 <span class="comment">% metstyle       {'fixed','box','box_std','none'}</span>
0015 <span class="comment">% metcolstyle    {'fixed','values'}</span>
0016 <span class="comment">% metvaluesmax</span>
0017 <span class="comment">% metvaluesmin</span>
0018 <span class="comment">% metprintnames</span>
0019 <span class="comment">% metprintvalues</span>
0020 <span class="comment">% metcolors       (optional, overrides all other color specifications)</span>
0021 <span class="comment">% omitmetabolites</span>
0022 <span class="comment">% squaresize ( also holds for reaction symbols)</span>
0023 <span class="comment">% no_points ( also holds for reaction symbols)</span>
0024 <span class="comment">% flag_edges (holds also for reaction and regulation symbols)</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%REACTION SYMBOLS</span>
0027 <span class="comment">% actvalues</span>
0028 <span class="comment">% actvalues_std</span>
0029 <span class="comment">% actstyle       {'fixed','box','box_std','none'}</span>
0030 <span class="comment">% actcolstyle    {'fixed','values'}</span>
0031 <span class="comment">% actcolors      (optional, overrides all other color specifications)</span>
0032 <span class="comment">% actvaluesmax</span>
0033 <span class="comment">% actvaluesmin</span>
0034 <span class="comment">% actprintnames</span>
0035 <span class="comment">% actprintvalues</span>
0036 <span class="comment">% omitreactions     reactions to be omitted in graphics</span>
0037 <span class="comment">%</span>
0038 <span class="comment">%STYLE OF ARROWS</span>
0039 <span class="comment">% arrowstyle     {'fluxes','directions','none'}</span>
0040 <span class="comment">% arrowvalues</span>
0041 <span class="comment">% arrowvaluesmax</span>
0042 <span class="comment">% arrowvaluesmin</span>
0043 <span class="comment">% arrow_stoichiometries [0,1] scale arrows with stoichiometric coefficients?</span>
0044 <span class="comment">% arrowsize</span>
0045 <span class="comment">% arrow_shift     [0..1]</span>
0046 <span class="comment">% arrowprintvalues (overrides actprintvalues);</span>
0047 <span class="comment">% straightlines</span>
0048 <span class="comment">% arrowcolor</span>
0049 <span class="comment">% single_arrow [0,1] Draw only one arrow per reaction, on top of the reaction symbol</span>
0050 <span class="comment">%</span>
0051 <span class="comment">%STYLE OF EDGE SYMBOLS</span>
0052 <span class="comment">%</span>
0053 <span class="comment">% edgevalues     (sparse matrix, size of stoichiometric matrix N)</span>
0054 <span class="comment">% edgevalues_std (sparse matrix, size of stoichiometric matrix N)</span>
0055 <span class="comment">% edgestyle {'normal',fixed'}</span>
0056 <span class="comment">% edgevaluesmax</span>
0057 <span class="comment">% edgevaluesmin</span>
0058 <span class="comment">%</span>
0059 <span class="comment">%REGULATION ARROWS</span>
0060 <span class="comment">% show_regulation (flag)</span>
0061 <span class="comment">% show_regulationvalues (flag)</span>
0062 <span class="comment">% regulationvalues (sparse matrix of size of regulation_matrix)</span>
0063 <span class="comment">% regulationstyle {'normal',fixed'}</span>
0064 <span class="comment">% rlinecolor</span>
0065 <span class="comment">%</span>
0066 <span class="comment">%TEXT ITEMS</span>
0067 <span class="comment">% chop_names     (length)</span>
0068 <span class="comment">% split_names (length)</span>
0069 <span class="comment">% FontSize</span>
0070 <span class="comment">% Rotation  (for all text items)</span>
0071 <span class="comment">% text_offset</span>
0072 <span class="comment">%</span>
0073 <span class="comment">%COLORSCALE AND LINES</span>
0074 <span class="comment">% colorbar (0/1)</span>
0075 <span class="comment">% colorbar_numbers</span>
0076 <span class="comment">% linecolor</span>
0077 <span class="comment">% linewidth</span>
0078 <span class="comment">% colormap        (default rb_colors)</span>
0079 <span class="comment">% black_and_white (default 0)</span>
0080 <span class="comment">% showsign</span>
0081 <span class="comment">%</span>
0082 <span class="comment">% figure_axis</span>
0083 <span class="comment">% figure_position</span>
0084 <span class="comment">% subplot_position</span>
0085 <span class="comment">% YDir ('normal','reverse')</span>
0086 <span class="comment">% hold_on (flag)</span>
0087 
0088 <a name="_sub0" href="#_subfunctions" class="code">function  network = netgraph_draw(network,varargin)</a>
0089 
0090 <span class="keyword">if</span> sum(size(network.N)) &gt; 1000, warning(<span class="string">'Network too large for drawing'</span>); <span class="keyword">return</span>; <span class="keyword">end</span>
0091 
0092 p     = <a href="#_sub11" class="code" title="subfunction p = netgraph_draw_set_parameters(network,vararg)">netgraph_draw_set_parameters</a>(network,varargin);
0093 
0094 
0095 
0096 n_met = length(network.metabolites);
0097 n_act = length(network.actions);
0098 m     = p.m;
0099 x     = p.x;
0100 
0101 <span class="keyword">if</span> p.hold_on==1, hold on; <span class="keyword">else</span>, cla;  <span class="keyword">end</span>
0102 <span class="keyword">if</span> ~isempty(p.figure_position), set(gcf,<span class="string">'Position'</span>,p.figure_position); <span class="keyword">end</span>
0103 <span class="keyword">if</span> ~isempty(p.subplot_position), 
0104   subplot(<span class="string">'Position'</span>,p.subplot_position); 
0105 <span class="keyword">end</span>
0106 
0107 hold on;
0108 
0109 x_arrowlistN = zeros(n_met,n_act,2);
0110 
0111 <span class="keyword">if</span> p.colorbar,
0112   <span class="keyword">if</span> isempty(p.colorbar_numbers),
0113     <span class="keyword">if</span> length(p.metvaluesmax),
0114       p.colorbar_numbers = [p.metvaluesmin,p.metvaluesmax]; 
0115     <span class="keyword">elseif</span> length(p.actvaluesmax),
0116       p.colorbar_numbers = [p.actvaluesmin,p.actvaluesmax]; 
0117     <span class="keyword">elseif</span> p.edgevaluesmax,
0118       p.colorbar_numbers = [p.edgevaluesmin,p.edgevaluesmax]; 
0119     <span class="keyword">end</span>
0120   <span class="keyword">end</span>
0121   <a href="#_sub10" class="code" title="subfunction this_colorbar(num,colmap)">this_colorbar</a>(p.colorbar_numbers, p.colormap);
0122 <span class="keyword">end</span>
0123 
0124 
0125 <span class="comment">% ------------------------------------------------------------------------------</span>
0126 <span class="comment">% only lines</span>
0127 
0128 <span class="keyword">if</span> p.straightlines,   <span class="comment">% straight lines</span>
0129   [i2,j2] = find(triu(m));
0130   <span class="keyword">for</span> itt = 1:length(i2),
0131     <span class="keyword">if</span> sum(j2(itt)-n_met==p.actindshow) * sum(i2(itt)==p.metindshow)
0132       line([x(1,i2(itt)); x(1,j2(itt))],[x(2,i2(itt)); x(2,j2(itt))],<span class="string">'color'</span>,p.linecolor,<span class="string">'Linewidth'</span>,p.linewidth); 
0133     <span class="keyword">end</span>
0134   <span class="keyword">end</span>
0135 <span class="keyword">end</span>
0136 
0137 
0138 <span class="comment">% ---------------------------------------------------</span>
0139 <span class="comment">% little dots at all nodes</span>
0140 
0141 <span class="keyword">if</span> ~p.no_points, 
0142   dd = [p.metindshow, n_met + p.actindshow];
0143   plot(x(1,dd),x(2,dd), <span class="string">'b.'</span>); 
0144 <span class="keyword">end</span>
0145 
0146 
0147 <span class="comment">% ---------------------------------------------------</span>
0148 <span class="comment">% metabolites</span>
0149 
0150 <span class="keyword">if</span> p.show_metvalues,
0151   
0152   <span class="keyword">switch</span> p.metcolstyle
0153     <span class="keyword">case</span> <span class="string">'fixed'</span>,  c = repmat(p.metcol,n_met,1);
0154     <span class="keyword">case</span> <span class="string">'values'</span>, c = <a href="../.././mnt/utils/get_color.html" class="code" title="function c = get_color(values, minvalue,maxvalue,cmap);">get_color</a>(p.norm_metvalues,-1,1,p.colormap);
0155   <span class="keyword">end</span>
0156 
0157   <span class="keyword">if</span> length(p.metcolors),
0158     c = p.metcolors(p.metabolite_mapping,:);
0159   <span class="keyword">end</span>
0160   
0161   p.norm_metvalues = abs(p.norm_metvalues);
0162   
0163   <span class="keyword">switch</span> p.metstyle
0164     <span class="keyword">case</span> <span class="string">'box'</span>,    p.norm_metvalues_std = 0*p.norm_metvalues_std;
0165     <span class="keyword">case</span> <span class="string">'none'</span>,   p.show_actvalues = 0;
0166     <span class="keyword">case</span> <span class="string">'fixed'</span>,  p.norm_metvalues(isfinite(p.norm_metvalues)) = 1;
0167   <span class="keyword">end</span>
0168   
0169   <span class="keyword">for</span> it = p.metindshow, 
0170     <a href="#_sub2" class="code" title="subfunction plot_circle(x,y,l,std,squaresize,col,flag_edges)">plot_circle</a>(x(1,it), x(2,it), p.norm_metvalues(it), p.norm_metvalues_std(it), p.squaresize, c(it,:), p.flag_edges); 
0171   <span class="keyword">end</span>; 
0172 
0173 <span class="keyword">end</span>
0174 
0175 
0176 <span class="comment">% ------------------------------------------------------------------------------</span>
0177 <span class="comment">% lines and triangles</span>
0178 
0179 <span class="keyword">if</span> strcmp(p.arrowstyle,<span class="string">'none'</span>),
0180   p.single_arrow = 0;
0181 <span class="keyword">end</span>
0182 
0183 <span class="keyword">if</span> p.single_arrow,
0184   p.show_arrowvalues = 0; 
0185   p.arrow_shift = 1; 
0186 <span class="keyword">end</span>
0187 
0188 <span class="keyword">if</span> p.straightlines,   <span class="comment">% straight lines</span>
0189   
0190   [ind_met,ind_act] = find(m(p.metindshow, end-n_act+p.actindshow));
0191   ind_met = p.metindshow(ind_met);
0192   ind_act = p.actindshow(ind_act);
0193   <span class="keyword">for</span> k = 1:length(ind_met),
0194     stoich_coeff = p.N(ind_met(k),ind_act(k));
0195     x_met = x(:,ind_met(k));
0196     x_act = x(:,ind_act(k)+n_met);
0197     
0198     <span class="keyword">if</span> p.show_arrowvalues,
0199       scale = p.arrowsize * sqrt(abs(p.norm_arrowvalues( ind_act(k) )));
0200       <span class="keyword">if</span> p.arrow_stoichiometries, scale = scale * abs(stoich_coeff); <span class="keyword">end</span>
0201       forward = -sign(stoich_coeff) * sign(p.arrowvalues( ind_act(k) ));      
0202       <span class="comment">%% forward can be 1 or -1</span>
0203       arrow_shift = (forward==1) * p.arrow_shift + (forward==-1) * (1-p.arrow_shift);
0204       <span class="keyword">if</span> isnan(forward), arrow_shift = 0.5; <span class="keyword">end</span> 
0205       x_arr = x_met + arrow_shift * (x_act-x_met);
0206       <span class="keyword">switch</span> p.arrowstyle, 
0207         <span class="keyword">case</span> {<span class="string">'fluxes'</span>,<span class="string">'directions'</span>},
0208           phi  = angle( x_act(1) - x_met(1) + i *(x_act(2) - x_met(2)));
0209           <a href="#_sub5" class="code" title="subfunction plot_triangle(x, y, phi, l, col, forward,flag_edges)">plot_triangle</a>(x_arr(1),x_arr(2),phi,scale, p.arrowcolor, forward,p.flag_edges);
0210       <span class="keyword">end</span>        
0211     <span class="keyword">end</span>
0212     
0213     x_arrowlistN(ind_met(k),ind_act(k),:) =  x_met + .5 * (x_act-x_met);
0214   <span class="keyword">end</span>
0215   
0216 <span class="keyword">else</span>,  <span class="comment">% curved lines</span>
0217   
0218   <span class="keyword">for</span> q1=1:n_act,
0219     <span class="keyword">if</span> sum(q1==p.actindshow),
0220     substrates   = find(p.N(:,q1)&lt;0);
0221     products     = find(p.N(:,q1)&gt;0);
0222     reactants    = find(p.N(:,q1)~=0);
0223     x_act        = x(:,n_met+q1);
0224     x_substrates = x(:,substrates);
0225     x_products   = x(:,products);
0226     x_reactants  = x(:,reactants);
0227     x_substrate_mean = mean(x_substrates,2);
0228     x_product_mean   = mean(x_products,2);
0229 
0230     <span class="keyword">if</span> p.show_arrowvalues,
0231       <span class="keyword">for</span> q2 = 1:length(reactants),
0232         x_met = x_reactants(:,q2);
0233         stoich_coeff = p.N(reactants(q2),q1);
0234         forward = -sign(stoich_coeff)*sign(p.arrowvalues(q1)); 
0235 <span class="comment">% forward can be 1 or -1</span>
0236         straight = 0;
0237         <span class="keyword">if</span>  forward==1 &amp; isempty(products),   straight = 1; <span class="keyword">end</span>
0238         <span class="keyword">if</span> forward==-1 &amp; isempty(substrates), straight = 1; <span class="keyword">end</span>
0239         arrow_shift = (forward==-1) * p.arrow_shift + (forward==+1) * (1-p.arrow_shift);
0240         <span class="keyword">if</span> straight,
0241           line([x_met(1),x_act(1)],[x_met(2),x_act(2)],<span class="string">'color'</span>,p.linecolor);
0242           
0243           x_arr = x_met + arrow_shift * (x_act-x_met);
0244         <span class="keyword">else</span>,
0245           <span class="keyword">switch</span> forward,
0246             <span class="keyword">case</span> 1,    [x_arr(1),x_arr(2)] = <a href="#_sub7" class="code" title="subfunction  [arcx,arcy] = tri_arc(x1,x2,x3,linecolor,arrow_shift)">tri_arc</a>(x_met,x_act,  x_product_mean,p.linecolor,arrow_shift);
0247             <span class="keyword">case</span> -1,   [x_arr(1),x_arr(2)] = <a href="#_sub7" class="code" title="subfunction  [arcx,arcy] = tri_arc(x1,x2,x3,linecolor,arrow_shift)">tri_arc</a>(x_met,x_act,x_substrate_mean,p.linecolor,arrow_shift);
0248         <span class="keyword">end</span>
0249         <span class="keyword">end</span>
0250         x_arrowlistN(ind_met(k),ind_act(k),:) =  x_arr;
0251         <span class="keyword">switch</span> p.arrowstyle,
0252           <span class="keyword">case</span> {<span class="string">'fluxes'</span>,<span class="string">'directions'</span>},
0253             phi   = angle( x_act(1)-x_met(1) + i *(x_act(2)-x_met(2)));
0254             scale = p.arrowsize*sqrt(abs( p.norm_arrowvalues( q1 ) ));
0255             <a href="#_sub5" class="code" title="subfunction plot_triangle(x, y, phi, l, col, forward,flag_edges)">plot_triangle</a>(x_arr(1),x_arr(2),phi,scale, <span class="string">'b'</span>, forward,p.flag_edges);    
0256         <span class="keyword">end</span>
0257       <span class="keyword">end</span>
0258       <span class="keyword">end</span>
0259     <span class="keyword">end</span>
0260   <span class="keyword">end</span>
0261   
0262 <span class="keyword">end</span>
0263 
0264 
0265 
0266 <span class="comment">% ---------------------------------------------------</span>
0267 <span class="comment">% edges</span>
0268 
0269 <span class="keyword">if</span> p.show_edgevalues,
0270   <span class="keyword">for</span> ind_m = p.metindshow, 
0271     <span class="keyword">for</span> r = 1:length(p.actindshow),
0272       ind_r = p.actindshow(r);
0273       <span class="keyword">if</span> network.N(ind_m,ind_r) ~=0,
0274         x_pos  = squeeze(x_arrowlistN(ind_m,ind_r,:));
0275         value  = p.norm_edgevalues(ind_m,ind_r);
0276         stddev = p.norm_edgevalues_std(ind_m,ind_r);
0277         c      = <a href="../.././mnt/utils/get_color.html" class="code" title="function c = get_color(values, minvalue,maxvalue,cmap);">get_color</a>(value,-1,1,p.colormap);
0278         <span class="keyword">switch</span> p.edgestyle,
0279           <span class="keyword">case</span> <span class="string">'fixed'</span>,           <span class="keyword">if</span> isfinite(value),  value = 1; <span class="keyword">end</span>;       
0280         <span class="keyword">end</span>
0281         <a href="#_sub3" class="code" title="subfunction plot_diamond(x,y,l,std,squaresize,col,flag_edges)">plot_diamond</a>(x_pos(1),x_pos(2),value, stddev,p.squaresize,c,p.flag_edges);
0282         <span class="keyword">if</span> p.edgeprintvalues, 
0283           <span class="keyword">if</span> isnan(p.edgevalues(ind_m,ind_r)), my_ss = <span class="string">''</span>; <span class="keyword">else</span>, my_ss = num2str(p.edgevalues(ind_m,ind_r),3); <span class="keyword">end</span>
0284           offset = 0.5*p.squaresize;
0285           text(x_pos(1)+ offset, x_pos(2)+offset, my_ss,<span class="string">'FontSize'</span>,p.FontSize,<span class="string">'Rotation'</span>,p.fontangle);
0286         <span class="keyword">end</span>
0287       <span class="keyword">end</span>
0288     <span class="keyword">end</span>
0289   <span class="keyword">end</span>
0290 <span class="keyword">end</span>
0291 
0292 
0293 <span class="comment">% ---------------------------------------------------</span>
0294 <span class="comment">% regulation edges</span>
0295 
0296 x_arrowlistW = zeros(n_act,n_met,2);
0297 <span class="keyword">if</span> p.show_regulation,
0298   [indr,indm] = find(tril(p.regulation_matrix));
0299   <span class="keyword">for</span> itt=1:length(indr),
0300     <span class="keyword">if</span> sum(indr(itt)-n_met == p.actindshow) * sum(indm(itt) == p.metindshow) ,
0301       this_sign = sign(p.regulation_matrix(indr(itt),indm(itt)));
0302       <span class="keyword">if</span> this_sign&gt;0, linecolor = [0 0.2 1];
0303       <span class="keyword">else</span>,           linecolor = [1 0 0]; 
0304       <span class="keyword">end</span>
0305       [x3,arcx,arcy] = <a href="../.././mnt/utils/arc.html" class="code" title="function [x,arcx,arcy] = arc(x1,x2,height,arrow_shift);">arc</a>(x(:,indr(itt)),x(:,indm(itt)),0.2,0.5);
0306       plot(x3(1,:),x3(2,:),<span class="string">'color'</span>,linecolor);
0307       <span class="keyword">if</span> p.show_regulationvalues,
0308         val    = p.norm_regulationvalues(indr(itt)-n_met,indm(itt));
0309         stddev =     p.norm_regulationvalues_std(indr(itt)-n_met,indm(itt));
0310         c      = <a href="../.././mnt/utils/get_color.html" class="code" title="function c = get_color(values, minvalue,maxvalue,cmap);">get_color</a>(val,-1,1,p.colormap);
0311         <span class="keyword">switch</span> p.regulationstyle,  <span class="keyword">case</span> <span class="string">'fixed'</span>, <span class="keyword">if</span> isfinite(val), val = 1;  <span class="keyword">end</span>; <span class="keyword">end</span>
0312         <a href="#_sub3" class="code" title="subfunction plot_diamond(x,y,l,std,squaresize,col,flag_edges)">plot_diamond</a>( arcx,arcy, val,stddev,p.squaresize,c,p.flag_edges);
0313       <span class="keyword">end</span>
0314       <span class="keyword">if</span> p.regulationprintvalues, 
0315         ddd = p.regulationvalues(indr(itt)-n_met,indm(itt));
0316         <span class="keyword">if</span> isnan(ddd), my_ss = <span class="string">''</span>; <span class="keyword">else</span>,  my_ss = num2str(ddd,3); <span class="keyword">end</span>
0317         offset=0.5*p.squaresize;
0318         text(arcx+ offset, arcy+offset, my_ss,<span class="string">'FontSize'</span>,p.FontSize,<span class="string">'Rotation'</span>,p.fontangle); 
0319       <span class="keyword">end</span>
0320     <span class="keyword">end</span>
0321   <span class="keyword">end</span>
0322 <span class="keyword">end</span>
0323 
0324 
0325 <span class="comment">% ---------------------------------------------------</span>
0326 <span class="comment">% reactions</span>
0327 
0328 <span class="keyword">if</span> p.show_actvalues,
0329   
0330   <span class="keyword">switch</span> p.actcolstyle
0331     <span class="keyword">case</span> <span class="string">'fixed'</span>,  c = repmat(p.actcol,n_act,1);
0332     <span class="keyword">case</span> <span class="string">'values'</span>, c = <a href="../.././mnt/utils/get_color.html" class="code" title="function c = get_color(values, minvalue,maxvalue,cmap);">get_color</a>(p.norm_actvalues,-1,1,p.colormap);
0333   <span class="keyword">end</span>
0334   
0335   <span class="keyword">if</span> length(p.actcolors),
0336     c = p.actcolors(p.reaction_mapping,:);
0337   <span class="keyword">end</span>
0338 
0339   <span class="keyword">switch</span> p.actstyle,
0340     <span class="keyword">case</span> <span class="string">'box'</span>,    p.norm_actvalues_std = 0*p.norm_actvalues_std;
0341     <span class="keyword">case</span> <span class="string">'fixed'</span>,  p.norm_actvalues(isfinite(p.norm_actvalues)) = 1;
0342   <span class="keyword">end</span>
0343   
0344   <span class="keyword">switch</span> p.actstyle,
0345     <span class="keyword">case</span> {<span class="string">'box'</span>,<span class="string">'box_std'</span>,<span class="string">'fixed'</span>},  
0346       <span class="keyword">for</span> r=1:length(p.actindshow),    
0347         it = p.actindshow(r);
0348         <a href="../.././mnt/utils/plot_square.html" class="code" title="function plot_square(x,y,l,col)">plot_square</a>(x(1,it+n_met),x(2,it+n_met),abs(p.norm_actvalues(it)),p.norm_actvalues_std(it),p.squaresize,c(it,:),p.flag_edges); 
0349       <span class="keyword">end</span>
0350   <span class="keyword">end</span>
0351 <span class="keyword">end</span>
0352 
0353 <span class="keyword">if</span> p.single_arrow * p.show_arrowvalues,
0354   [ind_met,ind_act] = find(m(p.metindshow,end-n_act+p.actindshow));
0355   ind_met = p.metindshow(ind_met);
0356   ind_act = p.actindshow(ind_act);
0357   <span class="keyword">for</span> k = 1:length(ind_met),
0358     stoich_coeff = p.N(ind_met(k),ind_act(k));
0359     <span class="keyword">if</span> [stoich_coeff * p.norm_arrowvalues( ind_act(k) )]&lt; 0,
0360       x_met = x(:,ind_met(k));
0361       x_act = x(:,ind_act(k)+n_met);
0362       scale   = p.arrowsize * sqrt(abs(p.norm_arrowvalues( ind_act(k) )));
0363       <span class="keyword">if</span> p.arrow_stoichiometries, scale = scale  * abs(stoich_coeff); <span class="keyword">end</span>
0364       forward = -sign(stoich_coeff) * sign(p.arrowvalues( ind_act(k) ));      
0365       <span class="comment">%% forward can be 1 or -1</span>
0366       arrow_shift = (forward==1) * p.arrow_shift + (forward==-1) * (1-p.arrow_shift);
0367       <span class="keyword">if</span> isnan(forward), arrow_shift = 0.5; <span class="keyword">end</span> 
0368       x_arr = x_met + arrow_shift * (x_act-x_met);
0369       <span class="keyword">switch</span> p.arrowstyle, 
0370         <span class="keyword">case</span> {<span class="string">'fluxes'</span>,<span class="string">'directions'</span>},
0371           phi  = angle( x_act(1) - x_met(1) + i *(x_act(2) - x_met(2)));
0372           <a href="#_sub5" class="code" title="subfunction plot_triangle(x, y, phi, l, col, forward,flag_edges)">plot_triangle</a>(x_arr(1),x_arr(2),phi,scale, p.arrowcolor, forward,p.flag_edges);
0373       <span class="keyword">end</span>        
0374       x_arrowlistN(ind_met(k),ind_act(k),:) = x_met + .5 * (x_act-x_met);
0375     <span class="keyword">end</span>
0376   <span class="keyword">end</span>
0377 
0378 <span class="keyword">end</span>
0379 
0380 
0381 <span class="comment">% ---------------------------------------------------</span>
0382 <span class="comment">% text</span>
0383 
0384 <span class="keyword">if</span> p.metprintnames, 
0385   tx = x(1,1:n_met) + p.text_offset(1);
0386   ty = x(2,1:n_met) + p.text_offset(2);
0387   text(tx(p.metindshow),ty(p.metindshow), p.metnames(p.metindshow),<span class="string">'FontSize'</span>,p.FontSize,<span class="string">'Rotation'</span>,p.fontangle); 
0388 <span class="comment">%  text(tx,ty, p.metnames,'FontSize',p.FontSize,'Rotation',p.fontangle);</span>
0389 <span class="keyword">end</span>
0390 
0391 <span class="keyword">if</span> p.actprintnames, 
0392   tx = x(1,n_met+1:end) + p.text_offset(1);
0393   ty = x(2,n_met+1:end) + p.text_offset(2);
0394   text(tx(p.actindshow),ty(p.actindshow), p.actnames(p.actindshow),<span class="string">'FontSize'</span>,p.FontSize,<span class="string">'Rotation'</span>,p.fontangle); 
0395 <span class="keyword">end</span>
0396 
0397 <span class="keyword">if</span> p.metprintvalues, 
0398   <span class="keyword">if</span> ~length(p.metvalues), error(<span class="string">'No metabolite values given'</span>); <span class="keyword">end</span>
0399  <span class="keyword">if</span> find(p.metvalues_std~=0), 
0400    strings = [num2str(p.metvalues,3) repmat(<span class="string">' \pm '</span>,n_met,1) num2str(p.metvalues_std,2)];
0401  <span class="keyword">else</span> 
0402    strings = num2str(p.metvalues,3); 
0403  <span class="keyword">end</span>
0404  offset=0.5*p.squaresize;<span class="comment">%*(0.5+p.metvalues_std');</span>
0405 <span class="comment">% text(x(1,p.metindshow) + offset,x(2,p.metindshow)+offset,strings(p.metindshow),'FontSize',p.FontSize,'Rotation',p.fontangle);</span>
0406  text(x(1,1:n_met) + offset,x(2,1:n_met)+offset,strings,<span class="string">'FontSize'</span>,p.FontSize,<span class="string">'Rotation'</span>,p.fontangle); 
0407 <span class="keyword">end</span>
0408 
0409 <span class="keyword">if</span> p.actprintvalues, 
0410   <span class="keyword">if</span> ~length(p.actvalues), error(<span class="string">'No reaction values given'</span>); <span class="keyword">end</span>
0411   <span class="keyword">if</span> find(p.actvalues_std~=0),
0412     strings = [num2str(p.actvalues,3) repmat(<span class="string">' \pm '</span>,n_act,1) num2str(p.actvalues_std,2)];
0413   <span class="keyword">else</span> strings = num2str(p.actvalues,3); <span class="keyword">end</span>
0414   strings = cellstr(strings);
0415   <span class="keyword">for</span> it = 1:length(strings), strings{it} = strrep(strings{it},<span class="string">'NaN'</span>,<span class="string">''</span>); <span class="keyword">end</span>   
0416   ppos = x(:,n_met+1:end);
0417   offset=0.5*p.squaresize;<span class="comment">%*(0.5+p.actvalues_std(p.actindshow)');</span>
0418   text(ppos(1,p.actindshow) + offset, ppos(2,p.actindshow)+offset, strings(p.actindshow)',<span class="string">'FontSize'</span>,p.FontSize,<span class="string">'Rotation'</span>,p.fontangle); 
0419 <span class="keyword">end</span>
0420 
0421 <span class="keyword">if</span> p.arrowprintvalues, 
0422   <span class="keyword">if</span> ~length(p.arrowvalues), error(<span class="string">'No arrow values given'</span>); <span class="keyword">end</span>
0423   <span class="keyword">if</span> find(p.arrowvalues_std~=0),
0424     strings = [num2str(p.arrowvalues,3) repmat(<span class="string">' \pm '</span>,n_act,1) num2str(p.arrowvalues_std,2)];
0425   <span class="keyword">else</span> strings = num2str(p.arrowvalues,3); <span class="keyword">end</span>
0426   strings = cellstr(strings);
0427   <span class="keyword">for</span> it = 1:length(strings), strings{it} = strrep(strings{it},<span class="string">'NaN'</span>,<span class="string">''</span>); <span class="keyword">end</span>   
0428   ppos = x(:,n_met+1:end);
0429   offset=0.5*p.squaresize;<span class="comment">%*(0.5+p.arrowvalues_std(p.actindshow)');</span>
0430   text(ppos(1,p.actindshow) + offset, ppos(2,p.actindshow)+offset, strings(p.actindshow)',<span class="string">'FontSize'</span>,p.FontSize,<span class="string">'Rotation'</span>,p.fontangle); 
0431 <span class="keyword">end</span>
0432 
0433 <span class="comment">% ---------------------------------------------------</span>
0434 
0435 <span class="comment">% figure general layout</span>
0436 
0437 set(gca,<span class="string">'YDir'</span>,p.YDir);
0438 
0439 <a href="../.././mnt/utils/noticks.html" class="code" title="function noticks();">noticks</a>;
0440 
0441 a = [1.1 * min(p.x(1,:))-0.1* max(p.x(1,:)),<span class="keyword">...</span>
0442      -0.1 * min(p.x(1,:))+1.1* max(p.x(1,:)),<span class="keyword">...</span>
0443      1.1 * min(p.x(2,:))-0.1* max(p.x(2,:)),<span class="keyword">...</span>
0444      -0.1 * min(p.x(2,:))+1.1* max(p.x(2,:))];
0445 
0446 <span class="keyword">if</span> ~isempty(p.figure_axis), a = p.figure_axis;
0447 <span class="keyword">end</span> 
0448 
0449 axis(a);
0450 axis off;
0451 axis equal;
0452 
0453 network.graphics_par = p;
0454 
0455 
0456 <span class="comment">% -----------------------------------------------------</span>
0457 <span class="comment">% END OF MAIN PROGRAM</span>
0458 <span class="comment">% -----------------------------------------------------</span>
0459 
0460 
0461 <span class="comment">% -----------------------------------------------------------------</span>
0462 
0463 <a name="_sub1" href="#_subfunctions" class="code">function plot_square(x,y,l,std,squaresize,col,flag_edges)</a>
0464 
0465 stdcol = .7+.3*col;
0466 <span class="keyword">if</span> isnan(l),     l = 0.2; col = [.7 .7 .7]; stdcol = [0 0 0]; <span class="keyword">end</span>
0467 <span class="keyword">if</span> isnan(std), std = .1; <span class="keyword">end</span>
0468 <span class="keyword">if</span>  flag_edges, ecol = [.3 .3 .6]; secol = [.3 .3 .6]; <span class="keyword">else</span>, ecol = col; secol =  stdcol; <span class="keyword">end</span>
0469 <span class="keyword">if</span> std,
0470   l_max = squaresize*(l+std); 
0471   fill(x + 0.5 * l_max*[-1 1 1 -1], y + 0.5*l_max*[-1 -1 1 1],stdcol,<span class="string">'EdgeColor'</span>,secol)
0472 <span class="keyword">end</span>
0473 l_min = squaresize*(max(0,l));
0474 fill(x + 0.5 * l_min*[-1 1 1 -1], y + 0.5*l_min*[-1 -1 1 1],col,<span class="string">'EdgeColor'</span>,ecol)
0475 
0476 
0477 <span class="comment">% -----------------------------------------------------------------</span>
0478 
0479 <a name="_sub2" href="#_subfunctions" class="code">function plot_circle(x,y,l,std,squaresize,col,flag_edges)</a>
0480 
0481 stdcol = .7 + .3 * col;
0482 
0483 <span class="keyword">if</span> isnan(l), l = 0.2 ; col = [.7 .7 .7]; stdcol = [0 0 0]; <span class="keyword">end</span>
0484 
0485 <span class="keyword">if</span> isnan(std), std = .1; <span class="keyword">end</span>
0486 
0487 <span class="keyword">if</span>  flag_edges, ecol = [.3 .3 .6]; secol = [.3 .3 .6]; <span class="keyword">else</span>, ecol = col; secol =  stdcol; <span class="keyword">end</span>
0488 
0489 <span class="keyword">if</span> std,
0490   l_max = squaresize*(l+std); 
0491   fill(x + 0.5 * l_max * cos(0:0.1:2*pi), y + 0.5*l_max * sin(0:0.1:2*pi),stdcol,<span class="string">'EdgeColor'</span>,secol)
0492 <span class="keyword">end</span>
0493 
0494 l_min = squaresize * (max(0,l));
0495 
0496 <span class="keyword">if</span> l_min,
0497   fill(x + 0.5 * l_min * cos(0:0.1:2*pi), y + 0.5*l_min * sin(0:0.1:2*pi),col,<span class="string">'EdgeColor'</span>,ecol)
0498 <span class="keyword">end</span>
0499 
0500 
0501 <span class="comment">% -----------------------------------------------------------------</span>
0502 
0503 <a name="_sub3" href="#_subfunctions" class="code">function plot_diamond(x,y,l,std,squaresize,col,flag_edges)</a>
0504 
0505 stdcol = .7+.3*col;
0506 <span class="keyword">if</span> isnan(l),     l = 0.5; col = [.7 .7 .7]; stdcol = [0 0 0]; <span class="keyword">end</span>
0507 <span class="keyword">if</span> isnan(std), std = .1; <span class="keyword">end</span>
0508 <span class="keyword">if</span>  flag_edges, ecol = [.3 .3 .6]; secol = [.3 .3 .6]; <span class="keyword">else</span>, ecol = col; secol =  stdcol; <span class="keyword">end</span>
0509 <span class="keyword">if</span> std,
0510   l_max = squaresize*(l+std); 
0511   fill(x + 0.5 * l_max * 4/pi* [-1 0 1 0 -1], y + 0.5*l_max*4/pi*[0 -1 0 1 0],stdcol,<span class="string">'EdgeColor'</span>,secol)
0512 <span class="keyword">end</span>
0513 l_min = squaresize*(max(0,l));
0514 fill(x + 0.5 * l_min * 4/pi* [-1 0 1 0 -1], y + 0.5*l_min*4/pi*[0 -1 0 1 0],col,<span class="string">'EdgeColor'</span>,ecol)
0515 
0516 
0517 <span class="comment">% -----------------------------------------------------------------</span>
0518 
0519 <a name="_sub4" href="#_subfunctions" class="code">function plot_octagon(x,y,l,std,squaresize,col,flag_edges)</a>
0520 
0521 stdcol = .7+.3*col;
0522 <span class="keyword">if</span> isnan(l),     l = 0.5; col = [.7 .7 .7]; stdcol = [0 0 0]; <span class="keyword">end</span>
0523 <span class="keyword">if</span> isnan(std), std = .1; <span class="keyword">end</span>
0524 <span class="keyword">if</span>  flag_edges, ecol = [.3 .3 .6]; secol = [.3 .3 .6]; <span class="keyword">else</span>, ecol = col; secol =  stdcol; <span class="keyword">end</span>
0525 <span class="keyword">if</span> std,
0526   l_max = squaresize*(l+std); 
0527   fill(x + 0.5 * l_max * 4/pi* [-1 -0.5 0.5 1 1 0.5 -0.5 -1], y + 0.5*l_max*4/pi*[-0.5 -1 -1 -0.5 0.5 1 1 0.5],stdcol,<span class="string">'EdgeColor'</span>,secol)
0528 <span class="keyword">end</span>
0529 l_min = squaresize*(max(0,l));
0530 fill(x + 0.5 * l_min * 4/pi* [-1 -0.5 0.5 1 1 0.5 -0.5 -1], y + 0.5*l_min*4/pi*[-0.5 -1 -1 -0.5 0.5 1 1 0.5],col,<span class="string">'EdgeColor'</span>,ecol)
0531 
0532 
0533 <span class="comment">% -----------------------------------------------------------------</span>
0534 
0535 <a name="_sub5" href="#_subfunctions" class="code">function plot_triangle(x, y, phi, l, col, forward,flag_edges)</a>
0536 
0537 <span class="keyword">if</span> isnan(l), l = l*0.5; forward = 1; col = [.7 .7 .7]; 
0538   points = repmat([x; y],1,4) +  l * [-1 0 1 0; 0 -1 0 1];
0539 <span class="keyword">else</span>,
0540   points = repmat([x; y],1,3) + forward * [cos(phi) -sin(phi); sin(phi) cos(phi)] * l * [-0.5 .5 -0.5; -0.3 0 0.3];
0541 <span class="keyword">end</span>
0542 fill(points(1,:),points(2,:),col);
0543 
0544 
0545 <span class="comment">% -------------------------</span>
0546 <span class="comment">% compute positions on an arc: x3 all points for drawing;</span>
0547 <span class="comment">% arcx,arcy: positions of one point (used for arrow)</span>
0548  
0549  <span class="keyword">function</span> [x3,arcx,arcy] = <a href="../.././mnt/utils/arc.html" class="code" title="function [x,arcx,arcy] = arc(x1,x2,height,arrow_shift);">arc</a>(x1,x2,height,arrow_shift);
0550  
0551  s = 0:0.1:pi;
0552  x3 = repmat(mean([x1,x2],2),1,length(s)) <span class="keyword">...</span>
0553       + 0.5 * [x2-x1] * cos(s) + height * 0.5 * [0 -1; 1 0] * [x2-x1] * sin(s);
0554  nn = max(1,ceil(arrow_shift * size(x3,2)));
0555  arcx = x3(1,nn); 
0556  arcy = x3(2,nn); 
0557  
0558 
0559 <span class="comment">% -----------------------------------------------------------------</span>
0560 
0561 <a name="_sub6" href="#_subfunctions" class="code">function  [arcx,arcy] = tri_arc(x1,x2,x3,linecolor,arrow_shift)</a>
0562  
0563  <span class="comment">% compute height:</span>
0564  
0565  R90 = [ 0 -1; 1 0];
0566  lambda = 0.5* R90*[x2-x1, x3-x2] * (x1-x3);
0567  f = 0.5*(x1+x2)+lambda(1)*R90*(x2-x1);
0568  height = sqrt(sum((f - x1).^2)) - sqrt(sum ( (f - (0.5*(x1+x2))) .^2));
0569  height = - height * sign ( (x3-x2)'*R90*(x2-x1));
0570  
0571  [x3,arcx,arcy] = <a href="../.././mnt/utils/arc.html" class="code" title="function [x,arcx,arcy] = arc(x1,x2,height,arrow_shift);">arc</a>(x1,x2, height,arrow_shift);
0572  plot(x3(1,:),x3(2,:),<span class="string">'color'</span>,linecolor); 
0573 
0574 
0575 
0576 <span class="comment">% -------------------------------------------------</span>
0577 
0578 <a name="_sub7" href="#_subfunctions" class="code">function name2 = split_name(name,l)</a>
0579 
0580 name2 = name;
0581 <span class="keyword">if</span> length(name) &gt; l,
0582   ll = ceil(length(name)/2);
0583   name  = [name repmat(<span class="string">' '</span>,1,ll - mod(length(name),ll))];
0584   name1 = [reshape(name,ll,length(name)/ll)', repmat(<span class="string">'\n'</span>,length(name)/ll,1)];
0585   name1 = reshape(name1',prod(size(name1)),1)';
0586   name2 = sprintf(name1(1:end-2));
0587 <span class="keyword">end</span>
0588 
0589 
0590 <span class="comment">% -------------------------------------------------</span>
0591 
0592 <a name="_sub8" href="#_subfunctions" class="code">function [normvalues, normvalues_std,valuesmax,valuesmin] = normalise(values,values_std,valuesmax,valuesmin,p);</a>
0593 
0594 normvalues     = [];
0595 normvalues_std = [];
0596 
0597 <span class="keyword">if</span> p.omit_zeros, nonzero = (values~=0); <span class="keyword">end</span>
0598 
0599 <span class="keyword">if</span> p.showsign,
0600   <span class="keyword">if</span> isempty(valuesmax),   valuesmax  = max(10^-10,max(abs(values(:)))); <span class="keyword">end</span>
0601   <span class="keyword">if</span> isempty(valuesmin),   valuesmin  = - valuesmax   ; <span class="keyword">end</span>
0602 <span class="keyword">else</span>,
0603   <span class="keyword">if</span> isempty(valuesmax),   valuesmax  = max(values(:)); <span class="keyword">end</span>
0604   <span class="keyword">if</span> isempty(valuesmin),   valuesmin  = min(values(:)); <span class="keyword">end</span>  
0605 <span class="keyword">end</span>
0606 <span class="keyword">if</span> valuesmin == valuesmax,  valuesmax = 10^-10 +  valuesmin; <span class="keyword">end</span>
0607 <span class="keyword">if</span> p.showsign,
0608   normvalues     = values / valuesmax;
0609 <span class="keyword">else</span>
0610   normvalues     = 2*[(values -  valuesmin)   / ( valuesmax- valuesmin)]-1;
0611 <span class="keyword">end</span>
0612 
0613 normvalues_std = real(values_std /  ( valuesmax- valuesmin));
0614 normvalues(find(normvalues&gt;1)) = 1;  
0615 normvalues(find(normvalues&lt;-1))=-1;
0616 
0617 <span class="keyword">if</span> p.omit_zeros, 
0618   normvalues     = normvalues .* nonzero;
0619   <span class="keyword">if</span> ~isempty(normvalues_std), normvalues_std = normvalues_std .* nonzero;  <span class="keyword">end</span>
0620 <span class="keyword">end</span>
0621 
0622 <span class="comment">% ----------------------------------------</span>
0623 
0624 <a name="_sub9" href="#_subfunctions" class="code">function this_colorbar(num,colmap)</a>
0625 
0626 colorbar(<span class="string">'off'</span>); colormap(colmap); h = colorbar; nc = size(colmap,1);
0627 this_xtick = 1+ceil([nc-1]*(0:1:length(num)-1)/(length(num)-1));
0628 <span class="comment">%set(h,'Location','SouthOutside');%,'XLim',[1 nc],'XTick',this_xtick,'XTickLabel',[0],'Position', [0.25 0.05 0.50.015]);</span>
0629 set(h,<span class="string">'YLim'</span>,[1 nc],<span class="string">'YTick'</span>,this_xtick,<span class="string">'YTickLabel'</span>,num);
0630 
0631 
0632 <span class="comment">% -------------------------------------------------</span>
0633  
0634 <a name="_sub10" href="#_subfunctions" class="code">function p = netgraph_draw_set_parameters(network,vararg)</a>
0635 
0636 [nm,nr] = size(network.N);
0637 
0638 <span class="comment">% use parameters from network</span>
0639 
0640 <span class="keyword">if</span> isfield(network,<span class="string">'graphics_par'</span>), 
0641   p = network.graphics_par;
0642 <span class="keyword">else</span>
0643   network = <a href="netgraph_make_graph.html" class="code" title="function network = netgraph_make_graph(network,metvalues,actvalues,set_positions,x_init,table_positions);">netgraph_make_graph</a>(network);
0644   p = network.graphics_par;
0645 <span class="keyword">end</span>
0646 
0647 
0648 <span class="comment">% -------------------------</span>
0649 <span class="comment">% use parameters in argument list</span>
0650 
0651 <span class="keyword">if</span> length(vararg),
0652   <span class="keyword">if</span> length(vararg) == 1, 
0653     input_arg = vararg{1};
0654   <span class="keyword">else</span>
0655     input_arg = vararg;    
0656   <span class="keyword">end</span>
0657 
0658 <span class="keyword">switch</span> length(input_arg),
0659   <span class="keyword">case</span> 0,
0660   <span class="keyword">case</span> 1,
0661     <span class="keyword">if</span> isstruct(input_arg),
0662       fn = fieldnames(input_arg);
0663       <span class="keyword">for</span> i=1:length(fn), p=setfield( p, fn{i},getfield(input_arg,fn{i})); <span class="keyword">end</span>
0664     <span class="keyword">end</span>
0665   <span class="keyword">otherwise</span>,
0666     <span class="keyword">for</span> i=1:length(input_arg)/2,
0667       p = setfield( p, input_arg{2*(i-1)+1},input_arg{2*i}); 
0668     <span class="keyword">end</span>
0669 <span class="keyword">end</span>
0670 <span class="keyword">end</span>
0671 
0672 <span class="comment">% -------------------------</span>
0673 <span class="comment">% add missing parameters</span>
0674 
0675 p_default = struct(<span class="keyword">...</span>
0676     <span class="string">'N'</span>,               network.N, <span class="keyword">...</span>
0677     <span class="string">'show_regulation'</span>, 0, <span class="keyword">...</span>
0678     <span class="string">'showsign'</span>,        1, <span class="keyword">...</span>
0679     <span class="string">'omit_zeros'</span>,      0, <span class="keyword">...</span>
0680     <span class="string">'show_metvalues'</span>, 1, <span class="keyword">...</span>
0681     <span class="string">'show_actvalues'</span>, 1, <span class="keyword">...</span>
0682     <span class="string">'show_arrowvalues'</span>, 1, <span class="keyword">...</span>
0683     <span class="string">'show_edgevalues'</span>, 0, <span class="keyword">...</span>
0684     <span class="string">'show_regulationvalues'</span>, 0, <span class="keyword">...</span>
0685     <span class="string">'metvalues_std'</span>,   zeros(size(p.metvalues)),  <span class="keyword">...</span><span class="comment"> </span>
0686     <span class="string">'metvaluesmax'</span>,    [], <span class="keyword">...</span>
0687     <span class="string">'metvaluesmin'</span>,    [], <span class="keyword">...</span>
0688     <span class="string">'metstyle'</span>, <span class="string">'fixed'</span>, <span class="keyword">...</span>
0689     <span class="string">'metcolors'</span>, [], <span class="keyword">...</span>
0690     <span class="string">'actvalues_std'</span>,   zeros(size(p.actvalues)),  <span class="keyword">...</span>
0691     <span class="string">'actvaluesmax'</span>,    [], <span class="keyword">...</span>
0692     <span class="string">'actvaluesmin'</span>,    [], <span class="keyword">...</span>
0693     <span class="string">'actstyle'</span>, <span class="string">'fixed'</span>, <span class="keyword">...</span>
0694     <span class="string">'actcolors'</span>, [], <span class="keyword">...</span>
0695     <span class="string">'omitreactions'</span>,   {<span class="string">'omitthisreaction'</span>}, <span class="keyword">...</span>
0696     <span class="string">'omitmetabolites'</span>, {<span class="string">'omitthismetabolite'</span>}, <span class="keyword">...</span>
0697     <span class="string">'arrowstyle'</span>,      <span class="string">'none'</span>, <span class="keyword">...</span>
0698     <span class="string">'arrowvalues'</span>,     [], <span class="keyword">...</span>
0699     <span class="string">'arrowprintvalues'</span>,   0, <span class="keyword">...</span>
0700     <span class="string">'arrowvaluesmax'</span>,  [], <span class="keyword">...</span>
0701     <span class="string">'arrowvaluesmin'</span>,  [], <span class="keyword">...</span>
0702     <span class="string">'arrow_stoichiometries'</span>, 1, <span class="keyword">...</span>
0703     <span class="string">'arrowvalues_std'</span>,     zeros(size(p.arrowvalues)), <span class="keyword">...</span>
0704     <span class="string">'arrow_shift'</span>,     0.7,  <span class="keyword">...</span>
0705     <span class="string">'arrowcolor'</span>,      [0.7 0.7 0.7],  <span class="keyword">...</span>
0706     <span class="string">'linewidth'</span>, 1, <span class="keyword">...</span>
0707     <span class="string">'single_arrow'</span>, 0, <span class="keyword">...</span>
0708     <span class="string">'edgevalues'</span>,      [],  <span class="keyword">...</span>
0709     <span class="string">'edgevalues_std'</span>,  [], <span class="keyword">...</span>
0710     <span class="string">'edgevaluesmax'</span>,   [], <span class="keyword">...</span>
0711     <span class="string">'edgevaluesmin'</span>,   [], <span class="keyword">...</span>
0712     <span class="string">'edgeprintvalues'</span>,      [],  <span class="keyword">...</span>
0713     <span class="string">'edgestyle'</span>,      <span class="string">'normal'</span>,  <span class="keyword">...</span>
0714     <span class="string">'regulationvalues'</span>,    [],  <span class="keyword">...</span>
0715     <span class="string">'regulationprintvalues'</span>,    [],  <span class="keyword">...</span>
0716     <span class="string">'regulationvalues_std'</span>,[], <span class="keyword">...</span>
0717     <span class="string">'regulationvaluesmax'</span>, [], <span class="keyword">...</span>
0718     <span class="string">'regulationvaluesmin'</span>, [], <span class="keyword">...</span>
0719     <span class="string">'regulationstyle'</span>,      <span class="string">'normal'</span>,  <span class="keyword">...</span>
0720     <span class="string">'hold_on'</span>,         0, <span class="keyword">...</span>
0721     <span class="string">'FontSize'</span>,        8, <span class="keyword">...</span>
0722     <span class="string">'fontangle'</span>,       0, <span class="keyword">...</span>
0723     <span class="string">'YDir'</span>,            <span class="string">'normal'</span>, <span class="keyword">...</span>
0724     <span class="string">'figure_axis'</span>,     [], <span class="keyword">...</span>
0725     <span class="string">'black_and_white'</span>, 0, <span class="keyword">...</span>
0726     <span class="string">'colormap'</span>,        <a href="../.././mnt/utils/rb_colors.html" class="code" title="function c = rb_colors(ncol)">rb_colors</a>(250), <span class="keyword">...</span>
0727     <span class="string">'linecolor'</span>,       [0 0 1], <span class="keyword">...</span>
0728     <span class="string">'rlinecolor'</span>,      [1 .3 0.], <span class="keyword">...</span>
0729     <span class="string">'text_offset'</span>,     [0.01,-0.01], <span class="keyword">...</span>
0730     <span class="string">'straightlines'</span>,   1,       <span class="keyword">...</span>
0731     <span class="string">'arrowsize'</span>,       0.03,        <span class="keyword">...</span>
0732     <span class="string">'figure_position'</span>, [],  <span class="keyword">...</span>
0733     <span class="string">'subplot_position'</span>,[], <span class="keyword">...</span>
0734     <span class="string">'no_points'</span>,       0, <span class="keyword">...</span>
0735     <span class="string">'colorbar'</span>,        0,<span class="keyword">...</span>
0736     <span class="string">'colorbar_numbers'</span>, [],<span class="keyword">...</span>
0737     <span class="string">'flag_edges'</span>, 1 );
0738    
0739 p = <a href="../.././mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>(p_default,p);
0740 
0741 <span class="keyword">if</span> ~isempty(p.edgevalues),       p.show_edgevalues = 1; <span class="keyword">end</span> 
0742 <span class="keyword">if</span> ~isempty(p.regulationvalues), p.show_regulationvalues = 1; <span class="keyword">end</span> 
0743 <span class="keyword">if</span> p.show_regulationvalues,      p.show_regulation = 1; <span class="keyword">end</span> 
0744 
0745 <span class="keyword">if</span> p.arrowprintvalues, p.actprintvalues = 0; <span class="keyword">end</span>
0746 
0747 <span class="comment">% if length(p.metvalues_std)</span>
0748 <span class="comment">%   if sum(p.metvalues_std~=0), p.metstyle = 'box_std';</span>
0749 <span class="comment">%   end</span>
0750 <span class="comment">% end</span>
0751 <span class="comment">%</span>
0752 <span class="comment">% if length(p.actvalues_std)</span>
0753 <span class="comment">%   if sum(p.actvalues_std~=0), p.actstyle = 'box_std';</span>
0754 <span class="comment">%   end</span>
0755 <span class="comment">% end</span>
0756 
0757 
0758 <span class="comment">% ----------</span>
0759 <span class="comment">% correct parameters</span>
0760 
0761 <span class="keyword">switch</span> p.arrowstyle,
0762   <span class="keyword">case</span> <span class="string">'directions'</span>,
0763     p.arrowvalues = ones(length(network.actions),1);
0764     <span class="keyword">if</span> isfield(p,<span class="string">'reaction_mapping'</span>),
0765         p.arrowvalues = ones(max(p.reaction_mapping),1);
0766     <span class="keyword">end</span>  
0767 <span class="keyword">end</span>
0768 
0769 <span class="keyword">if</span> isempty(p.metvalues),          p.show_metvalues = 0; <span class="keyword">end</span>
0770 <span class="keyword">if</span> strcmp(p.metstyle,<span class="string">'none'</span>),     p.show_metvalues = 0; <span class="keyword">end</span>
0771 <span class="keyword">if</span> isempty(p.actvalues),          p.show_actvalues = 0; <span class="keyword">end</span>
0772 <span class="keyword">if</span> strcmp(p.actstyle,<span class="string">'none'</span>),     p.show_actvalues = 0; <span class="keyword">end</span>
0773 <span class="keyword">if</span> isempty(p.arrowvalues),        p.show_arrowvalues = 0; <span class="keyword">end</span>
0774 <span class="keyword">if</span> isempty(p.edgevalues),         p.show_edgevalues = 0; <span class="keyword">end</span>
0775 <span class="keyword">if</span> isempty(p.regulationvalues),   p.show_regulationvalues = 0; <span class="keyword">end</span>
0776 <span class="keyword">if</span> strcmp(p.arrowstyle,<span class="string">'none'</span>),   p.show_arrowvalues = 0; <span class="keyword">end</span>
0777 
0778 <span class="keyword">if</span> p.show_regulationvalues,
0779   <span class="keyword">if</span> isempty(p.regulationvalues_std),
0780     p.regulationvalues_std = zeros(size(p.regulationvalues));
0781   <span class="keyword">end</span>
0782 <span class="keyword">end</span>
0783 
0784 <span class="keyword">if</span> p.show_edgevalues,
0785   <span class="keyword">if</span> isempty(p.edgevalues_std),
0786     p.edgevalues_std = zeros(size(p.edgevalues));
0787   <span class="keyword">end</span>
0788 <span class="keyword">end</span>
0789 
0790 <span class="comment">% ----------</span>
0791 <span class="comment">% split metabolites?</span>
0792 
0793 <span class="keyword">if</span> isfield(p,<span class="string">'metabolite_mapping'</span>),
0794   <span class="keyword">if</span> p.show_metvalues,
0795     p.metvalues       = p.metvalues(p.metabolite_mapping);
0796     p.metvalues_std   = p.metvalues_std(p.metabolite_mapping); 
0797   <span class="keyword">end</span>
0798   <span class="keyword">if</span> p.show_edgevalues,
0799     p.edgevalues     = p.edgevalues(p.metabolite_mapping,:); 
0800     p.edgevalues_std = p.edgevalues_std(p.metabolite_mapping,:); 
0801   <span class="keyword">end</span>
0802   <span class="keyword">if</span> p.show_regulationvalues,
0803     p.regulationvalues     = p.regulationvalues(:,p.metabolite_mapping); 
0804     p.regulationvalues_std = p.regulationvalues_std(:,p.metabolite_mapping); 
0805   <span class="keyword">end</span>
0806 <span class="keyword">end</span>
0807 
0808 <span class="keyword">if</span> isfield(p,<span class="string">'reaction_mapping'</span>),
0809   <span class="keyword">if</span> p.show_actvalues,
0810     p.actvalues       = p.actvalues(p.reaction_mapping);
0811     p.actvalues_std   = p.actvalues_std(p.reaction_mapping);
0812   <span class="keyword">end</span>
0813   <span class="keyword">if</span> p.show_arrowvalues,
0814     p.arrowvalues       = p.arrowvalues(p.reaction_mapping);
0815   <span class="keyword">end</span>
0816   <span class="keyword">if</span> p.show_edgevalues,
0817     p.edgevalues     = p.edgevalues(:,p.reaction_mapping); 
0818     p.edgevalues_std = p.edgevalues_std(:,p.reaction_mapping); 
0819   <span class="keyword">end</span>
0820   <span class="keyword">if</span> p.show_regulationvalues,
0821     p.regulationvalues     = p.regulationvalues(p.reaction_mapping,:); 
0822     p.regulationvalues_std = p.regulationvalues_std(p.reaction_mapping,:); 
0823   <span class="keyword">end</span>
0824 <span class="keyword">end</span>
0825 
0826 <span class="comment">% ---------------------------------------------------------------------</span>
0827 <span class="comment">% showsign = 1  -&gt; normalise all values to values between -1 and 1</span>
0828 <span class="comment">% showsign = 0  -&gt; normalise all values to values between  0 and 1</span>
0829 
0830 <span class="keyword">if</span> p.show_metvalues,
0831   [p.norm_metvalues, p.norm_metvalues_std,p.metvaluesmax,p.metvaluesmin] = <a href="#_sub9" class="code" title="subfunction [normvalues, normvalues_std,valuesmax,valuesmin] = normalise(values,values_std,valuesmax,valuesmin,p);">normalise</a>(p.metvalues,p.metvalues_std,p.metvaluesmax,p.metvaluesmin,p);
0832 <span class="keyword">end</span>
0833 
0834 <span class="keyword">if</span> p.show_actvalues,
0835   [p.norm_actvalues, p.norm_actvalues_std,p.actvaluesmax,p.actvaluesmin] = <a href="#_sub9" class="code" title="subfunction [normvalues, normvalues_std,valuesmax,valuesmin] = normalise(values,values_std,valuesmax,valuesmin,p);">normalise</a>(p.actvalues,p.actvalues_std,p.actvaluesmax,p.actvaluesmin,p);
0836 <span class="keyword">end</span>
0837 
0838 
0839 <span class="keyword">if</span> p.show_arrowvalues,  
0840   p.norm_arrowvalues = p.arrowvalues;
0841   <span class="keyword">if</span> ~isempty(p.arrowvaluesmax),
0842     <span class="keyword">if</span> isempty(p.arrowvaluesmin),
0843       p.arrowvaluesmin = -p.arrowvaluesmax;
0844     <span class="keyword">end</span>
0845     p.norm_arrowvalues(p.norm_arrowvalues&gt;p.arrowvaluesmax) = p.arrowvaluesmax;
0846     p.norm_arrowvalues(p.norm_arrowvalues&lt;p.arrowvaluesmin) = p.arrowvaluesmin;
0847     p.norm_arrowvalues = p.norm_arrowvalues / max(p.arrowvaluesmax, abs(p.arrowvaluesmin));
0848   <span class="keyword">end</span>
0849 <span class="keyword">end</span>
0850 
0851 <span class="keyword">if</span> p.show_edgevalues,
0852   [p.norm_edgevalues, p.norm_edgevalues_std,p.edgevaluesmax,p.edgevaluesmin] = <a href="#_sub9" class="code" title="subfunction [normvalues, normvalues_std,valuesmax,valuesmin] = normalise(values,values_std,valuesmax,valuesmin,p);">normalise</a>(p.edgevalues,p.edgevalues_std,p.edgevaluesmax,p.edgevaluesmin,p); 
0853 <span class="keyword">end</span>
0854 
0855 <span class="keyword">if</span> p.show_regulationvalues,
0856   [p.norm_regulationvalues, p.norm_regulationvalues_std,p.regulationvaluesmax,p.regulationvaluesmin] = <a href="#_sub9" class="code" title="subfunction [normvalues, normvalues_std,valuesmax,valuesmin] = normalise(values,values_std,valuesmax,valuesmin,p);">normalise</a>(p.regulationvalues,p.regulationvalues_std,p.regulationvaluesmax,p.regulationvaluesmin,p);
0857 <span class="keyword">end</span>
0858 
0859 <span class="comment">% --- some more stuff</span>
0860 
0861 <span class="keyword">if</span> p.black_and_white,        p.colormap = 0.5-0.5*sign(gray(250)-0.5); <span class="keyword">end</span>
0862 
0863 <span class="comment">% omit metabolites that are not connected anymore once reactions have been omitted</span>
0864 ll = setdiff(1:nr,<a href="../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(p.omitreactions,network.actions));
0865 p.omitmetabolites = union(p.omitmetabolites, network.metabolites(find(sum(abs(network.N(:,ll)),2)==0)));
0866 
0867 p.actindshow = setdiff(1:length(network.actions),<a href="../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(p.omitreactions,network.actions));
0868 p.metindshow = setdiff(1:length(network.metabolites),<a href="../.././mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(p.omitmetabolites,network.metabolites));
0869 
0870 <span class="comment">% ----------</span>
0871 
0872 <span class="keyword">if</span> isfield(p,<span class="string">'chop_names'</span>),
0873   <span class="keyword">for</span> it = 1:length(p.metnames),
0874     <span class="keyword">if</span> length(p.metnames{it}) &gt; p.chop_names,
0875       p.metnames{it} = [p.metnames{it}(1:p.chop_names) <span class="string">'...'</span>];
0876     <span class="keyword">end</span>
0877   <span class="keyword">end</span>
0878   <span class="keyword">for</span> it = 1:length(p.actnames),
0879     <span class="keyword">if</span> length(p.actnames{it}) &gt; p.chop_names,
0880       p.actnames{it} = [p.actnames{it}(1:p.chop_names) <span class="string">'...'</span> ];
0881     <span class="keyword">end</span>
0882   <span class="keyword">end</span>
0883 <span class="keyword">end</span>
0884 
0885 <span class="keyword">if</span> isfield(p,<span class="string">'split_names'</span>),
0886   <span class="keyword">if</span> p.split_names,
0887   <span class="keyword">for</span> it = 1:length(p.metnames),
0888     p.metnames{it} =  <a href="#_sub8" class="code" title="subfunction name2 = split_name(name,l)">split_name</a>(p.metnames{it},p.split_names);
0889   <span class="keyword">end</span>
0890   <span class="keyword">for</span> it = 1:length(p.actnames),
0891      p.actnames{it} =  <a href="#_sub8" class="code" title="subfunction name2 = split_name(name,l)">split_name</a>(p.actnames{it},p.split_names);
0892   <span class="keyword">end</span>
0893   <span class="keyword">end</span>
0894 <span class="keyword">end</span>
0895 
0896 <span class="keyword">if</span> size(p.x,2) == 0, error(<span class="string">'No point positions found'</span>); <span class="keyword">end</span>
0897</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>