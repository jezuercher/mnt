<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of interaction_network_plot</title>
  <meta name="keywords" content="interaction_network_plot">
  <meta name="description" content="interaction_network_plot(network, reaction_values, reaction_pair_values, col, gp)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">mnt</a> &gt; <a href="index.html">mnt_graphics</a> &gt; interaction_network_plot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mnt/mnt_graphics&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>interaction_network_plot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>interaction_network_plot(network, reaction_values, reaction_pair_values, col, gp)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function interaction_network_plot(network, reaction_values, reaction_pair_values, col, gp) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> interaction_network_plot(network, reaction_values, reaction_pair_values, col, gp)

 Arguments:
 reaction_values       (vector) values for single reactions 
 reaction_pair_values  (matrix) values for pairs of reactions 
                                  only upper triangle values are shown!
 col                   colormap
 gp                    graphics parameters for network, but with extra entries: 
                          gp.show_diagonal_values
                          gp.normalise_values
                          gp.relative_threshold
 
 FOR METABOLITE INTERACTIONS SEE netgraph_metabolite_interactions</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="draw_reaction_arcs.html" class="code" title="function draw_reaction_arcs(network, colors, linewidth)">draw_reaction_arcs</a>	draw_reaction_arcs(network,colors,linewidth)</li><li><a href="netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>	netgraph_concentrations(network,S,J,flag_text,options)</li><li><a href="../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>	c = join_struct(a,b)</li><li><a href="../../mnt/utils/rb_colors.html" class="code" title="function c = rb_colors(ncol)">rb_colors</a>	c = rb_colors(ncol)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function interaction_network_plot(network, reaction_values, reaction_pair_values, col, gp)</a>
0002 
0003 <span class="comment">% interaction_network_plot(network, reaction_values, reaction_pair_values, col, gp)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Arguments:</span>
0006 <span class="comment">% reaction_values       (vector) values for single reactions</span>
0007 <span class="comment">% reaction_pair_values  (matrix) values for pairs of reactions</span>
0008 <span class="comment">%                                  only upper triangle values are shown!</span>
0009 <span class="comment">% col                   colormap</span>
0010 <span class="comment">% gp                    graphics parameters for network, but with extra entries:</span>
0011 <span class="comment">%                          gp.show_diagonal_values</span>
0012 <span class="comment">%                          gp.normalise_values</span>
0013 <span class="comment">%                          gp.relative_threshold</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% FOR METABOLITE INTERACTIONS SEE netgraph_metabolite_interactions</span>
0016 
0017 eval(<a href="../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'col'</span>,<span class="string">'[]'</span>,<span class="string">'gp'</span>,<span class="string">'struct'</span>));
0018 
0019 <span class="keyword">if</span> isempty(col), col = <a href="../../mnt/utils/rb_colors.html" class="code" title="function c = rb_colors(ncol)">rb_colors</a>; <span class="keyword">end</span>
0020 
0021 gp_def = struct(<span class="string">'actprintnames'</span>,0,<span class="string">'metprintnames'</span>,1,<span class="string">'arrowsize'</span>,0.03, <span class="string">'linecolor'</span>,[0 0 0],<span class="string">'arrowcolor'</span>,[.7 .7 .7],<span class="string">'colorbar'</span>,0, <span class="string">'FontSize'</span>,8,<span class="string">'text_offset'</span>,[.01,-.01],<span class="string">'colormap'</span>,col,<span class="string">'hold_on'</span>,1,<span class="string">'linewidth'</span>,2, <span class="string">'show_diagonal_values'</span>,0,<span class="string">'normalise_values'</span>,1,<span class="string">'flag_edges'</span>,1,<span class="string">'relative_threshold'</span>,0);
0022 
0023 gp = <a href="../../mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>(gp_def,gp);
0024 
0025 [nm,nr] = size(network.N);
0026 
0027 <span class="keyword">if</span> isfield(network.graphics_par, <span class="string">'reaction_mapping'</span>),
0028   actmap = network.graphics_par.reaction_mapping;
0029 <span class="keyword">else</span>,
0030   actmap = 1:nr;
0031 <span class="keyword">end</span>
0032 
0033 <span class="comment">%if size(reaction_pair_values,1) ~= max(actmap), error('Wrong matrix size'); end</span>
0034 
0035 <span class="keyword">if</span> gp.show_diagonal_values,
0036   reaction_values = diag(reaction_pair_values);
0037 <span class="keyword">end</span>
0038 
0039 <span class="comment">% normalise by maximal absolute value</span>
0040 <span class="keyword">if</span> gp.normalise_values,
0041   <span class="keyword">if</span> length(isfinite(reaction_values)),
0042     reaction_values = reaction_values/max(abs(reaction_values(actmap)));
0043   <span class="keyword">end</span>
0044   reaction_pair_values = reaction_pair_values - diag(diag(reaction_pair_values));
0045   reaction_pair_values = reaction_pair_values/nanmax(nanmax(abs(reaction_pair_values(actmap,actmap))));
0046 <span class="keyword">end</span>
0047 
0048 <span class="keyword">if</span> gp.relative_threshold,
0049   reaction_pair_values(abs(reaction_pair_values)&lt;gp.relative_threshold*max(abs(reaction_pair_values(:)))) = 0;
0050 <span class="keyword">end</span>
0051 
0052 <span class="comment">% the loop plots only upper triangle values!!</span>
0053 reaction_pair_values = reaction_pair_values';
0054 
0055 <span class="comment">% replace nan by zeros for graphics</span>
0056 reaction_pair_values(isnan(reaction_pair_values)) = 0;
0057 colors = nan * ones(3,nr,nr);
0058 <span class="keyword">for</span> i1 = 1:nr, 
0059   <span class="keyword">for</span> i2 = i1+1:nr,
0060     this_value = reaction_pair_values(actmap(i1),actmap(i2));
0061     <span class="keyword">if</span> isfinite(this_value),  
0062       <span class="keyword">if</span> sign(this_value),  
0063         colors(:,i1,i2) = col(1+floor((size(col,1)-1)*(this_value+1)/2),:);
0064       <span class="keyword">end</span>
0065     <span class="keyword">end</span>
0066   <span class="keyword">end</span>;
0067 <span class="keyword">end</span>
0068 
0069 <span class="keyword">if</span> isfield(gp,<span class="string">'metvalues'</span>),
0070   c = gp.metvalues; 
0071 <span class="keyword">else</span>,
0072   c = [];
0073 <span class="keyword">end</span>
0074 
0075 <a href="netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network,c,reaction_values,1,gp); hold on;
0076 
0077 <a href="draw_reaction_arcs.html" class="code" title="function draw_reaction_arcs(network, colors, linewidth)">draw_reaction_arcs</a>(network,colors,gp.linewidth);  hold on;</pre></div>
<hr><address>Generated on Sun 14-Apr-2013 22:34:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>