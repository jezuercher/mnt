<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of netgraph_movie</title>
  <meta name="keywords" content="netgraph_movie">
  <meta name="description" content="[M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">mnt</a> &gt; <a href="index.html">mnt_graphics</a> &gt; netgraph_movie.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mnt/mnt_graphics&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>netgraph_movie
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>[M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);

 s_t must be #variables x #timepoints !!!

 data_type {'concentrations','reactions','both','compute reactions'}
 default: concentrations

 if 'both' is chosen, then s_t must contain the matrix of concentration 
 time courses and below the matrix of reaction velocity time courses 

 usage: movie(M);

 to save a movie as an animated gif, use movie_save(filename,M)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>	netgraph_concentrations(network,S,J,flag_text,options)</li><li><a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>	v = network_velocities(s,network,kinetics,split,indices,t)</li><li><a href="../../mnt/utils/circle.html" class="code" title="function circle(x,y,r,col)">circle</a>	circle(x,y,r,col)</li><li><a href="../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>	c = join_struct(a,b)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../demo/mnt_demo.html" class="code" title="">mnt_demo</a>	</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% s_t must be #variables x #timepoints !!!</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% data_type {'concentrations','reactions','both','compute reactions'}</span>
0006 <span class="comment">% default: concentrations</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% if 'both' is chosen, then s_t must contain the matrix of concentration</span>
0009 <span class="comment">% time courses and below the matrix of reaction velocity time courses</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% usage: movie(M);</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% to save a movie as an animated gif, use movie_save(filename,M)</span>
0014 
0015 <a name="_sub0" href="#_subfunctions" class="code">function [M,T] = netgraph_movie(network,t,s_t,data_type,n_frames,text_flag,options);</a>
0016 
0017 eval(<a href="../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'options'</span>,<span class="string">'struct'</span>,<span class="string">'data_type'</span>,<span class="string">'''concentrations'''</span>,<span class="string">'n_frames'</span>,<span class="string">'[]'</span>,<span class="string">'text_flag'</span>,<span class="string">'0'</span>,<span class="string">'timebar'</span>,<span class="string">'1'</span>));
0018 
0019 <span class="keyword">if</span> ~exist(<span class="string">'options'</span>,<span class="string">'var'</span>), options = struct; <span class="keyword">end</span>
0020 
0021 options_default = struct(<span class="string">'flux_moves'</span>,0);
0022 <span class="comment">%options = join_struct(options_default, options);</span>
0023 
0024 <span class="keyword">if</span> isempty(n_frames), n_frames = 10; <span class="keyword">end</span>
0025 
0026 t = t-min(t);
0027 
0028 T = max(t)*(0:1/(n_frames-1):1);
0029 
0030 nandata = find(sum(isfinite(s_t),2)==0);
0031 s_t(sum(isfinite(s_t),2)==0,:)=0;
0032 s_t = interp1(t,s_t',T,<span class="string">'cubic'</span>)';
0033 s_t(nandata,:) = nan;
0034 
0035 [nm,nr] = size(network.N);
0036 <span class="keyword">if</span> isfield(network.graphics_par,<span class="string">'reaction_mapping'</span>), 
0037   nr = max(network.graphics_par.reaction_mapping); 
0038   nm = size(s_t,1) - nr;
0039 <span class="keyword">end</span>
0040 <span class="keyword">if</span> isfield(network.graphics_par,<span class="string">'metabolite_mapping'</span>), 
0041   nm = max(network.graphics_par.metabolite_mapping); 
0042 <span class="keyword">end</span>
0043 
0044 metvalues = zeros(nm,length(T));
0045 actvalues = zeros(nr,length(T));
0046 
0047 <span class="keyword">for</span> j = 1:length(T),
0048   <span class="keyword">switch</span> data_type,    
0049     <span class="keyword">case</span> <span class="string">'concentrations'</span>,
0050       metvalues(:,j) = s_t(:,j);
0051       options.actstyle = <span class="string">'none'</span>;
0052     <span class="keyword">case</span> <span class="string">'reactions'</span>,
0053       actvalues(:,j) =  s_t(:,j);
0054       options.metstyle = <span class="string">'none'</span>;
0055     <span class="keyword">case</span> <span class="string">'both'</span>,
0056       metvalues(:,j) = s_t(1:nm,j);
0057       actvalues(:,j) = s_t(nm+1:<span class="keyword">end</span>,j);
0058     <span class="keyword">case</span> <span class="string">'compute reactions'</span>,
0059       metvalues(:,j) = s_t(:,j);
0060       actvalues(:,j) = <a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>(metvalues(:,j),network,network.kinetics);    
0061   <span class="keyword">end</span>
0062 <span class="keyword">end</span>
0063 
0064 jj=j;
0065 
0066 <span class="keyword">if</span> length(metvalues), options_default.metvaluesmax = max(max(metvalues(:)),0.001); <span class="keyword">end</span>
0067 <span class="keyword">if</span> length(actvalues), options_default.actvaluesmax = max(max(actvalues(:)),0.001); <span class="keyword">end</span>
0068 <a href="netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network,metvalues(:,1),actvalues(:,1),0,options_default);
0069 options_default.figure_axis    = axis;
0070 
0071 options_default.actprintvalues = 0;
0072 options_default.metprintvalues = 0; 
0073 options_default.arrowstyle     = <span class="string">'none'</span>;
0074 
0075 options = <a href="../../mnt/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>(options_default,options);
0076 
0077 <span class="keyword">if</span> isfield(options,<span class="string">'timebar'</span>), timebar = options.timebar; <span class="keyword">end</span>
0078 a = axis;
0079 clf;
0080 
0081 <span class="keyword">for</span> j=1:jj,
0082   set(gcf,<span class="string">'Color'</span>,[1 1 1]);
0083   <span class="keyword">if</span> options.flux_moves,
0084     arrow_shift            = mod(options.flux_moves*j,jj)/jj;
0085     options.arrow_shift = arrow_shift;
0086   <span class="keyword">end</span>
0087   <a href="netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network,metvalues(:,j),actvalues(:,j),text_flag,options);
0088 
0089   <span class="keyword">if</span> timebar, 
0090     hold on;  
0091     ss = network.graphics_par.squaresize;
0092     plot([a(1)+ss,a(2)-ss],ss+[a(3),a(3)],<span class="string">'-'</span>,<span class="string">'Color'</span>,[0.4 0.7 1]); 
0093     <a href="../../mnt/utils/circle.html" class="code" title="function circle(x,y,r,col)">circle</a>( a(1) + ss + (j-0.9)/(jj-0.8) *(a(2)-a(1)-2*ss),ss+a(3),ss/2,[0.2 0.5 1]);
0094     <a href="../../mnt/utils/circle.html" class="code" title="function circle(x,y,r,col)">circle</a>( a(1) + ss + (j-0.9)/(jj-0.8) *(a(2)-a(1)-2*ss),ss+a(3),ss/3,[0.4 0.7 1]);
0095   <span class="keyword">end</span>
0096   axis(a);
0097 
0098   M(j) = getframe(gca);
0099 
0100   <span class="keyword">if</span> isfield(options,<span class="string">'prefix'</span>),
0101     <span class="keyword">if</span> j ==1,     print([options.prefix <span class="string">'_start.eps'</span>],<span class="string">'-f1'</span>,<span class="string">'-depsc'</span>); <span class="keyword">end</span>
0102     <span class="keyword">if</span> j == ceil(0.8*jj),    print([options.prefix <span class="string">'_end.eps'</span>],<span class="string">'-f1'</span>,<span class="string">'-depsc'</span>); <span class="keyword">end</span>
0103   <span class="keyword">end</span>
0104 <span class="keyword">end</span>
0105 
0106 <span class="keyword">if</span> isfield(options,<span class="string">'rest_frames'</span>),
0107   M = [ repmat(M(1),1,options.rest_frames), M, repmat(M(end),1,options.rest_frames)];
0108 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 14-Apr-2013 22:34:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>