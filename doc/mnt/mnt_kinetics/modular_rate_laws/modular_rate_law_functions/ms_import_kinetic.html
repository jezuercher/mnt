<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ms_import_kinetic</title>
  <meta name="keywords" content="ms_import_kinetic">
  <meta name="description" content="[kin_data,parameter_prior] = ms_import_kinetic(network,kinetic_balanced_file)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="#">mnt</a> &gt; <a href="#">mnt_kinetics</a> &gt; <a href="#">modular_rate_laws</a> &gt; <a href="#">modular_rate_law_functions</a> &gt; ms_import_kinetic.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt/mnt_kinetics/modular_rate_laws/modular_rate_law_functions&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>ms_import_kinetic
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>[kin_data,parameter_prior] = ms_import_kinetic(network,kinetic_balanced_file)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [kin_data, parameter_prior] = ms_import_kinetic(network,kinetic_balanced_file) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">[kin_data,parameter_prior] = ms_import_kinetic(network,kinetic_balanced_file)

 Read kinetics data file with averaged values
 (referred to by 'kinetic_balanced_file', written by jannis' program), 
 collect all parameters that are useful for a given metabolic network
 and put them into a matlab ms kinetics data structure</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="kin_data_construct.html" class="code" title="function kin_data = kin_data_construct(network)">kin_data_construct</a>	</li><li><a href="../../../.././mnt/mnt_network/network_query/network_numbers.html" class="code" title="function [nr,nm,nx,KM_indices,KA_indices,KI_indices,nKM,nKA,nKI] = network_numbers(network)">network_numbers</a>	[nr,nm,nx,KM_indices,KA_indices,KI_indices,nKM,nKA,nKI] = network_numbers(network)</li><li><a href="../../../.././mnt/mnt_numbers/RT.html" class="code" title="function result = RT(temperature)">RT</a>	result = RT(temperature)</li><li><a href="../../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../../.././mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>	function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [kin_data, parameter_prior] = ms_import_kinetic(network,kinetic_balanced_file)</a>
0002 
0003 <span class="comment">%[kin_data,parameter_prior] = ms_import_kinetic(network,kinetic_balanced_file)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Read kinetics data file with averaged values</span>
0006 <span class="comment">% (referred to by 'kinetic_balanced_file', written by jannis' program),</span>
0007 <span class="comment">% collect all parameters that are useful for a given metabolic network</span>
0008 <span class="comment">% and put them into a matlab ms kinetics data structure</span>
0009 
0010 eval(<a href="../../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'verbose'</span>,<span class="string">'1'</span>));
0011 
0012 <span class="comment">% --------------------------------</span>
0013 <span class="comment">% make empty parameter structure</span>
0014 
0015 [nr,nm,nx,KM_indices,KA_indices,KI_indices,nKM,nKA,nKI] = <a href="../../../.././mnt/mnt_network/network_query/network_numbers.html" class="code" title="function [nr,nm,nx,KM_indices,KA_indices,KI_indices,nKM,nKA,nKI] = network_numbers(network)">network_numbers</a>(network);
0016 
0017 <span class="comment">%data = ncsp_kinetic_data_empty(network);</span>
0018 
0019 <span class="keyword">if</span> length(kinetic_balanced_file),
0020 
0021 list = ncsp_kinetic_data_load_table(kinetic_balanced_file);
0022 
0023 <span class="comment">% --------------------------------</span>
0024 
0025 ind_c   = find(strcmp(<span class="string">'concentration'</span>,              list.QuantityType));
0026 ind_u   = find(strcmp(<span class="string">'concentration of enzyme'</span>,    list.QuantityType));
0027 ind_mu0 = find(strcmp(<span class="string">'standard chemical potential'</span>,list.QuantityType));
0028 ind_Keq = find(strcmp(<span class="string">'equilibrium constant'</span>,       list.QuantityType));
0029 ind_KM  = find(strcmp(<span class="string">'Michaelis constant'</span>,         list.QuantityType));
0030 ind_KA  = find(strcmp(<span class="string">'activation constant'</span>,        list.QuantityType));
0031 ind_KI  = find(strcmp(<span class="string">'inhibitory constant'</span>,        list.QuantityType));
0032 ind_KVp = find(strcmp(<span class="string">'substrate catalytic rate constant'</span>, list.QuantityType));
0033 ind_KVm = find(strcmp(<span class="string">'product catalytic rate constant'</span>,   list.QuantityType));
0034 
0035 [kin_data.log_c.mean,kin_data.log_c.std] = <a href="../../../.././mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>(list.Mean(ind_c),list.Std(ind_c),<span class="string">'arithmetic'</span>);
0036 [kin_data.log_u.mean,kin_data.log_u.std] = <a href="../../../.././mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>(list.Mean(ind_u),list.Std(ind_u),<span class="string">'arithmetic'</span>);
0037 kin_data.mu0.mean             = list.Mean(ind_mu0);
0038 kin_data.mu0.std              = list.Std(ind_mu0);
0039 [kin_data.log_Keq.mean,kin_data.log_Keq.std] = <a href="../../../.././mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>(list.Mean(ind_Keq),list.Std(ind_Keq),<span class="string">'arithmetic'</span>);
0040 kin_data.log_KM.mean             = sparse(nr,nm);
0041 kin_data.log_KA.mean             = sparse(nr,nm);
0042 kin_data.log_KI.mean             = sparse(nr,nm);
0043 kin_data.log_KM.std              = sparse(nr,nm);
0044 kin_data.log_KA.std              = sparse(nr,nm);
0045 kin_data.log_KI.std              = sparse(nr,nm);
0046 [kin_data.log_KM.mean(KM_indices),kin_data.log_KM.std(KM_indices)] = <span class="keyword">...</span>
0047     <a href="../../../.././mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>(list.Mean(ind_KM),list.Std(ind_KM),<span class="string">'arithmetic'</span>);;
0048 [kin_data.log_KA.mean(KA_indices),kin_data.log_KA.std(KA_indices)] = <span class="keyword">...</span>
0049     <a href="../../../.././mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>(list.Mean(ind_KA),list.Std(ind_KA),<span class="string">'arithmetic'</span>);;
0050 [kin_data.log_KI.mean(KI_indices),kin_data.log_KI.std(KI_indices)] = <span class="keyword">...</span>
0051     <a href="../../../.././mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>(list.Mean(ind_KI),list.Std(ind_KI),<span class="string">'arithmetic'</span>);;
0052 
0053 <span class="keyword">else</span> 
0054   kin_data = <a href="kin_data_construct.html" class="code" title="function kin_data = kin_data_construct(network)">kin_data_construct</a>(network);
0055 <span class="keyword">end</span>
0056 
0057 <span class="comment">% ---------------------------------------------------</span>
0058 <span class="comment">% build a structure for the parameter prior based on the kinetic data</span>
0059 <span class="comment">% (this is just a rough guess without proper covariance matrices...)</span>
0060 
0061 [nr,nm,nx,KM_indices,KA_indices,KI_indices,nKM,nKA,nKI] = <a href="../../../.././mnt/mnt_network/network_query/network_numbers.html" class="code" title="function [nr,nm,nx,KM_indices,KA_indices,KI_indices,nKM,nKA,nKI] = network_numbers(network)">network_numbers</a>(network);
0062 
0063 clear parameter_prior;
0064 
0065 parameter_prior.log_c.mean  = kin_data.log_c.mean;
0066 parameter_prior.mu0.mean    = kin_data.mu0.mean;
0067 parameter_prior.mu0.mean(~isfinite(parameter_prior.mu0.mean)) = nan;
0068 parameter_prior.mu0.std     = kin_data.mu0.std;
0069 parameter_prior.log_KM      = kin_data.log_KM;
0070 parameter_prior.log_KA      = kin_data.log_KA;
0071 parameter_prior.log_KI      = kin_data.log_KI;
0072 parameter_prior.log_KV.mean = nan * ones(nr,1);
0073 parameter_prior.log_KV.std  = nan * ones(nr,1);
0074 
0075 unknown_mu0_mean    = nanmean(parameter_prior.mu0.mean);
0076 unknown_mu0_std     = nanstd(parameter_prior.mu0.mean);
0077 
0078 unknown_log_KM_mean = nanmean(parameter_prior.log_KM.mean(KM_indices));
0079 unknown_log_KM_std  = nanstd(parameter_prior.log_KM.mean(KM_indices));
0080 unknown_log_KA_mean = nanmean(parameter_prior.log_KA.mean(KA_indices));
0081 unknown_log_KA_std  = nanstd(parameter_prior.log_KA.mean(KA_indices));
0082 unknown_log_KI_mean = nanmean(parameter_prior.log_KI.mean(KI_indices));
0083 unknown_log_KI_std  = nanstd(parameter_prior.log_KI.mean(KI_indices));
0084 unknown_log_KV_mean = nanmean(parameter_prior.log_KV.mean);
0085 unknown_log_KV_std  = nanstd(parameter_prior.log_KV.mean);
0086 
0087 <span class="keyword">if</span> isnan(unknown_log_KM_mean), unknown_log_KM_mean = 0;  unknown_log_KM_std = log(10^3); <span class="keyword">end</span> 
0088 <span class="keyword">if</span> isnan(unknown_log_KA_mean), unknown_log_KA_mean = 0;  unknown_log_KA_std = log(10^3); <span class="keyword">end</span> 
0089 <span class="keyword">if</span> isnan(unknown_log_KI_mean), unknown_log_KI_mean = 0;  unknown_log_KI_std = log(10^3); <span class="keyword">end</span> 
0090 <span class="keyword">if</span> isnan(unknown_log_KV_mean), unknown_log_KV_mean = 0;  unknown_log_KV_std = log(10^5); <span class="keyword">end</span> 
0091 
0092 parameter_prior.log_c.std   = kin_data.log_c.std;
0093 
0094 parameter_prior.mu0.std(isnan(parameter_prior.mu0.mean))  = unknown_mu0_std;
0095 parameter_prior.mu0.mean(isnan(parameter_prior.mu0.mean)) = unknown_mu0_mean;
0096 
0097 parameter_prior.log_KM.std(isnan(parameter_prior.log_KM.mean))  = unknown_log_KM_std;
0098 parameter_prior.log_KM.mean(isnan(parameter_prior.log_KM.mean)) = unknown_log_KM_mean;
0099 parameter_prior.log_KA.std(isnan(parameter_prior.log_KA.mean))  = unknown_log_KA_std;
0100 parameter_prior.log_KA.mean(isnan(parameter_prior.log_KA.mean)) = unknown_log_KA_mean;
0101 parameter_prior.log_KI.std(isnan(parameter_prior.log_KI.mean))  = unknown_log_KI_std;
0102 parameter_prior.log_KI.mean(isnan(parameter_prior.log_KI.mean)) = unknown_log_KI_mean;
0103 parameter_prior.log_KV.std(isnan(parameter_prior.log_KV.mean))  = unknown_log_KV_std;
0104 parameter_prior.log_KV.mean(isnan(parameter_prior.log_KV.mean)) = unknown_log_KV_mean;
0105 
0106 parameter_prior.mu0.cov  = diag(parameter_prior.mu0.std.^2);
0107 
0108 parameter_prior.log_Keq.mean = -network.N' * parameter_prior.mu0.mean/<a href="../../../.././mnt/mnt_numbers/RT.html" class="code" title="function result = RT(temperature)">RT</a>;
0109 parameter_prior.log_Keq.cov  = [1/RT^2] * network.N' * parameter_prior.mu0.cov * network.N;
0110 parameter_prior.log_Keq.std  = sqrt(diag(parameter_prior.log_Keq.cov));</pre></div>
<hr><address>Generated on Sat 15-Nov-2014 18:05:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>