<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of parameter_balancing_kinetic</title>
  <meta name="keywords" content="parameter_balancing_kinetic">
  <meta name="description" content="[r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">mnt</a> &gt; <a href="../index.html">mnt_parameter_balancing</a> &gt; <a href="index.html">parameter_balancing_utils</a> &gt; parameter_balancing_kinetic.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mnt/mnt_parameter_balancing/parameter_balancing_utils&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>parameter_balancing_kinetic
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>[r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);

 Convenience function for using parameter balancing to obtain 
 sensible kinetic constants, possibly given the equilibrium constants of a system
 
 The code assumes that the network structure contains KEGG IDs and uses
 SBtab data files supplied that can contain data on 'standard chemical potential',
 'Michaelis constant', 'activation constant',  'inhibitory constant','equilibrium constant',
 'substrate catalytic rate constant', 'product catalytic rate constant'
 or some of these

 The standard reaction directions in the model have to follow the convention in KEGG!!!!</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../mnt/mnt_data_integration/data_integration_bounds_pseudovalues.html" class="code" title="function kinetic_data = data_integration_bounds_pseudovalues(kinetic_data,quantity_info,flag_pseudo_values,network,verbose)">data_integration_bounds_pseudovalues</a>	kinetic_data = data_integration_bounds_pseudovalues(kinetic_data,quantity_info,flag_pseudo_values,network);</li><li><a href="../../../mnt/mnt_data_integration/data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)">data_integration_load_kinetic_data</a>	kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)</li><li><a href="../../../mnt/mnt_data_integration/data_integration_load_quantity_info.html" class="code" title="function quantity_info = data_integration_load_quantity_info(omit_quantities,quantity_info_filename)">data_integration_load_quantity_info</a>	quantity_info = data_integration_load_quantity_info(omit_quantities,quantity_info_filename)</li><li><a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>	netgraph_concentrations(network,S,J,flag_text,options)</li><li><a href="../../../mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>	kinetics = set_kinetics(network,type,parameters)</li><li><a href="../../../mnt/mnt_parameter_balancing/parameter_balancing.html" class="code" title="function [res, exitflag] = parameter_balancing(task, quantity_info, options)">parameter_balancing</a>	[res, exitflag] = parameter_balancing(task, quantity_info, options)</li><li><a href="../../../mnt/mnt_parameter_balancing/parameter_balancing_task.html" class="code" title="function [task, prior] = parameter_balancing_task(network, kinetic_data, quantity_info, model_quantities, basic_quantities)">parameter_balancing_task</a>	Prepare vectors and matrices for parameter balancing</li><li><a href="parameter_balancing_kinetic.html" class="code" title="function [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);">parameter_balancing_kinetic</a>	[r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);</li><li><a href="../../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="parameter_balancing_kinetic.html" class="code" title="function [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);">parameter_balancing_kinetic</a>	[r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);</a>
0002 
0003 <span class="comment">% [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Convenience function for using parameter balancing to obtain</span>
0006 <span class="comment">% sensible kinetic constants, possibly given the equilibrium constants of a system</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% The code assumes that the network structure contains KEGG IDs and uses</span>
0009 <span class="comment">% SBtab data files supplied that can contain data on 'standard chemical potential',</span>
0010 <span class="comment">% 'Michaelis constant', 'activation constant',  'inhibitory constant','equilibrium constant',</span>
0011 <span class="comment">% 'substrate catalytic rate constant', 'product catalytic rate constant'</span>
0012 <span class="comment">% or some of these</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% The standard reaction directions in the model have to follow the convention in KEGG!!!!</span>
0015 
0016 eval(<a href="../../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'filename'</span>,<span class="string">'[]'</span>, <span class="string">'Keq_given'</span>,<span class="string">'[]'</span>));
0017 
0018 <span class="keyword">if</span> 0,
0019 
0020   <span class="comment">%% ---------</span>
0021   <span class="comment">%% example</span>
0022 
0023   model_name = <span class="string">'ecoli_glycolysis'</span>;
0024   filenames  = pathway_modelling_filenames(model_name);
0025   load(filenames.network_file);
0026   filename = {<span class="string">'~/projekte/pathway_modelling/data/GFEformation_flamholz_2011_millimolar.tsv'</span>, <span class="keyword">...</span>
0027               <span class="string">'~/projekte/pathway_modelling/data/kinetic_constants_brenda.tsv'</span>};
0028   kinetic_data = [];
0029   
0030   <span class="comment">%% kinetic_data = data_integration_load_kinetic_data({'standard chemical potential','Michaelis constant', 'activation constant',  'inhibitory constant','equilibrium constant','substrate catalytic rate constant', 'product catalytic rate constant'}, [], network,  filename, 0, 1);</span>
0031   <span class="comment">%filename = [];</span>
0032   Keq_given = [];
0033 
0034  [r,r_orig,kinetic_data] = <a href="parameter_balancing_kinetic.html" class="code" title="function [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);">parameter_balancing_kinetic</a>(network, kinetic_data, filename, Keq_given);
0035 
0036   gp               = struct(<span class="string">'arrowsize'</span>,0.1,<span class="string">'actstyle'</span>,<span class="string">'none'</span>,<span class="string">'actprintnames'</span>,0,<span class="string">'flag_edges'</span>,1);
0037   gp.actstyle      =<span class="string">'none'</span>; 
0038   gp.arrowsize     = 0.05;
0039   gp.arrowstyle=<span class="string">'none'</span>; gp.actstyle = <span class="string">'fixed'</span>;
0040 
0041   figure(1); clf; <a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network_CoHid,[],r.Keq,1,gp); title(<span class="string">'Balanced: Equilibrium constants'</span>);
0042   figure(2); clf; <a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network_CoHid,r.mu0,[],1,gp); title(<span class="string">'Balanced: Standard chemical potentials'</span>);
0043   figure(3); clf; <a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network_CoHid,[],r.KV,1,gp); title(<span class="string">'Balanced: Velocity constants'</span>);
0044   gp.edgevalues = r.KM';  gp.edgestyle=<span class="string">'fixed'</span>; 
0045   figure(4); clf; <a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network_CoHid,[],[],1,gp); title(<span class="string">'Balanced: Michaelis constants'</span>);
0046 
0047   gp.edgevalues = [];; 
0048   figure(11); clf; <a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network_CoHid,[],r_orig.Keq,1,gp); title(<span class="string">'Data: Equilibrium constants'</span>);
0049   figure(12); clf; <a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network_CoHid,r_orig.mu0,[],1,gp); title(<span class="string">'Data: Standard chemical potentials'</span>);
0050   gp.edgevalues = r_orig.KM';  gp.edgestyle=<span class="string">'fixed'</span>; 
0051   figure(14); clf; <a href="../../../mnt/mnt_graphics/netgraph_concentrations.html" class="code" title="function netgraph_concentrations(network,S,J,flag_text,options)">netgraph_concentrations</a>(network_CoHid,[],[],1,gp); title(<span class="string">'Data: Michaelis constants'</span>);
0052 
0053 <span class="keyword">end</span>
0054 
0055 <span class="keyword">if</span> isempty(kinetic_data),
0056   kinetic_data = <a href="../../../mnt/mnt_data_integration/data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)">data_integration_load_kinetic_data</a>({<span class="string">'standard chemical potential'</span>,<span class="string">'Michaelis constant'</span>, <span class="keyword">...</span>
0057                       <span class="string">'activation constant'</span>,  <span class="string">'inhibitory constant'</span>,<span class="string">'equilibrium constant'</span>,<span class="keyword">...</span>
0058                       <span class="string">'substrate catalytic rate constant'</span>, <span class="string">'product catalytic rate constant'</span>}, <span class="keyword">...</span>
0059                                                     [], network,  filename, 0, 1);
0060 <span class="keyword">end</span>  
0061 
0062 [nm,nr] = size(network.N);
0063 
0064 
0065 <span class="comment">% ------------------------------------------------------------------------</span>
0066 <span class="comment">% Determine consistent parameter set by parameter balancing</span>
0067 
0068 quantity_info     = <a href="../../../mnt/mnt_data_integration/data_integration_load_quantity_info.html" class="code" title="function quantity_info = data_integration_load_quantity_info(omit_quantities,quantity_info_filename)">data_integration_load_quantity_info</a>;
0069 model_quantities  = {<span class="string">'standard chemical potential'</span>,<span class="string">'catalytic rate constant geometric mean'</span>, <span class="string">'Michaelis constant'</span>,<span class="string">'activation constant'</span>, <span class="string">'inhibitory constant'</span>, <span class="string">'equilibrium constant'</span>,<span class="string">'substrate catalytic rate constant'</span>, <span class="string">'product catalytic rate constant'</span>
0070 }';
0071 data_quantities   = {<span class="string">'standard chemical potential'</span>,<span class="string">'Michaelis constant'</span>,<span class="string">'activation constant'</span>, <span class="string">'inhibitory constant'</span>, <span class="string">'equilibrium constant'</span>,<span class="string">'substrate catalytic rate constant'</span>, <span class="string">'product catalytic rate constant'</span>
0072 }';
0073 basic_quantities  = {<span class="string">'standard chemical potential'</span>,<span class="string">'catalytic rate constant geometric mean'</span>, <span class="string">'Michaelis constant'</span>,<span class="string">'activation constant'</span>, <span class="string">'inhibitory constant'</span>}';
0074 
0075 my_kinetic_data = <a href="../../../mnt/mnt_data_integration/data_integration_bounds_pseudovalues.html" class="code" title="function kinetic_data = data_integration_bounds_pseudovalues(kinetic_data,quantity_info,flag_pseudo_values,network,verbose)">data_integration_bounds_pseudovalues</a>(kinetic_data,quantity_info,1,network);
0076 
0077 <span class="keyword">if</span> length(Keq_given),
0078   ind_finite = find(isfinite(Keq_given));
0079   my_kinetic_data.Keq.median(ind_finite) = Keq_given(ind_finite);
0080   my_kinetic_data.Keq.mean(ind_finite)   = Keq_given(ind_finite);
0081   my_kinetic_data.Keq.std(ind_finite)    = 0.001 * Keq_given(ind_finite);
0082   my_kinetic_data.Keq.mean_ln(ind_finite) = log(Keq_given(ind_finite));
0083   my_kinetic_data.Keq.std_ln  = log(1+  my_kinetic_data.Keq.std(ind_finite));
0084 <span class="keyword">end</span>
0085 
0086 network.kinetics = <a href="../../../mnt/mnt_kinetics/kinetics/set_kinetics.html" class="code" title="function kinetics = set_kinetics(network,type,parameters)">set_kinetics</a>(network, <span class="string">'cs'</span>);
0087 task = <a href="../../../mnt/mnt_parameter_balancing/parameter_balancing_task.html" class="code" title="function [task, prior] = parameter_balancing_task(network, kinetic_data, quantity_info, model_quantities, basic_quantities)">parameter_balancing_task</a>(network, my_kinetic_data, quantity_info, model_quantities, basic_quantities);
0088 res  = <a href="../../../mnt/mnt_parameter_balancing/parameter_balancing.html" class="code" title="function [res, exitflag] = parameter_balancing(task, quantity_info, options)">parameter_balancing</a>(task, quantity_info, struct(<span class="string">'insert_pseudo_values'</span>,0));
0089 
0090 r.mu0   = res.kinetics_posterior_mode.mu0  ;
0091 r.KV    = res.kinetics_posterior_mode.KV   ;
0092 r.KM    = res.kinetics_posterior_mode.KM   ;
0093 r.KA    = res.kinetics_posterior_mode.KA   ;
0094 r.KI    = res.kinetics_posterior_mode.KI   ;
0095 r.Keq   = res.kinetics_posterior_mode.Keq  ;
0096 r.Kcatf = res.kinetics_posterior_mode.Kcatf;
0097 r.Kcatr = res.kinetics_posterior_mode.Kcatr;
0098 
0099 r_orig.mu0   = kinetic_data.mu0.median  ;
0100 r_orig.KM    = kinetic_data.KM.median   ;
0101 r_orig.KA    = kinetic_data.KA.median   ;
0102 r_orig.KI    = kinetic_data.KI.median   ;
0103 r_orig.Keq   = kinetic_data.Keq.median  ;
0104 <span class="keyword">if</span> length(Keq_given),
0105   r_orig.Keq(ind_finite) = Keq_given(ind_finite);
0106 <span class="keyword">end</span>
0107 r_orig.Kcatf = kinetic_data.Kcatf.median;
0108 r_orig.Kcatr = kinetic_data.Kcatr.median;</pre></div>
<hr><address>Generated on Wed 10-Apr-2013 10:42:33 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>