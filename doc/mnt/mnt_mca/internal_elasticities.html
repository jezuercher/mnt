<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of internal_elasticities</title>
  <meta name="keywords" content="internal_elasticities">
  <meta name="description" content="epsilon = internal_elasticities(network,s,enzyme_factor,relevant_parameters);">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">mnt</a> &gt; <a href="index.html">mnt_mca</a> &gt; internal_elasticities.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mnt/mnt_mca&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>internal_elasticities
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>epsilon = internal_elasticities(network,s,enzyme_factor,relevant_parameters);</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [epsilon,epsilonP,parameters] = internal_elasticities(network,s,enzyme_factor,relevant_parameters); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">epsilon = internal_elasticities(network,s,enzyme_factor,relevant_parameters);

Matrix of first order reaction elasticities w.r.t. internal
metabolites, numerical computation

IMPORTANT: this function uses the elements of 'regulation_matrix'


FUNCTION ARGUMENTS:
  network     network structure (type 'help network_structure')
  s           column vector of metabolite concentrations</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>	v = network_velocities(s,network,kinetics,split,indices,t)</li><li><a href="../../mnt/mnt_kinetics/kinetics/parameters2vector.html" class="code" title="function [vector,names,relevant,relevant_reactions,types] = parameters2vector(kinetics,S_ext,S_ext_names,network,split,no_names)">parameters2vector</a>	[vector,names,relevant,relevant_reactions,types] = parameters2vector(kinetics,S_ext,S_ext_names,network,split,no_names)</li><li><a href="../../mnt/mnt_kinetics/kinetics/vector2parameters.html" class="code" title="function [kinetics,S_ext] = vector2parameters(kinetics,vector,external_ind,network)">vector2parameters</a>	[kinetics,S_ext] = vector2parameters(kinetics,vector,external_ind,network)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%epsilon = internal_elasticities(network,s,enzyme_factor,relevant_parameters);</span>
0002 <span class="comment">%</span>
0003 <span class="comment">%Matrix of first order reaction elasticities w.r.t. internal</span>
0004 <span class="comment">%metabolites, numerical computation</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%IMPORTANT: this function uses the elements of 'regulation_matrix'</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%FUNCTION ARGUMENTS:</span>
0010 <span class="comment">%  network     network structure (type 'help network_structure')</span>
0011 <span class="comment">%  s           column vector of metabolite concentrations</span>
0012 
0013 <a name="_sub0" href="#_subfunctions" class="code">function [epsilon,epsilonP,parameters] = internal_elasticities(network,s,enzyme_factor,relevant_parameters);</a>
0014 
0015 delta = 0.00001;
0016 
0017 <span class="keyword">if</span> ~exist(<span class="string">'enzyme_factor'</span>,<span class="string">'var'</span>),                     enzyme_factor = ones(size(network.actions)); <span class="keyword">end</span>
0018 <span class="keyword">if</span> ~isfield(network,<span class="string">'regulation_matrix'</span>), network.regulation_matrix = zeros(size(network.N))'; <span class="keyword">end</span>
0019 
0020 internal = find(network.external ==0);
0021 n_A = length(network.actions);
0022     
0023 v   = <a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>(s,network,network.kinetics);
0024 
0025 <span class="comment">% --------------------------------------------------------------------------</span>
0026 <span class="comment">% compute substrate elasticities</span>
0027 
0028 epsilon = sparse(zeros(n_A,length(internal)));
0029 
0030 <span class="keyword">for</span> i=1:length(internal),
0031   s_pert = s; s_pert(internal(i)) = s(internal(i))*(1+delta);
0032   <span class="keyword">if</span> s_pert(internal(i))==0, s_pert(internal(i))=10^-6; <span class="keyword">end</span>
0033   relevant_reactions = find( network.N(internal(i),:)~=0 + network.regulation_matrix(:,internal(i))'~=0);
0034   v_pert = <a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>(s_pert,network,network.kinetics,0,relevant_reactions);
0035   epsilon(relevant_reactions,i) = (v_pert-v(relevant_reactions))/(s_pert(internal(i))-s(internal(i)));
0036 <span class="keyword">end</span>
0037 
0038 epsilon = diag(sparse(enzyme_factor))*epsilon;
0039 
0040 <span class="comment">% --------------------------------------------------------------------------</span>
0041 <span class="comment">% compute parameter elasticities</span>
0042 
0043 <span class="keyword">if</span> nargout&gt;1,
0044 
0045   S_ext = s(find(network.external));
0046   S_ext_names = network.metabolites(find(network.external));
0047   [par,parameters,relevant,rel_reactions] = <a href="../../mnt/mnt_kinetics/kinetics/parameters2vector.html" class="code" title="function [vector,names,relevant,relevant_reactions,types] = parameters2vector(kinetics,S_ext,S_ext_names,network,split,no_names)">parameters2vector</a>(network.kinetics,S_ext,S_ext_names,network);
0048   <span class="keyword">if</span> ~exist(<span class="string">'relevant_parameters'</span>,<span class="string">'var'</span>),
0049     n_par = length(par);   
0050     relevant_parameters = 1:n_par;
0051   <span class="keyword">end</span>
0052  
0053   n_par = length(relevant_parameters);
0054   epsilonP = sparse(zeros(n_A,n_par));
0055   n_ext = sum(network.external);
0056   external_ind = find(network.external);
0057   s_pert             = s;
0058   ind_external = find(network.external);
0059   clear par_pert;
0060   
0061   <span class="keyword">if</span> strcmp(network.kinetics.type,<span class="string">'standard'</span>),
0062 
0063     clear  kinetics_npars reaction_pars
0064     <span class="keyword">for</span> it = 1:length(network.kinetics.reactions),  
0065       kinetics_npars(it) = sum(network.kinetics.reactions{it}.sizes);
0066     <span class="keyword">end</span>
0067     offsets = [0 cumsum(kinetics_npars)];
0068     <span class="keyword">for</span> it = 1:length(network.kinetics.reactions),  
0069       reaction_pars{it} = par(offsets(it)+1:offsets(it+1));
0070     <span class="keyword">end</span>
0071     
0072     <span class="keyword">for</span> i=1:n_par-length(S_ext),
0073       par_pert = par(i)*(1+delta);     
0074       <span class="keyword">if</span> par_pert==0, par_pert = 10^-6; <span class="keyword">end</span>
0075       [nkinetics,rnum] = vectorchange2standard_kinetics(network.kinetics,i,offsets,reaction_pars,par_pert);
0076       v_pert    = <a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>(s_pert,network,nkinetics,0,rel_reactions{i});
0077       epsilonP(rel_reactions{i},i) = (v_pert-v(rel_reactions{i}))/(par_pert-par(i));
0078     <span class="keyword">end</span>
0079 
0080     of = n_par-length(S_ext);
0081     
0082     <span class="keyword">for</span> i=1:length(S_ext),
0083       par_pert = S_ext(i)*(1+delta);     
0084       <span class="keyword">if</span> par_pert==0, par_pert = 10^-6; <span class="keyword">end</span>
0085       s_pert(ind_external(i))  = par_pert;
0086       v_pert                   = <a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>(s_pert,network,nkinetics,0,rel_reactions{i+of});
0087       epsilonP(rel_reactions{i+of},i+of) = (v_pert-v(rel_reactions{i+of}))/(par_pert-par(i+of));
0088       s_pert(ind_external(i))  = S_ext(i);
0089     <span class="keyword">end</span>
0090     
0091   <span class="keyword">else</span>,
0092     
0093     <span class="keyword">for</span> i=1:n_par,
0094 <span class="comment">%    fprintf('%d ',i)</span>
0095       par_pert(i) = par(i)*(1+delta);     
0096       <span class="keyword">if</span> par_pert(i)==0, par_pert(i) = 10^-6; <span class="keyword">end</span>
0097       [nkinetics,Sext_pert] = <a href="../../mnt/mnt_kinetics/kinetics/vector2parameters.html" class="code" title="function [kinetics,S_ext] = vector2parameters(kinetics,vector,external_ind,network)">vector2parameters</a>(network.kinetics,par_pert,external_ind);
0098       s_pert(ind_external) = Sext_pert;
0099       v_pert               = <a href="../../mnt/mnt_kinetics/kinetics/network_velocities.html" class="code" title="function v = network_velocities(s, network, kinetics, split, indices,t)">network_velocities</a>(s_pert,network,nkinetics,0,rel_reactions{i});
0100       epsilonP(rel_reactions{i},i) = (v_pert-v(rel_reactions{i}))/(par_pert(i)-par(i));
0101       par_pert(i) = par(i);     
0102   <span class="keyword">end</span>
0103   
0104 <span class="keyword">end</span>
0105 
0106 <span class="comment">%  fprintf('\n')</span>
0107   epsilonP = diag(sparse(enzyme_factor))*epsilonP;
0108 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 14-Apr-2013 22:34:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>