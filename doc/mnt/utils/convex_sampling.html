<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of convex_sampling</title>
  <meta name="keywords" content="convex_sampling">
  <meta name="description" content="[x, x_lower. x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling(A_ineq,b_ineq,A_eq,b_eq,n_sample,xl,xu);">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">mnt</a> &gt; <a href="index.html">utils</a> &gt; convex_sampling.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mnt/utils&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>convex_sampling
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>[x, x_lower. x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling(A_ineq,b_ineq,A_eq,b_eq,n_sample,xl,xu);</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [x, x_lower, x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling(A_ineq,b_ineq,A_eq,b_eq,n_sample,xl,xu,verbose,method,options) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [x, x_lower. x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling(A_ineq,b_ineq,A_eq,b_eq,n_sample,xl,xu);

 Uniform sampling of column vectors x in convex polytope
 The polytope is defined by 

 A_ineq * x &lt;= b_ineq
   A_eq * x = b_eq
    xl &lt;= x &lt;= xu

 method = 'rejection'   (default, no 'options' argument needed)
          'hit-and-run' ( options in data structure 'options', see convex_sampling_hit_and_run)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="convex_sampling_rejection_no_eq.html" class="code" title="function [x, x_lower, x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling_rejection_no_eq(A_ineq,b_ineq,n_sample,xl,xu,verbose,options)">convex_sampling_rejection_no_eq</a>	[x, x_lower. x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling_rejection_no_eq(A_ineq,b_ineq,A_eq,b_eq,n_sample,xl,xu,verbose,options);</li><li><a href="default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../mnt/mnt_fluxes/flux_sampling/sample_feasible_mu.html" class="code" title="function [mu, success_flag] = sample_feasible_mu(N,ind_ext,v,constraints,options,method,n_sample)">sample_feasible_mu</a>	[mu, success_flag] = sample_feasible_mu(N,ind_ext,v,constraints,options,method,n_sample)</li><li><a href="../../mnt/mnt_parameter_balancing/parameter_balancing_utils/parameter_balancing_constrained_sampling.html" class="code" title="function [q_sample, xmodel_sample, xdata_sample, kinetics_sample, v_sample, q_min, q_max] = parameter_balancing_constrained_sampling(task,res,options,quantity_info)">parameter_balancing_constrained_sampling</a>	</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [x, x_lower, x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling(A_ineq,b_ineq,A_eq,b_eq,n_sample,xl,xu,verbose,method,options)</a>
0002 
0003 <span class="comment">% [x, x_lower. x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling(A_ineq,b_ineq,A_eq,b_eq,n_sample,xl,xu);</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Uniform sampling of column vectors x in convex polytope</span>
0006 <span class="comment">% The polytope is defined by</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% A_ineq * x &lt;= b_ineq</span>
0009 <span class="comment">%   A_eq * x = b_eq</span>
0010 <span class="comment">%    xl &lt;= x &lt;= xu</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% method = 'rejection'   (default, no 'options' argument needed)</span>
0013 <span class="comment">%          'hit-and-run' ( options in data structure 'options', see convex_sampling_hit_and_run)</span>
0014 
0015 eval(<a href="default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'n_sample'</span>,<span class="string">'1'</span>,<span class="string">'A_eq'</span>,<span class="string">'[]'</span>,<span class="string">'b_eq'</span>,<span class="string">'[]'</span>,<span class="string">'xl'</span>,<span class="string">'[]'</span>,<span class="string">'xu'</span>,<span class="string">'[]'</span>,<span class="string">'verbose'</span>,<span class="string">'0'</span>,<span class="string">'method'</span>,<span class="string">'''rejection'''</span>,<span class="string">'options'</span>,<span class="string">'struct'</span>));
0016 
0017 <span class="comment">% --------------------------------------------------------------------------</span>
0018 <span class="comment">% remove equality constraints -&gt; projection to subspace</span>
0019 
0020 <span class="comment">% Remove equality constraints:</span>
0021 <span class="comment">% Set x = K * y + pinv(A_eq) * b_eq  where K is a complete kernel matrix of A_eq</span>
0022 <span class="comment">% -&gt; equality constraints are automatically satisfied</span>
0023 <span class="comment">% -&gt; inequalities now read:</span>
0024 <span class="comment">%      A_ineq * (K * y + pinv(A_eq) * b_eq) &lt;= b_ineq</span>
0025 <span class="comment">% &lt;=&gt; [A_ineq * K] * y &lt; [b_ineq - A_ineq * pinv(A_eq) * b_eq]</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% lower and upper bounds become inequality constraints:</span>
0028 <span class="comment">%      xl &lt;= K * y + pinv(A_eq) * b_eq &lt;= xu</span>
0029 <span class="comment">% &lt;=&gt;  xl &lt;= K * y + pinv(A_eq) * b_eq</span>
0030 <span class="comment">%            K * y + pinv(A_eq) * b_eq &lt;= xu</span>
0031 <span class="comment">% &lt;=&gt; - K * y &lt;= -[xl - pinv(A_eq) * b_eq]</span>
0032 <span class="comment">%       K * y &lt;= xu - pinv(A_eq) * b_eq</span>
0033 
0034 x       = [];
0035 flag_eq = 0;
0036 
0037 <span class="keyword">if</span> length(A_eq),
0038   
0039   flag_eq = 1;
0040   Aeq_inv = pinv(full(A_eq));
0041   K       = null(full(A_eq));
0042   <span class="keyword">if</span> length(b_ineq),
0043     b_ineq  = b_ineq - A_ineq * Aeq_inv * b_eq;
0044     A_ineq  = A_ineq * K;
0045   <span class="keyword">end</span>
0046   <span class="keyword">if</span> length(xl), 
0047     b_ineq = [ b_ineq; -xl+Aeq_inv*b_eq; xu - Aeq_inv*b_eq];
0048     A_ineq = [ A_ineq; -K; K];
0049     xl     = [];
0050     xu     = [];
0051   <span class="keyword">end</span>
0052   <span class="keyword">if</span> isfield(options,<span class="string">'x_mean'</span>),
0053     <span class="keyword">if</span> length(options.x_mean),
0054       options.x_mean = pinv(K) * [options.x_mean - Aeq_inv * b_eq];
0055       options.x_cov  = pinv(K) * options.x_cov * pinv(K');
0056     <span class="keyword">end</span>
0057   <span class="keyword">end</span>
0058   <span class="keyword">if</span> isfield(options,<span class="string">'x_start'</span>),
0059     <span class="keyword">if</span> length(options.x_start),
0060       options.x_start = pinv(K) * [options.x_start - Aeq_inv * b_eq];
0061     <span class="keyword">end</span>
0062   <span class="keyword">end</span>
0063 
0064   
0065 <span class="keyword">else</span>,
0066 
0067   <span class="keyword">if</span> length(xl), 
0068     nx     = length(xl);
0069     b_ineq = [ b_ineq;  -xl; xu];
0070     A_ineq = [ A_ineq; -eye(nx); eye(nx)];
0071     xl     = [];
0072     xu     = [];
0073   <span class="keyword">end</span>
0074 
0075 <span class="keyword">end</span>
0076 
0077 <span class="comment">% --------------------------------------------------------------------------</span>
0078 <span class="comment">% run sampling without equality constraints</span>
0079 
0080 <span class="keyword">switch</span> method,
0081   <span class="keyword">case</span> <span class="string">'rejection'</span>,
0082     [x, x_lower, x_upper, success_flag, x_lower_list, x_upper_list] = <a href="convex_sampling_rejection_no_eq.html" class="code" title="function [x, x_lower, x_upper, success_flag, x_lower_list, x_upper_list] = convex_sampling_rejection_no_eq(A_ineq,b_ineq,n_sample,xl,xu,verbose,options)">convex_sampling_rejection_no_eq</a>(A_ineq,b_ineq,n_sample,xl,xu,verbose,options);
0083   <span class="keyword">case</span> <span class="string">'hit-and-run'</span>,
0084     [x, x_lower, x_upper, x_lower_list, x_upper_list] = convex_sampling_hit_and_run(A_ineq, b_ineq, xl, xu, options.x_mean, options.x_cov, n_sample, options.n_warm, options.n_pick, options.flag_artificial_centering, options.x_start);
0085 <span class="keyword">end</span>
0086 
0087 
0088 <span class="comment">% --------------------------------------------------------------------------</span>
0089 <span class="comment">% equality constraints -&gt; project backto full space</span>
0090 
0091 <span class="keyword">if</span> flag_eq,
0092   <span class="keyword">if</span> n_sample,
0093     x = K * x + Aeq_inv * repmat(b_eq,1,size(x,2));
0094   <span class="keyword">end</span>
0095   x_lower = [];
0096   x_upper = [];
0097   x_lower_list = K * x_lower_list + Aeq_inv * repmat(b_eq,1,size(x_lower_list,2));
0098   x_upper_list = K * x_upper_list + Aeq_inv * repmat(b_eq,1,size(x_upper_list,2));
0099 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 10-Apr-2013 10:42:33 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>