<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of network_sbml_export</title>
  <meta name="keywords" content="network_sbml_export">
  <meta name="description" content="SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">mnt</a> &gt; <a href="../index.html">mnt_network</a> &gt; <a href="index.html">network_import_export</a> &gt; network_sbml_export.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mnt/mnt_network/network_import_export&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>network_sbml_export
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version)

Export network (data type from mnt) to libSBML's SBMLModel data type

ARGUMENTS
 network   (network structure) network
 name      (string, optional)  model name
 notes     (string, optional)

If the argument filename (string) is given, the
model is directly written to an SBML (.xml) file
(in the present directory. no path can be given)

You can also use SaveSBMLModel(SBMLmodel) from the SBMLToolbox
to save the model to a .mat file, or OutputSBML(SBMLmodel,filename);
to export it to an SBML (.xml) file

This function requiers the SBMLToolbox
(see http://sbml.org/software/sbmltoolbox/)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../mnt/mnt_kinetics/modular_rate_laws/cm_rate_law/cs_get_formula.html" class="code" title="function formula = cs_get_formula(r_name,mn,sub,pro,act,inh,m_sub,m_pro)">cs_get_formula</a>	r_name reaction name (for naming the parameters)</li><li><a href="../../../mnt/mnt_kinetics/modular_rate_laws/modular_rate_law_functions/parameter_conversion/ms_KM_KVratio_to_Keq.html" class="code" title="function keq = ms_KM_KVratio_to_Keq(N,KM,KVratio);">ms_KM_KVratio_to_Keq</a>	keq = ms_KM_KVratio_to_Keq(N,KM,KVratio);</li><li><a href="../../../mnt/mnt_kinetics/modular_rate_laws/sm_rate_law/ms_get_formula.html" class="code" title="function formula = ms_get_formula(r_name,mn,sub,pro,act,inh,m_sub,m_pro)">ms_get_formula</a>	formula = ms_get_formula(r_name,mn,sub,pro,act,inh,m_sub,m_pro)</li><li><a href="network_adjust_names_for_sbml_export.html" class="code" title="function [metabolites,actions] = network_adjust_names_for_sbml_export(metabolites,actions)">network_adjust_names_for_sbml_export</a>	[metabolites,actions] = network_adjust_names_for_sbml_export(metabolites,actions)</li><li><a href="../../../mnt/util/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version)</span>
0002 <span class="comment">%</span>
0003 <span class="comment">%Export network (data type from mnt) to libSBML's SBMLModel data type</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%ARGUMENTS</span>
0006 <span class="comment">% network   (network structure) network</span>
0007 <span class="comment">% name      (string, optional)  model name</span>
0008 <span class="comment">% notes     (string, optional)</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%If the argument filename (string) is given, the</span>
0011 <span class="comment">%model is directly written to an SBML (.xml) file</span>
0012 <span class="comment">%(in the present directory. no path can be given)</span>
0013 <span class="comment">%</span>
0014 <span class="comment">%You can also use SaveSBMLModel(SBMLmodel) from the SBMLToolbox</span>
0015 <span class="comment">%to save the model to a .mat file, or OutputSBML(SBMLmodel,filename);</span>
0016 <span class="comment">%to export it to an SBML (.xml) file</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%This function requiers the SBMLToolbox</span>
0019 <span class="comment">%(see http://sbml.org/software/sbmltoolbox/)</span>
0020 
0021 
0022 <a name="_sub0" href="#_subfunctions" class="code">function SBMLmodel = network_sbml_export(network,verbose,name,filename,notes,sbml_level,sbml_version)</a>
0023 
0024 eval(<a href="../../../mnt/util/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'verbose'</span>,<span class="string">'0'</span>,<span class="string">'name'</span>,<span class="string">'[]'</span>,<span class="string">'notes'</span>,<span class="string">'[]'</span>,<span class="string">'sbml_level'</span>,<span class="string">'2'</span>,<span class="string">'sbml_version'</span>,<span class="string">'2'</span>));
0025 <span class="keyword">if</span> isempty(<span class="string">'name'</span>),       name = <span class="string">'Model'</span>; <span class="keyword">end</span> 
0026 <span class="keyword">if</span> isempty(<span class="string">'notes'</span>),       notes = <span class="string">''</span>; <span class="keyword">end</span> 
0027 
0028 name = strrep(name,<span class="string">' '</span>,<span class="string">'_'</span>);
0029 name = strrep(name,<span class="string">'.'</span>,<span class="string">'_'</span>);
0030 
0031 
0032 <span class="comment">% -------------------------------------------------------------</span>
0033 <span class="comment">% adjust names to SBML conventions</span>
0034 
0035 [network.metabolites,network.actions] = <a href="network_adjust_names_for_sbml_export.html" class="code" title="function [metabolites,actions] = network_adjust_names_for_sbml_export(metabolites,actions)">network_adjust_names_for_sbml_export</a>(network.metabolites,network.actions);
0036 
0037 <span class="keyword">for</span> it=1:length(network.metabolites),
0038   metabolite_id{it,1}       = network.metabolites{it};
0039 <span class="keyword">end</span>
0040 
0041 <span class="keyword">if</span> length(network.metabolites) ~= length(unique(network.metabolites)),
0042   warning(<span class="string">'Error in conversion of metabolite names'</span>);
0043   <span class="keyword">for</span> it=1:length(network.metabolites), 
0044     network.metabolites{it} = [<span class="string">'M'</span> num2str(it) <span class="string">'_'</span> network.metabolites{it}];
0045   <span class="keyword">end</span>
0046 <span class="keyword">end</span>
0047 
0048 <span class="keyword">if</span> length(unique(network.actions))&lt;length(network.actions),
0049   <span class="keyword">for</span> it=1:length(network.actions), 
0050     network.actions{it} = [<span class="string">'A'</span> num2str(it) <span class="string">'_'</span> network.actions{it}];
0051   <span class="keyword">end</span>
0052 <span class="keyword">end</span>
0053 
0054 
0055 
0056 <span class="comment">% -------------------------------------------------------------</span>
0057 <span class="comment">% SBML object</span>
0058 
0059 
0060 SBMLmodel = model_create(sbml_level,sbml_version);
0061 SBMLmodel = Model_setName(SBMLmodel,name);
0062 SBMLmodel = Model_setId(SBMLmodel,name);
0063 
0064 compartment = Compartment_create(sbml_level,sbml_version);
0065 compartment = Compartment_setId(compartment,<span class="string">'compartment'</span>);
0066 compartment = Compartment_setName(compartment,<span class="string">'compartment'</span>);
0067 SBMLmodel   = Model_addCompartment(SBMLmodel,compartment);
0068 
0069 <span class="comment">% notes</span>
0070 <span class="comment">% Model %s written by the Matlab Metabolic Network Toolbox&lt;/p&gt;\n',name)];</span>
0071 
0072 
0073 <span class="comment">% ----------------------------------------------------------------</span>
0074 <span class="comment">% metabolites</span>
0075 
0076 <span class="keyword">if</span> verbose, fprintf(<span class="string">'Converting the metabolites: '</span>,it); <span class="keyword">end</span>
0077 
0078 <span class="keyword">for</span> it = 1:length(network.metabolites),
0079   <span class="keyword">if</span> verbose,  fprintf(<span class="string">'%d '</span>,it); <span class="keyword">end</span> 
0080   species{it} = Species_create(sbml_level,sbml_version);
0081   species{it} = Species_setId(species{it},metabolite_id{it});
0082   species{it} = Species_setName(species{it},network.metabolites{it});
0083   species{it} = Species_setCompartment(species{it},<span class="string">'compartment'</span>);
0084   species{it} = Species_setBoundaryCondition(species{it},network.external(it));
0085   <span class="keyword">if</span> isfield(network,<span class="string">'s_init'</span>),  
0086     species{it} = Species_setInitialConcentration(species{it},network.s_init(it));
0087   <span class="keyword">else</span>,
0088     species{it} = Species_setInitialConcentration(species{it},0);
0089   <span class="keyword">end</span>
0090 <span class="keyword">end</span>
0091 
0092 <span class="keyword">if</span> verbose, fprintf(<span class="string">'\n'</span>,it); <span class="keyword">end</span>
0093 
0094 
0095 <span class="comment">% ----------------------------------------------------------------</span>
0096 <span class="comment">% kinetic laws</span>
0097 
0098 <span class="keyword">if</span> isfield(network,<span class="string">'kinetics'</span>),
0099   <span class="keyword">switch</span> network.kinetics.type,
0100 
0101     <span class="keyword">case</span> {<span class="string">'ms'</span>,<span class="string">'cs'</span>},    
0102       
0103       <span class="keyword">for</span> it = 1:length(network.metabolites),
0104         species{it} = Species_setInitialConcentration(species{it},network.kinetics.c(it));
0105       <span class="keyword">end</span>
0106 
0107       metnames = network.metabolites;      
0108       kk       = network.kinetics;
0109       
0110       <span class="keyword">for</span> it = 1:length(network.actions),
0111     
0112         r_name = [<span class="string">'R'</span> num2str(it) ];
0113         
0114         sub = find(network.N(:,it) &lt; 0);
0115         pro = find(network.N(:,it) &gt; 0);
0116         rea = find(kk.KM(it,:)~=0);
0117         act = find(kk.KA(it,:)~=0);
0118         inh = find(kk.KI(it,:)~=0);
0119         
0120         m_sub           = abs(network.N(sub,it));
0121         m_pro           = abs(network.N(pro,it));
0122         
0123         <span class="keyword">switch</span> network.kinetics.type,
0124           <span class="keyword">case</span> <span class="string">'ms'</span>,
0125             formula         = <a href="../../../mnt/mnt_kinetics/modular_rate_laws/sm_rate_law/ms_get_formula.html" class="code" title="function formula = ms_get_formula(r_name,mn,sub,pro,act,inh,m_sub,m_pro)">ms_get_formula</a>(r_name,metnames,sub,pro,act,inh,m_sub,m_pro); 
0126             kk.KVratio = <a href="../../../mnt/mnt_kinetics/modular_rate_laws/modular_rate_law_functions/parameter_conversion/ms_KM_KVratio_to_Keq.html" class="code" title="function keq = ms_KM_KVratio_to_Keq(N,KM,KVratio);">ms_KM_KVratio_to_Keq</a>(network.N,kk.KM,kk.Keq);
0127           <span class="keyword">case</span> <span class="string">'cs'</span>,
0128             formula         = <a href="../../../mnt/mnt_kinetics/modular_rate_laws/cm_rate_law/cs_get_formula.html" class="code" title="function formula = cs_get_formula(r_name,mn,sub,pro,act,inh,m_sub,m_pro)">cs_get_formula</a>(r_name,metnames,sub,pro,act,inh,m_sub,m_pro); 
0129             kk.KVratio = <a href="../../../mnt/mnt_kinetics/modular_rate_laws/modular_rate_law_functions/parameter_conversion/ms_KM_KVratio_to_Keq.html" class="code" title="function keq = ms_KM_KVratio_to_Keq(N,KM,KVratio);">ms_KM_KVratio_to_Keq</a>(network.N,kk.KM,kk.Keq);
0130         <span class="keyword">end</span>
0131         
0132     kinetic_law{it} = KineticLaw_create(sbml_level,sbml_version);
0133     kinetic_law{it} = KineticLaw_setFormula(kinetic_law{it}, formula);
0134     kinetic_law{it} = KineticLaw_setMathFromFormula(kinetic_law{it});
0135 
0136         parameter       = Parameter_create(sbml_level,sbml_version);
0137         parameter       = Parameter_setName(parameter, [<span class="string">'u_'</span> r_name ]);
0138         parameter       = Parameter_setId(  parameter, [<span class="string">'u_'</span> r_name ]);
0139         parameter       = Parameter_setValue(parameter,kk.u(it));
0140         kinetic_law{it} = KineticLaw_addParameter(kinetic_law{it}, parameter);        
0141         
0142         parameter       = Parameter_create(sbml_level,sbml_version);
0143         parameter       = Parameter_setName(parameter, [<span class="string">'kC_'</span> r_name ]);
0144         parameter       = Parameter_setId(  parameter, [<span class="string">'kC_'</span> r_name ]);
0145         parameter       = Parameter_setValue(parameter,kk.KV(it));
0146         kinetic_law{it} = KineticLaw_addParameter(kinetic_law{it}, parameter);        
0147 
0148         parameter       = Parameter_create(sbml_level,sbml_version);
0149         parameter       = Parameter_setName(parameter, [<span class="string">'kEQ_'</span> r_name ]);
0150         parameter       = Parameter_setId(  parameter, [<span class="string">'kEQ_'</span> r_name ]);
0151         parameter       = Parameter_setValue(parameter,kk.Keq(it));
0152         kinetic_law{it} = KineticLaw_addParameter(kinetic_law{it}, parameter);        
0153         
0154     <span class="keyword">for</span> itt = 1:length(rea),
0155           parameter       = Parameter_create(sbml_level,sbml_version);
0156           parameter       = Parameter_setName(parameter, [<span class="string">'kM_'</span> r_name <span class="string">'_'</span> metnames{rea(itt)} ]);
0157           parameter       = Parameter_setId(  parameter, [<span class="string">'kM_'</span> r_name <span class="string">'_'</span> metnames{rea(itt)} ]);
0158           parameter       = Parameter_setValue(parameter,kk.KM(it,rea(itt)));
0159           kinetic_law{it} = KineticLaw_addParameter(kinetic_law{it}, parameter);        
0160         <span class="keyword">end</span>
0161 
0162         <span class="keyword">for</span> itt = 1:length(act),
0163           parameter       = Parameter_create(sbml_level,sbml_version);
0164           parameter       = Parameter_setName(parameter, [<span class="string">'kA_'</span> r_name <span class="string">'_'</span> metnames{act(itt)} ]);
0165           parameter       = Parameter_setId(  parameter, [<span class="string">'kA_'</span> r_name <span class="string">'_'</span> metnames{act(itt)} ]);
0166           parameter       = Parameter_setValue(parameter,kk.KA(it,act(itt)));
0167           kinetic_law{it} = KineticLaw_addParameter(kinetic_law{it}, parameter);        
0168         <span class="keyword">end</span>
0169 
0170         <span class="keyword">for</span> itt = 1:length(inh),
0171           parameter       = Parameter_create(sbml_level,sbml_version);
0172           parameter       = Parameter_setName(parameter, [<span class="string">'kI_'</span> r_name <span class="string">'_'</span> metnames{inh(itt)} ]);
0173           parameter       = Parameter_setId(  parameter, [<span class="string">'kI_'</span> r_name <span class="string">'_'</span> metnames{inh(itt)} ]);
0174           parameter       = Parameter_setValue(parameter,kk.KI(it,inh(itt)));
0175           kinetic_law{it} = KineticLaw_addParameter(kinetic_law{it}, parameter);
0176         <span class="keyword">end</span>
0177       
0178       <span class="keyword">end</span>
0179     
0180     <span class="keyword">case</span> <span class="string">'numeric'</span>,
0181     
0182       <span class="keyword">for</span> it = 1:length(network.actions),
0183     kinetic_law{it} = KineticLaw_create(sbml_level,sbml_version);
0184     r = network.kinetics.reactions{it};
0185     kinetic_law{it}.math = strrep(r.string,<span class="string">'power'</span>,<span class="string">'pow'</span>);
0186     kinetic_law{it} = KineticLaw_setFormulaFromMath(kinetic_law{it});
0187     <span class="keyword">for</span> p_ind = 1:length(r.parameters),
0188       thispar            = Parameter_create(sbml_level,sbml_version);
0189       thispar.id         = r.parameters{p_ind}.name;
0190       thispar.value      = network.kinetics.parameter_values(r.parameters{p_ind}.index);
0191       thispar.isSetValue = 1;
0192       kinetic_law{it}    = KineticLaw_addParameter(kinetic_law{it}, thispar);
0193     <span class="keyword">end</span>
0194       <span class="keyword">end</span>
0195       
0196     <span class="keyword">otherwise</span>, disp(<span class="string">'Kinetics export has not been implemented for this kinetics so far.'</span>);
0197   
0198   <span class="keyword">end</span>
0199 <span class="keyword">end</span>
0200 
0201 <span class="keyword">for</span> it = 1:length(network.metabolites),
0202   SBMLmodel = Model_addSpecies(SBMLmodel,species{it});
0203 <span class="keyword">end</span>
0204 
0205 
0206 <span class="comment">% -----------------------------------------------------------</span>
0207 <span class="comment">% reactions</span>
0208 
0209 <span class="keyword">if</span> verbose, fprintf(<span class="string">'Converting the reactions: '</span>,it); <span class="keyword">end</span>
0210 
0211 <span class="keyword">for</span> it = 1:length(network.actions),
0212 
0213  <span class="keyword">if</span> verbose,  fprintf(<span class="string">'%d '</span>,it); <span class="keyword">end</span>
0214 
0215   reaction = Reaction_create(sbml_level,sbml_version);
0216   reaction = Reaction_setId(reaction,network.actions{it});
0217   reaction = Reaction_setName(reaction,network.actions{it});
0218   reaction = Reaction_setReversible(reaction,network.reversible(it));
0219   <span class="keyword">if</span> exist(<span class="string">'kinetic_law'</span>,<span class="string">'var'</span>),
0220     reaction = Reaction_setKineticLaw(reaction,kinetic_law{it});  
0221   <span class="keyword">end</span>  
0222 
0223   sub_ind = find(network.N(:,it)&lt;0);
0224   
0225   <span class="keyword">if</span> length(sub_ind),
0226     <span class="keyword">for</span> itt = 1:length(sub_ind),
0227       reactant = SpeciesReference_create(sbml_level,sbml_version);
0228       reactant.species = network.metabolites{sub_ind(itt)};
0229       reactant.stoichiometry = abs(network.N(sub_ind(itt),it));      
0230       reaction = Reaction_addReactant(reaction, reactant);
0231     <span class="keyword">end</span>
0232   <span class="keyword">end</span>
0233   
0234   prod_ind = find(network.N(:,it)&gt;0);
0235 
0236   <span class="keyword">if</span> length(prod_ind),
0237     <span class="keyword">for</span> itt = 1:length(prod_ind),
0238       product = SpeciesReference_create(sbml_level,sbml_version);
0239       product.species = network.metabolites{prod_ind(itt)};
0240       product.stoichiometry = abs(network.N(prod_ind(itt),it));      
0241       reaction = Reaction_addProduct(reaction, product);  
0242     <span class="keyword">end</span>
0243   <span class="keyword">end</span>
0244 
0245   mod_ind = find(network.regulation_matrix(it,:) ~=0);
0246 
0247   <span class="keyword">if</span> length(mod_ind),
0248     <span class="keyword">for</span> itt = 1:length(mod_ind),
0249       modifier = ModifierSpeciesReference_create(sbml_level,sbml_version);
0250       modifier.species = network.metabolites{mod_ind(itt)};
0251       reaction = Reaction_addModifier(reaction, modifier);
0252     <span class="keyword">end</span>
0253   <span class="keyword">end</span>
0254   
0255   SBMLmodel = Model_addReaction(SBMLmodel,reaction);
0256 
0257 <span class="keyword">end</span>
0258 
0259 <span class="keyword">if</span> verbose, fprintf(<span class="string">'\n'</span>,it); <span class="keyword">end</span>
0260 
0261 <span class="keyword">if</span> exist(<span class="string">'filename'</span>,<span class="string">'var'</span>),
0262   OutputSBML(SBMLmodel,filename);
0263   fprintf(<span class="string">'Wrote SBML file &quot;%s&quot;\n'</span>,filename);
0264 <span class="keyword">end</span>
0265 
0266 
0267 <span class="comment">% -------------------------------------------------------------------</span>
0268 
0269 <span class="comment">%     case 'numeric',</span>
0270 <span class="comment">%</span>
0271 <span class="comment">%       s = [s sprintf('        &lt;kineticLaw formula=&quot;%s&quot;&gt;\n',network.kinetics.reactions{it}.string)];</span>
0272 <span class="comment">%       s = [s sprintf('          &lt;listOfParameters&gt;\n')];</span>
0273 <span class="comment">%       parameters = network.kinetics.reactions{it}.parameters;</span>
0274 <span class="comment">%</span>
0275 <span class="comment">%       for itt = 1:length(parameters),</span>
0276 <span class="comment">%     s = [s sprintf('            &lt;parameter name=&quot;%s&quot; value=&quot;%d&quot;/&gt;\n',parameters{itt}.name,network.kinetics.parameter_values(parameters{itt}.index))];</span>
0277 <span class="comment">%       end</span>
0278 <span class="comment">%       s = [s sprintf('          &lt;/listOfParameters&gt;\n')];</span>
0279 <span class="comment">%       s = [s sprintf('        &lt;/kineticLaw&gt;\n')];</span>
0280 <span class="comment">%</span>
0281 <span class="comment">%     case 'mass-action',</span>
0282 <span class="comment">%</span>
0283 <span class="comment">%       substrate_ind = find(network.N(:,it)&lt;0);</span>
0284 <span class="comment">%       product_ind   = find(network.N(:,it)&gt;0);</span>
0285 <span class="comment">%</span>
0286 <span class="comment">%       substrates='';</span>
0287 <span class="comment">%       for itt = 1: length(substrate_ind),</span>
0288 <span class="comment">%     substrates = [substrates ' * ' network.metabolites{substrate_ind(itt)} ];</span>
0289 <span class="comment">%       end</span>
0290 <span class="comment">%       products='';</span>
0291 <span class="comment">%       for itt = 1: length(product_ind),</span>
0292 <span class="comment">%     products = [products ' * ' network.metabolites{product_ind(itt)} ];</span>
0293 <span class="comment">%       end</span>
0294 <span class="comment">%</span>
0295 <span class="comment">%       s = [s sprintf('        &lt;kineticLaw formula=&quot;kp%s - km%s&quot;&gt;\n',substrates, products  )];</span>
0296 <span class="comment">%       s = [s sprintf('          &lt;listOfParameters&gt;\n')];</span>
0297 <span class="comment">%       s = [s sprintf('            &lt;parameter name=&quot;kp&quot; value=&quot;%d&quot;/&gt;\n',network.kinetics.k_fwd(it))];</span>
0298 <span class="comment">%       s = [s sprintf('            &lt;parameter name=&quot;km&quot; value=&quot;%d&quot;/&gt;\n',network.kinetics.k_bwd(it))];</span>
0299 <span class="comment">%       s = [s sprintf('          &lt;/listOfParameters&gt;\n')];</span>
0300 <span class="comment">%       s = [s sprintf('        &lt;/kineticLaw&gt;\n')];</span>
0301 <span class="comment">%</span>
0302 <span class="comment">%     case 'standard',</span>
0303 <span class="comment">%</span>
0304 <span class="comment">%       for it = 1:length(network.actions),</span>
0305 <span class="comment">%</span>
0306 <span class="comment">%     sub_ind = find(network.N(:,it)&lt;0);</span>
0307 <span class="comment">%     prod_ind = find(network.N(:,it)&gt;0);</span>
0308 <span class="comment">%     if isfield(network,'regulation_matrix'),</span>
0309 <span class="comment">%       act_ind = find(network.regulation_matrix(it,:)&gt;0);</span>
0310 <span class="comment">%       inh_ind = find(network.regulation_matrix(it,:)&lt;0);</span>
0311 <span class="comment">%     end</span>
0312 <span class="comment">%</span>
0313 <span class="comment">%     kinetic_law{it} = KineticLaw_create(sbml_level,sbml_version);</span>
0314 <span class="comment">%</span>
0315 <span class="comment">%     substrates  = network.metabolites(sub_ind);</span>
0316 <span class="comment">%     products    = network.metabolites(prod_ind);</span>
0317 <span class="comment">%     activators  = network.metabolites(act_ind);</span>
0318 <span class="comment">%     inhibitors  = network.metabolites(inh_ind);</span>
0319 <span class="comment">%     formula     = get_formula(network.kinetics.reactions{it},substrates,products,inhibitors,activators,it);</span>
0320 <span class="comment">%     kinetic_law{it} = KineticLaw_setFormula(kinetic_law{it}, formula);</span>
0321 <span class="comment">%     kinetic_law{it} = KineticLaw_setMathFromFormula(kinetic_law{it});</span>
0322 <span class="comment">%</span>
0323 <span class="comment">%     parameters = network.kinetics.reactions{it}.parameters;</span>
0324 <span class="comment">%     psizes = network.kinetics.reactions{it}.sizes;</span>
0325 <span class="comment">%</span>
0326 <span class="comment">%     for itt = 1:length(parameters),</span>
0327 <span class="comment">%           dum = getfield(network.kinetics.reactions{it},parameters{itt});</span>
0328 <span class="comment">%           for itt2= 1:psizes(itt),</span>
0329 <span class="comment">%             parameter = Parameter_create(sbml_level,sbml_version);</span>
0330 <span class="comment">%             parameter = Parameter_setName(parameter, [  'R' num2str(it)  '_' parameters{itt} num2str(itt2) ]);</span>
0331 <span class="comment">%             parameter = Parameter_setId(  parameter, [  'R' num2str(it) '_'  parameters{itt} num2str(itt2) ]);</span>
0332 <span class="comment">%             parameter = Parameter_setValue(parameter,dum(itt2));</span>
0333 <span class="comment">%             kinetic_law{it} = KineticLaw_addParameter(kinetic_law{it}, parameter);</span>
0334 <span class="comment">%           end</span>
0335 <span class="comment">%     end</span>
0336 <span class="comment">%</span>
0337 <span class="comment">%       end</span>
0338 <span class="comment">%</span></pre></div>
<hr><address>Generated on Fri 05-Apr-2013 16:43:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>