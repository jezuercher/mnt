<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of network_subnetwork_balanced</title>
  <meta name="keywords" content="network_subnetwork_balanced">
  <meta name="description" content="[network_red,v_red,dmu_red,c_red] = network_subnetwork_balanced(network,v,epsilon,vmin,dmu,c)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">mnt</a> &gt; <a href="#">mnt_network</a> &gt; <a href="#">network_build_edit</a> &gt; network_subnetwork_balanced.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./mnt/mnt_network/network_build_edit&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>network_subnetwork_balanced
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>[network_red,v_red,dmu_red,c_red] = network_subnetwork_balanced(network,v,epsilon,vmin,dmu,c)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [network_red,v_red,dmu_red,c_red] = network_subnetwork_balanced(network,v,epsilon,vmin,dmu,c) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [network_red,v_red,dmu_red,c_red] = network_subnetwork_balanced(network,v,epsilon,vmin,dmu,c)

 first reduce a network to the reactions carrying considerable flux and then 
 complement it with reactions mimicking the disregarded production and consumption
 of internal metabolites such that the new network in in stationary state and 
 show the same fluxes as the old network</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././mnt/mnt_fluxes/flux_projection/project_fluxes.html" class="code" title="function [v_projected,ind_non_orthogonal] = project_fluxes(N, ind_ext, v_mean, v_std, v_sign, pars, v_fix);">project_fluxes</a>	v_projected = project_fluxes(N,ind_ext, v_mean, v_std, v_sign, pars);</li><li><a href="network_reduce_to_active_subnetwork.html" class="code" title="function [network,ind_m,ind_r] = network_reduce_to_active_subnetwork(network,v,epsilon)">network_reduce_to_active_subnetwork</a>	if v is a matrix, choose all reactions for which the flux in any of the states</li><li><a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [network_red,v_red,dmu_red,c_red] = network_subnetwork_balanced(network,v,epsilon,vmin,dmu,c)</a>
0002 
0003 <span class="comment">% [network_red,v_red,dmu_red,c_red] = network_subnetwork_balanced(network,v,epsilon,vmin,dmu,c)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% first reduce a network to the reactions carrying considerable flux and then</span>
0006 <span class="comment">% complement it with reactions mimicking the disregarded production and consumption</span>
0007 <span class="comment">% of internal metabolites such that the new network in in stationary state and</span>
0008 <span class="comment">% show the same fluxes as the old network</span>
0009 
0010 <span class="comment">% ----------------------------------------------------------------</span>
0011 <span class="comment">% 1: omit all reactions with flux smaller than epsilon</span>
0012 <span class="comment">% and balance v again</span>
0013 
0014 eval(<a href="../../.././mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'epsilon'</span>,<span class="string">'10^-10'</span>,<span class="string">'vmin'</span>,<span class="string">'0.1'</span>));
0015 
0016 [network1,ind_m,ind_r] = <a href="network_reduce_to_active_subnetwork.html" class="code" title="function [network,ind_m,ind_r] = network_reduce_to_active_subnetwork(network,v,epsilon)">network_reduce_to_active_subnetwork</a>(network,v,epsilon);
0017 
0018 v1  = v(ind_r,:);
0019 v1p = <a href="../../.././mnt/mnt_fluxes/flux_projection/project_fluxes.html" class="code" title="function [v_projected,ind_non_orthogonal] = project_fluxes(N, ind_ext, v_mean, v_std, v_sign, pars, v_fix);">project_fluxes</a>(network1.N,find(network1.external),v1,[],[],struct(<span class="string">'method'</span>,<span class="string">'simple'</span>));
0020 
0021 <span class="comment">% ----------------------------------------------------------------</span>
0022 <span class="comment">% 2: omit all reactions with flux smaller than vmin</span>
0023 
0024 [network2,ind_m,ind_r] = <a href="network_reduce_to_active_subnetwork.html" class="code" title="function [network,ind_m,ind_r] = network_reduce_to_active_subnetwork(network,v,epsilon)">network_reduce_to_active_subnetwork</a>(network1,v1p,vmin);
0025 v2 = v1p(ind_r,:);
0026 
0027 ind_int = find(network2.external==0);
0028 ind_met_exchange = ind_int(find(sum(double(abs(network2.N(ind_int,:)*v2) &gt; epsilon),2)));
0029 n_met_exchange   = length(ind_met_exchange);
0030 
0031 [nm,nr] = size(network2.N);
0032 met_aux ={};
0033 rea_aux = {};
0034 <span class="keyword">for</span> it = 1:length(ind_met_exchange);
0035   met_aux{it,1} = [<span class="string">'aux_met_'</span>  network2.metabolites{ind_met_exchange(it)}];
0036   rea_aux{it,1} = [<span class="string">'aux_rea_'</span>  network2.metabolites{ind_met_exchange(it)}];
0037 <span class="keyword">end</span>
0038 
0039 network_red.metabolites = [network2.metabolites; met_aux];
0040 network_red.actions     = [network2.actions;     rea_aux];
0041 network_red.N           = network2.N;
0042 network_red.N(ind_met_exchange,nr+[1:n_met_exchange])      = eye(n_met_exchange);
0043 network_red.N(nm+[1:n_met_exchange],nr+[1:n_met_exchange]) = -eye(n_met_exchange);
0044 network_red.reversible = [network2.reversible; ones(n_met_exchange,1)];
0045 network_red.external   = [network2.external; ones(n_met_exchange,1)];
0046 
0047 <span class="keyword">if</span> isfield(network2,<span class="string">'metabolite_KEGGID'</span>),
0048   network_red.metabolite_KEGGID   = [network2.metabolite_KEGGID; repmat({<span class="string">''</span>},n_met_exchange,1)];
0049 <span class="keyword">end</span>  
0050 v_red                  = [v2; -network2.N(ind_met_exchange,:)*v2];
0051 
0052 <span class="comment">% invent hypothetical concentrations and dmu values</span>
0053 dmu_ex = sign(network2.N(ind_met_exchange,:)*v2);
0054 c_red = [c(ind_m,:); 2.^dmu_ex];
0055 dmu_red = [dmu(ind_r,:); dmu_ex];</pre></div>
<hr><address>Generated on Sun 09-Nov-2014 13:14:25 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>