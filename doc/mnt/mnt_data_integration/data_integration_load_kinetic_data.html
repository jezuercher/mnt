<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of data_integration_load_kinetic_data</title>
  <meta name="keywords" content="data_integration_load_kinetic_data">
  <meta name="description" content="kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">mnt</a> &gt; <a href="index.html">mnt_data_integration</a> &gt; data_integration_load_kinetic_data.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for mnt/mnt_data_integration&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>data_integration_load_kinetic_data
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)

 construct data structure with kinetic quantities relevant for a model
 for display: use parameter_balancing_kinetic_data_show(kinetic_data);

 data are read from file 'file_kinetic_data' and 

 the data structure 'kinetic_data' contains a field for every quantity type listed in 'data_quantities'

 fill in values from &quot;kinetic_data_table&quot;
 take logarithms where necessary
 values are NOT averaged yet (FIX!!!)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)">data_integration_load_kinetic_data</a>	kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)</li><li><a href="data_integration_load_quantity_info.html" class="code" title="function quantity_info = data_integration_load_quantity_info(omit_quantities,quantity_info_filename)">data_integration_load_quantity_info</a>	quantity_info = data_integration_load_quantity_info(omit_quantities,quantity_info_filename)</li><li><a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>	N = cell_string2num(C)</li><li><a href="../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>	function [label,indices] = label_names(names,allnames, method)</li><li><a href="../../mnt/utils/lognormal_log2normal.html" class="code" title="function [mu,sigma] = lognormal_log2normal(mu_log,sigma_log,convention)">lognormal_log2normal</a>	[mu,sigma] = lognormal_log2normal(mu_log,sigma_log,convention)</li><li><a href="../../mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>	function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)">data_integration_load_kinetic_data</a>	kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)</li><li><a href="../../mnt/mnt_kinetics/modular_rate_laws/modular_rate_law_functions/sbtab_to_modular_rate_law.html" class="code" title="function [kinetics, kinetic_data] = sbtab_to_modular_rate_law(network,file_kinetic_data,options)">sbtab_to_modular_rate_law</a>	[kinetics, kinetic_data] = sbtab_to_modular_rate_law(network,file_kinetic_data,options)</li><li><a href="../../mnt/mnt_parameter_balancing/parameter_balancing_sbtab.html" class="code" title="function parameter_balancing_sbtab(model_name, metabolic_data_sbtab, options)">parameter_balancing_sbtab</a>	a wrapper for parameter balancing that reads all input data (model, priors, kinetic and metabolic data)</li><li><a href="../../mnt/mnt_parameter_balancing/parameter_balancing_thermodynamic.html" class="code" title="function [c, mu0, Keq, A, my_kinetic_data] = parameter_balancing_thermodynamic(network, v, filename, options)">parameter_balancing_thermodynamic</a>	[c, v, mu0, Keq, A, my_kinetic_data] = parameter_balancing_theromdynamic(network, v, filename,options)</li><li><a href="../../mnt/mnt_parameter_balancing/parameter_balancing_utils/parameter_balancing_Keq.html" class="code" title="function [Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename, options)">parameter_balancing_Keq</a>	[Keq, mu0, c, my_kinetic_data] = parameter_balancing_Keq(network, filename,options)</li><li><a href="../../mnt/mnt_parameter_balancing/parameter_balancing_utils/parameter_balancing_kinetic.html" class="code" title="function [r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);">parameter_balancing_kinetic</a>	[r,r_orig,kinetic_data] = parameter_balancing_kinetic(network, kinetic_data, filename, Keq_given);</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)</a>
0002 
0003 <span class="comment">% kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% construct data structure with kinetic quantities relevant for a model</span>
0006 <span class="comment">% for display: use parameter_balancing_kinetic_data_show(kinetic_data);</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% data are read from file 'file_kinetic_data' and</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% the data structure 'kinetic_data' contains a field for every quantity type listed in 'data_quantities'</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% fill in values from &quot;kinetic_data_table&quot;</span>
0013 <span class="comment">% take logarithms where necessary</span>
0014 <span class="comment">% values are NOT averaged yet (FIX!!!)</span>
0015 
0016 <span class="keyword">if</span> ~exist(<span class="string">'sbtab_version'</span>,<span class="string">'file'</span>),
0017   error(<span class="string">'For this function, the SBtab toolbox must be installed'</span>);
0018 <span class="keyword">end</span>
0019 
0020 eval(<a href="../../mnt/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'quantity_info'</span>,<span class="string">'[]'</span>,<span class="string">'use_sbml_ids'</span>,<span class="string">'1'</span>,<span class="string">'use_kegg_ids'</span>,<span class="string">'1'</span>,<span class="string">'flag_invent_std'</span>,<span class="string">'1'</span>,<span class="string">'verbose'</span>,<span class="string">'1'</span>));
0021 
0022 <span class="keyword">if</span> isempty(quantity_info), quantity_info = <a href="data_integration_load_quantity_info.html" class="code" title="function quantity_info = data_integration_load_quantity_info(omit_quantities,quantity_info_filename)">data_integration_load_quantity_info</a>; <span class="keyword">end</span>
0023 
0024 <span class="keyword">if</span> iscell(file_kinetic_data),
0025   <span class="comment">%% several files; read them one after the other, each time</span>
0026   <span class="comment">%% overriding information from previous files.</span>
0027   kinetic_data = <a href="data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)">data_integration_load_kinetic_data</a>(data_quantities, quantity_info, network, file_kinetic_data{1}, use_sbml_ids, use_kegg_ids);
0028   fn = fieldnames(kinetic_data);
0029   <span class="keyword">for</span> it = 2:length(file_kinetic_data),
0030     my_kinetic_data = <a href="data_integration_load_kinetic_data.html" class="code" title="function kinetic_data = data_integration_load_kinetic_data(data_quantities, quantity_info, network, file_kinetic_data, use_sbml_ids, use_kegg_ids, flag_invent_std, verbose)">data_integration_load_kinetic_data</a>(data_quantities, quantity_info, network, file_kinetic_data{it}, use_sbml_ids, use_kegg_ids);
0031     <span class="keyword">for</span> it2 = 1:length(fn)
0032       ii = isfinite(my_kinetic_data.(fn{it2}).median);
0033       kinetic_data.(fn{it2}).median(ii) = my_kinetic_data.(fn{it2}).median(ii);
0034       ii = isfinite(my_kinetic_data.(fn{it2}).mean);
0035       kinetic_data.(fn{it2}).mean(ii) = my_kinetic_data.(fn{it2}).mean(ii);
0036       ii = isfinite(my_kinetic_data.(fn{it2}).std);
0037       kinetic_data.(fn{it2}).std(ii) = my_kinetic_data.(fn{it2}).std(ii);
0038       ii = isfinite(my_kinetic_data.(fn{it2}).lower);
0039       kinetic_data.(fn{it2}).lower(ii) = my_kinetic_data.(fn{it2}).lower(ii);
0040       ii = isfinite(my_kinetic_data.(fn{it2}).upper);
0041       kinetic_data.(fn{it2}).upper(ii) = my_kinetic_data.(fn{it2}).upper(ii);       
0042 
0043       <span class="keyword">if</span> isfield(my_kinetic_data.(fn{it2}),<span class="string">'mean_ln'</span>),
0044         ii = isfinite(my_kinetic_data.(fn{it2}).mean_ln);
0045         kinetic_data.(fn{it2}).mean_ln(ii) = my_kinetic_data.(fn{it2}).mean_ln(ii);
0046         ii = isfinite(my_kinetic_data.(fn{it2}).std_ln);
0047         kinetic_data.(fn{it2}).std_ln(ii) = my_kinetic_data.(fn{it2}).std_ln(ii);
0048         ii = isfinite(my_kinetic_data.(fn{it2}).lower_ln);
0049         kinetic_data.(fn{it2}).lower_ln(ii) = my_kinetic_data.(fn{it2}).lower_ln(ii);
0050         ii = isfinite(my_kinetic_data.(fn{it2}).upper);
0051         kinetic_data.(fn{it2}).upper_ln(ii) = my_kinetic_data.(fn{it2}).upper_ln(ii); 
0052       <span class="keyword">end</span>
0053     <span class="keyword">end</span>
0054   <span class="keyword">end</span>
0055   <span class="keyword">return</span>
0056 <span class="keyword">end</span>
0057 
0058 <span class="keyword">if</span> use_sbml_ids * isfield(network,<span class="string">'sbml_id_species'</span>), 
0059   metabolites = network.sbml_id_species;
0060 <span class="keyword">else</span>,
0061   metabolites = network.metabolites;
0062 <span class="keyword">end</span>
0063 
0064 <span class="keyword">if</span> use_sbml_ids * isfield(network,<span class="string">'sbml_id_reaction'</span>), 
0065   reactions   = network.sbml_id_reaction;
0066 <span class="keyword">else</span>,
0067   reactions   = network.actions;
0068 <span class="keyword">end</span>
0069 
0070 <span class="comment">% ------------------------------------------</span>
0071 
0072 <span class="keyword">if</span> length(file_kinetic_data),
0073   kinetic_data_sbtab = sbtab_table_load(file_kinetic_data);
0074   kinetic_data_table = sbtab_table_get_all_columns(kinetic_data_sbtab);
0075 <span class="keyword">else</span>
0076   kinetic_data_table = struct(<span class="string">'QuantityType'</span>,[],<span class="string">'SBMLSpeciesID'</span>,[]);
0077 <span class="keyword">end</span>
0078 
0079 <span class="comment">% ------------------------------------------</span>
0080 
0081 <span class="keyword">if</span> use_kegg_ids, 
0082   <span class="keyword">if</span> ~isfield(network,<span class="string">'metabolite_KEGGID'</span>), 
0083     use_kegg_ids = 0;
0084     warning(<span class="string">'Kegg IDs missing in network; matching elements by SBML ids'</span>);
0085   <span class="keyword">elseif</span> ~isfield(kinetic_data_table,<span class="string">'Compound_MiriamID__urn_miriam_kegg_compound'</span>), 
0086     use_kegg_ids= 0; 
0087     warning(<span class="string">'Kegg IDs missing in data set; matching elements by SBML ids'</span>);
0088   <span class="keyword">else</span>,
0089     metabolites = network.metabolite_KEGGID;
0090   <span class="keyword">end</span>
0091 
0092   <span class="keyword">if</span> isfield(network,<span class="string">'reaction_KEGGID'</span>), 
0093     reactions = network.reaction_KEGGID;
0094   <span class="keyword">elseif</span>  isfield(network,<span class="string">'MiriamID__urn_miriam_kegg_reaction'</span>), 
0095     reactions = network.MiriamID__urn_miriam_kegg_reaction;
0096   <span class="keyword">else</span>
0097     use_kegg_ids = 0; 
0098     warning(<span class="string">'Kegg IDs missing in network; matching elements by SBML ids'</span>);
0099   <span class="keyword">end</span>
0100 <span class="keyword">end</span>
0101 
0102 <span class="comment">% ------------------------------------------</span>
0103 
0104 [nm,nr] = size(network.N);
0105 
0106 kinetic_data = struct;
0107 
0108 <span class="keyword">for</span> it = 1:length(data_quantities),
0109   
0110   flag_is_mean = 0;
0111   
0112   ind                     = find(strcmp(data_quantities{it},quantity_info.QuantityType));
0113   <span class="keyword">if</span> isempty(ind), error(sprintf(<span class="string">'Unknown quantity &quot;%s&quot;'</span>,data_quantities{it})); <span class="keyword">end</span>
0114   symbol                  = quantity_info.Symbol{ind};
0115   scaling                 = quantity_info.Scaling{ind};
0116   related_element         = quantity_info.RelatedElement{ind};
0117   errstd                  = <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(quantity_info.ErrorStd(ind));
0118   quantity_entry          = struct;
0119   quantity_entry.scaling  = scaling;
0120   
0121   <span class="comment">% construct empty vectors/matrices</span>
0122 
0123   <span class="keyword">switch</span> quantity_info.RelatedElement{ind},
0124     <span class="keyword">case</span> <span class="string">'Species'</span>,          ss = [nm,1];
0125     <span class="keyword">case</span> <span class="string">'Reaction'</span>,         ss = [nr,1];
0126     <span class="keyword">case</span> <span class="string">'Reaction/Species'</span>, ss = [nr,nm];
0127     <span class="keyword">case</span> <span class="string">'None'</span>,             ss = [1];
0128   <span class="keyword">end</span>
0129   
0130   quantity_entry.median = nan * zeros(ss);
0131   quantity_entry.mean   = nan * zeros(ss);
0132   quantity_entry.std    = nan * zeros(ss);
0133   quantity_entry.lower  = nan * zeros(ss);
0134   quantity_entry.upper  = nan * zeros(ss);
0135 
0136   <span class="comment">% extract relevant kinetic data</span>
0137   ind = find( strcmp(kinetic_data_table.QuantityType,data_quantities{it}));
0138 
0139   <span class="keyword">if</span> isfield(kinetic_data_table,<span class="string">'Mean'</span>),
0140     my_mean   = <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(kinetic_data_table.Mean(ind));
0141     my_median = nan * my_mean;
0142     flag_is_mean = 1;
0143   <span class="keyword">elseif</span> isfield(kinetic_data_table,<span class="string">'Median'</span>),
0144     my_median = <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(kinetic_data_table.Median(ind));
0145     my_mean   = nan * my_median;
0146   <span class="keyword">elseif</span> isfield(kinetic_data_table,<span class="string">'Value'</span>),
0147     my_median = <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(kinetic_data_table.Value(ind));
0148     my_mean   = nan * my_median;
0149   <span class="keyword">else</span> 
0150     warning(<span class="string">'No column with values found'</span>);
0151     my_median = [];
0152   <span class="keyword">end</span>
0153 
0154   my_std    = nan* ones(length(ind),1);    
0155   my_std_ln = nan* ones(length(ind),1);    
0156 
0157    <span class="keyword">switch</span> scaling,
0158     
0159     <span class="keyword">case</span> <span class="string">'Original'</span>,
0160       <span class="comment">%% mean and median are the same</span>
0161       <span class="keyword">if</span> flag_is_mean,
0162         my_median = my_mean;
0163       <span class="keyword">else</span>,
0164         my_mean = my_median;
0165       <span class="keyword">end</span>
0166     
0167     <span class="keyword">case</span> <span class="string">'Logarithmic'</span>,
0168       my_mean_ln = nan * my_mean;
0169       my_std_ln  = nan * my_std;
0170 
0171   <span class="keyword">end</span>
0172 
0173   <span class="keyword">if</span> isfield(kinetic_data_table,<span class="string">'Std'</span>),
0174     <span class="keyword">switch</span> scaling,
0175       <span class="keyword">case</span> <span class="string">'Original'</span>,
0176         my_std    = <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(kinetic_data_table.Std(ind));
0177       <span class="keyword">case</span> <span class="string">'Logarithmic'</span>,
0178         my_std_ln  = log(10) * <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(kinetic_data_table.Std(ind));
0179     <span class="keyword">end</span>
0180   <span class="keyword">end</span>
0181     
0182   <span class="keyword">if</span> flag_invent_std,
0183     <span class="keyword">if</span> verbose, 
0184       display(<span class="string">'Inventing standard deviations'</span>); 
0185     <span class="keyword">end</span>
0186     <span class="keyword">if</span> length(my_mean),
0187     <span class="keyword">switch</span> scaling,
0188       <span class="keyword">case</span> <span class="string">'Original'</span>,
0189         indices = find( [isfinite(my_mean) + isfinite(my_median)] .* [~isfinite(my_std)]);
0190         my_std(indices) = errstd;
0191       <span class="keyword">case</span> <span class="string">'Logarithmic'</span>,
0192         <span class="comment">%% PRELIMINARY SOLUTION. FIX!</span>
0193         indices = find( [isfinite(my_mean) + isfinite(my_median)] .* [~isfinite(my_std_ln)]);
0194         my_std_ln(indices)   = log(1+errstd);
0195     <span class="keyword">end</span>
0196     <span class="keyword">end</span>    
0197   <span class="keyword">end</span>
0198   
0199   <span class="keyword">if</span> isfield(kinetic_data_table,<span class="string">'LowerBound'</span>),
0200     my_lower = <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(kinetic_data_table.LowerBound(ind));
0201   <span class="keyword">else</span>,
0202     my_lower = nan * my_median;
0203   <span class="keyword">end</span>
0204 
0205   <span class="keyword">if</span> isfield(kinetic_data_table,<span class="string">'UpperBound'</span>),
0206     my_upper = <a href="../../mnt/utils/cell_string2num.html" class="code" title="function N = cell_string2num(C)">cell_string2num</a>(kinetic_data_table.UpperBound(ind));
0207   <span class="keyword">else</span>
0208     my_upper = nan * my_median;
0209   <span class="keyword">end</span>
0210 
0211   <span class="keyword">switch</span> related_element,
0212     <span class="keyword">case</span> <span class="string">'Species'</span>,   
0213       <span class="keyword">if</span> use_kegg_ids, 
0214         rindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.Compound_MiriamID__urn_miriam_kegg_compound(ind),metabolites,<span class="string">'multiple'</span>);
0215       <span class="keyword">else</span>,
0216         rindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.SBMLSpeciesID(ind),metabolites,<span class="string">'multiple'</span>);
0217       <span class="keyword">end</span>
0218       cindices = repmat({1},length(rindices),1);
0219 
0220     <span class="keyword">case</span> <span class="string">'Reaction'</span>,  
0221 
0222       <span class="keyword">if</span> use_kegg_ids, 
0223         <span class="keyword">if</span> isfield(kinetic_data_table,<span class="string">'Reaction_MiriamID__urn_miriam_kegg_reaction'</span>),
0224           rindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.Reaction_MiriamID__urn_miriam_kegg_reaction(ind),reactions,<span class="string">'multiple'</span>);
0225           cindices = repmat({1},length(rindices),1);      
0226         <span class="keyword">else</span>
0227           warning(<span class="string">'IDs cannot be matched'</span>);
0228           rindices = repmat({},length(ind));
0229           cindices = repmat({},length(rindices),1);
0230         <span class="keyword">end</span>
0231       <span class="keyword">elseif</span> isfield(kinetic_data_table,<span class="string">'SBMLReactionID'</span>),
0232         rindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.SBMLReactionID(ind),reactions,<span class="string">'multiple'</span>);
0233         cindices = repmat({1},length(rindices),1);
0234       <span class="keyword">else</span>
0235         warning(<span class="string">'IDs cannot be matched'</span>);
0236         rindices = repmat({},length(ind));
0237         cindices = repmat({},length(rindices),1);
0238       <span class="keyword">end</span>
0239   
0240     <span class="keyword">case</span> <span class="string">'Reaction/Species'</span>,   
0241       
0242       <span class="keyword">if</span> use_kegg_ids, 
0243         <span class="keyword">if</span> isfield(kinetic_data_table,<span class="string">'Reaction_MiriamID__urn_miriam_kegg_reaction'</span>),
0244           rindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.Reaction_MiriamID__urn_miriam_kegg_reaction(ind),reactions,<span class="string">'multiple'</span>);
0245           cindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.Compound_MiriamID__urn_miriam_kegg_compound(ind),metabolites,<span class="string">'multiple'</span>);
0246         <span class="keyword">else</span>
0247           warning(<span class="string">'IDs cannot be matched'</span>);
0248           rindices = repmat({},length(ind));
0249           cindices = repmat({},length(rindices),1);
0250         <span class="keyword">end</span>
0251       <span class="keyword">elseif</span> isfield(kinetic_data_table,<span class="string">'SBMLReactionID'</span>),
0252         rindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.SBMLReactionID(ind),reactions,<span class="string">'multiple'</span>);
0253         cindices = <a href="../../mnt/utils/label_names.html" class="code" title="function [label,indices] = label_names(names,allnames,method)">label_names</a>(kinetic_data_table.SBMLSpeciesID(ind),metabolites,<span class="string">'multiple'</span>);
0254       <span class="keyword">else</span>
0255         warning(<span class="string">'IDs cannot be matched'</span>);
0256         rindices = repmat({},length(ind));
0257         cindices = repmat({},length(rindices),1);
0258       <span class="keyword">end</span>
0259 
0260     <span class="keyword">case</span> <span class="string">'None'</span>,   
0261       rindices = {};
0262       cindices = {};
0263 
0264   <span class="keyword">end</span>
0265   
0266   ind_ok = find([cellfun(<span class="string">'length'</span>,rindices)~=0].*[cellfun(<span class="string">'length'</span>,cindices)~=0]);
0267   
0268   <span class="keyword">switch</span> scaling,
0269     <span class="keyword">case</span> <span class="string">'Logarithmic'</span>,
0270       quantity_entry.mean_ln = nan * quantity_entry.mean;
0271       quantity_entry.std_ln  = nan * quantity_entry.mean;
0272   <span class="keyword">end</span>
0273   
0274   <span class="comment">%% this doesn't work for duplicate values: only the last value is accepted</span>
0275   <span class="comment">%% also doesn't work for values that have to appear in several places in the model</span>
0276   
0277   <span class="keyword">for</span> itt = 1:length(ind_ok),
0278     my_ind = ind_ok(itt);
0279     quantity_entry.mean(rindices{my_ind},cindices{my_ind})   = my_mean(my_ind);
0280     quantity_entry.median(rindices{my_ind},cindices{my_ind}) = my_median(my_ind);
0281     quantity_entry.std(rindices{my_ind}, cindices{my_ind})   = my_std(my_ind);
0282     quantity_entry.lower(rindices{my_ind},cindices{my_ind})  = my_lower(my_ind);
0283     quantity_entry.upper(rindices{my_ind}, cindices{my_ind}) = my_upper(my_ind);
0284     <span class="keyword">switch</span> scaling,
0285       <span class="keyword">case</span> <span class="string">'Logarithmic'</span>,
0286         quantity_entry.mean_ln(rindices{my_ind}, cindices{my_ind}) = my_mean_ln(my_ind);
0287         quantity_entry.std_ln(rindices{my_ind}, cindices{my_ind})  = my_std_ln(my_ind);
0288     <span class="keyword">end</span>
0289   <span class="keyword">end</span>
0290   
0291   <span class="keyword">switch</span> scaling,    
0292     <span class="keyword">case</span> <span class="string">'Logarithmic'</span>,
0293       <span class="keyword">if</span> flag_is_mean,
0294         [quantity_entry.mean_ln, quantity_entry.std_ln] = <a href="../../mnt/utils/lognormal_normal2log.html" class="code" title="function [mu_log,sigma_log] = lognormal_normal2log(mu,sigma,convention)">lognormal_normal2log</a>(quantity_entry.mean, quantity_entry.std);
0295         quantity_entry.median = exp(quantity_entry.mean_ln);
0296       <span class="keyword">else</span>,
0297         quantity_entry.mean_ln = log(quantity_entry.median);
0298         ii = find(isfinite(quantity_entry.std_ln));
0299         [quantity_entry.mean(ii), quantity_entry.std(ii)] = <a href="../../mnt/utils/lognormal_log2normal.html" class="code" title="function [mu,sigma] = lognormal_log2normal(mu_log,sigma_log,convention)">lognormal_log2normal</a>(quantity_entry.mean_ln(ii), quantity_entry.std_ln(ii));
0300       <span class="keyword">end</span>
0301       quantity_entry.lower_ln = log(quantity_entry.lower);
0302       quantity_entry.upper_ln = log(quantity_entry.upper);
0303   <span class="keyword">end</span>
0304   
0305   kinetic_data.(symbol) = quantity_entry; 
0306   
0307 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 14-Apr-2013 22:34:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>